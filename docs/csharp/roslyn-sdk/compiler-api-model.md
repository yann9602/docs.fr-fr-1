---
title: "Concepts et modèle objet du SDK .NET Compiler Platform"
description: "Cette présentation fournit les informations dont vous avez besoin pour utiliser efficacement le SDK .NET Compiler Platform. Vous allez découvrir les différentes couches d’API, les principaux types utilisés et le modèle objet global."
author: billwagner
ms.author: wiwagn
ms.date: 10/10/2017
ms.topic: conceptual
ms.prod: .net
ms.devlang: devlang-csharp
ms.custom: mvc
ms.openlocfilehash: 65a4695c6f4e5268582d83452246ed8262d6fe2f
ms.sourcegitcommit: d095094e942eedf09530ea5636fbaf9029853027
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/19/2017
---
# <a name="understand-the-net-compiler-platform-sdk-model"></a><span data-ttu-id="0edde-104">Comprendre le modèle du SDK .NET Compiler Platform</span><span class="sxs-lookup"><span data-stu-id="0edde-104">Understand the .NET Compiler Platform SDK model</span></span>

<span data-ttu-id="0edde-105">Les compilateurs traitent le code que vous écrivez en suivant des règles structurées qui diffèrent souvent de la façon dont vous pouvez vous-même lire et comprendre le code.</span><span class="sxs-lookup"><span data-stu-id="0edde-105">Compilers process the code you write following structured rules that often differ from the way humans read and understand code.</span></span> <span data-ttu-id="0edde-106">Pour bien comprendre le fonctionnement des API dont vous avez besoin pour créer des outils Roslyn, vous devez connaître les concepts de base du modèle utilisé par les compilateurs.</span><span class="sxs-lookup"><span data-stu-id="0edde-106">A basic understanding of the model used by compilers is essential to understanding the APIs you use when building Roslyn-based tools.</span></span> 

## <a name="compiler-pipeline-functional-areas"></a><span data-ttu-id="0edde-107">Zones fonctionnelles du pipeline de compilateur</span><span class="sxs-lookup"><span data-stu-id="0edde-107">Compiler pipeline functional areas</span></span>

<span data-ttu-id="0edde-108">Le SDK .NET Compiler Platform expose les analyses de code des compilateurs C# et Visual Basic en vous fournissant, en tant que consommateur, une couche d’API qui reflète un pipeline de compilateur standard.</span><span class="sxs-lookup"><span data-stu-id="0edde-108">The .NET Compiler Platform SDK exposes the C# and Visual Basic compilers' code analysis to you as a consumer by providing an API layer that mirrors a traditional compiler pipeline.</span></span>

![étapes du pipeline de compilateur pour traiter le code source en code objet](media/compiler-pipeline.png)

<span data-ttu-id="0edde-110">Chaque phase de ce pipeline correspond à un composant distinct.</span><span class="sxs-lookup"><span data-stu-id="0edde-110">Each phase of this pipeline is a separate component.</span></span> <span data-ttu-id="0edde-111">Tout d’abord, la phase d’analyse segmente et analyse le texte source dans la syntaxe grammaticale du langage utilisé.</span><span class="sxs-lookup"><span data-stu-id="0edde-111">First, the parse phase tokenizes and parses source text into syntax that follows the language grammar.</span></span> <span data-ttu-id="0edde-112">Ensuite, la phase de déclaration analyse les métadonnées sources et importées pour former des symboles nommés.</span><span class="sxs-lookup"><span data-stu-id="0edde-112">Second the declaration phase analyzes source and imported metadata to form named symbols.</span></span> <span data-ttu-id="0edde-113">Après cela, la phase de liaison mappe les identificateurs dans le code à des symboles.</span><span class="sxs-lookup"><span data-stu-id="0edde-113">Next the bind phase matches identifiers in the code to symbols.</span></span> <span data-ttu-id="0edde-114">Enfin, la phase d’émission émet un assembly qui contient toutes les informations générées par le compilateur.</span><span class="sxs-lookup"><span data-stu-id="0edde-114">Finally, the emit phase, emits an assembly with all the information built up by the compiler.</span></span>

![l’API du pipeline du compilateur fournit l’accès à chaque phase du pipeline du compilateur](media/compiler-pipeline-api.png)

<span data-ttu-id="0edde-116">Pour chacune de ces phases, le SDK .NET Compiler Platform expose un modèle objet qui permet d’accéder aux informations disponibles à la phase en question.</span><span class="sxs-lookup"><span data-stu-id="0edde-116">Corresponding to each of those phases, the .NET Compiler Platform SDK exposes an object model that allows access to the information at that phase.</span></span> <span data-ttu-id="0edde-117">La phase d’analyse expose une arborescence de syntaxe, la phase de déclaration expose une table de symboles hiérarchique, la phase de liaison expose le résultat de l’analyse sémantique du compilateur et la phase d’émission est une API qui produit des codes d’octets IL.</span><span class="sxs-lookup"><span data-stu-id="0edde-117">The parsing phase exposes a syntax tree, the declaration phase exposes a hierarchical symbol table, the binding phase exposes the result of the compiler’s semantic analysis, and the emit phase is an API that produces IL byte codes.</span></span>

![services de langage disponibles à partir de l’API du compilateur à chaque phase du pipeline du compilateur](media/compiler-pipeline-lang-svc.png)

<span data-ttu-id="0edde-119">Chaque compilateur combine ces composants en une solution de bout en bout unique.</span><span class="sxs-lookup"><span data-stu-id="0edde-119">Each compiler combines these components together as a single end-to-end whole.</span></span>

<span data-ttu-id="0edde-120">Ces API sont les mêmes que celles utilisées par Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0edde-120">These APIs are the same used by Visual Studio.</span></span> <span data-ttu-id="0edde-121">Par exemple, les fonctionnalités de mise en forme et en plan du code utilisent les arborescences de syntaxe, les fonctionnalités de l’Explorateur d’objets et de navigation utilisent la table de symboles, les fonctionnalités de refactorisation et Atteindre la définition utilisent le modèle sémantique, et la fonctionnalité Modifier et Continuer utilise tous ces éléments, y compris l’API d’émission.</span><span class="sxs-lookup"><span data-stu-id="0edde-121">For instance, the code outlining and formatting features use the syntax trees, the Object Browser and navigation features use the symbol table, refactorings and Go to Definition use the semantic model, and Edit and Continue uses all of these, including the Emit API.</span></span> 

## <a name="api-layers"></a><span data-ttu-id="0edde-122">Couches d’API</span><span class="sxs-lookup"><span data-stu-id="0edde-122">API layers</span></span>

<span data-ttu-id="0edde-123">Le SDK .NET Compiler comporte deux couches principales d’API : les API du compilateur et les API des espaces de travail.</span><span class="sxs-lookup"><span data-stu-id="0edde-123">The .NET compiler SDK consists of two main layers of APIs: compiler APIs and workspaces APIs.</span></span>

![couches d’API représentées par les API du pipeline du compilateur](media/api-layers.png)

### <a name="compiler-apis"></a><span data-ttu-id="0edde-125">API du compilateur</span><span class="sxs-lookup"><span data-stu-id="0edde-125">Compiler APIs</span></span>

<span data-ttu-id="0edde-126">La couche du compilateur contient les modèles objet qui correspondent aux informations syntaxiques et sémantiques exposées à chaque phase du pipeline du compilateur.</span><span class="sxs-lookup"><span data-stu-id="0edde-126">The compiler layer contains the object models that correspond to information exposed at each phase of the compiler pipeline, both syntactic and semantic.</span></span> <span data-ttu-id="0edde-127">La couche du compilateur contient également un instantané immuable d’un appel unique d’un compilateur, notamment les références d’assembly, les options du compilateur et les fichiers de code source.</span><span class="sxs-lookup"><span data-stu-id="0edde-127">The compiler layer also contains an immutable snapshot of a single invocation of a compiler, including assembly references, compiler options, and source code files.</span></span> <span data-ttu-id="0edde-128">Le langage C# et le langage Visual Basic sont représentés par deux API distinctes.</span><span class="sxs-lookup"><span data-stu-id="0edde-128">There are two distinct APIs that represent the C# language and the Visual Basic language.</span></span> <span data-ttu-id="0edde-129">Ces deux API sont similaires dans la forme, mais elles sont adaptées à chaque langage pour garantir une haute fidélité.</span><span class="sxs-lookup"><span data-stu-id="0edde-129">These two APIs are similar in shape but tailored for high-fidelity to each individual language.</span></span> <span data-ttu-id="0edde-130">Cette couche n’a pas de dépendances sur les composants Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0edde-130">This layer has no dependencies on Visual Studio components.</span></span>

### <a name="diagnostic-apis"></a><span data-ttu-id="0edde-131">API de diagnostic</span><span class="sxs-lookup"><span data-stu-id="0edde-131">Diagnostic APIs</span></span>

<span data-ttu-id="0edde-132">Dans le cadre de son analyse, le compilateur peut produire un ensemble de diagnostics complets, qui couvrent les erreurs de syntaxe, de sémantique et d’assignation définie, ainsi que divers avertissements et informations.</span><span class="sxs-lookup"><span data-stu-id="0edde-132">As part of its analysis the compiler may produce a set of diagnostics covering everything from syntax, semantic, and definite assignment errors to various warnings and informational diagnostics.</span></span> <span data-ttu-id="0edde-133">La couche API du compilateur expose les diagnostics par le biais d’une API extensible qui permet d’intégrer des analyseurs définis par l’utilisateur au processus de compilation.</span><span class="sxs-lookup"><span data-stu-id="0edde-133">TThe Compiler API layer exposes diagnostics through an extensible API that allows user-defined analyzers to be plugged into the compilation process.</span></span> <span data-ttu-id="0edde-134">Des diagnostics définis par l’utilisateur, tels que ceux générés par des outils comme StyleCop ou FxCop, peuvent ainsi être produits en même temps que les diagnostics définis par le compilateur.</span><span class="sxs-lookup"><span data-stu-id="0edde-134">It allows user-defined diagnostics, such as those produced by tools like StyleCop or FxCop, to be produced alongside compiler-defined diagnostics.</span></span> <span data-ttu-id="0edde-135">Les diagnostics générés de cette manière offrent l’avantage de s’intégrer naturellement à des outils comme MSBuild et Visual Studio qui se basent sur les diagnostics pour effectuer certaines actions (par exemple, arrêter une build basée sur une stratégie, afficher en temps réel des lignes ondulées dans l’éditeur et suggérer des corrections du code).</span><span class="sxs-lookup"><span data-stu-id="0edde-135">Producing diagnostics in this way has the benefit of integrating naturally with tools such as MSBuild and Visual Studio which depend on diagnostics for experiences such as halting a build based on policy and showing live squiggles in the editor and suggesting code fixes.</span></span>

### <a name="scripting-apis"></a><span data-ttu-id="0edde-136">API de script</span><span class="sxs-lookup"><span data-stu-id="0edde-136">Scripting APIs</span></span>

<span data-ttu-id="0edde-137">Les API d’hébergement et de script font partie de la couche du compilateur.</span><span class="sxs-lookup"><span data-stu-id="0edde-137">Hosting and scripting APIs are part of the compiler layer.</span></span> <span data-ttu-id="0edde-138">Vous pouvez utiliser ces API pour l’exécution d’extraits de code et l’accumulation d’un contexte d’exécution du runtime.</span><span class="sxs-lookup"><span data-stu-id="0edde-138">You can use them for executing code snippets and accumulating a runtime execution context.</span></span>
<span data-ttu-id="0edde-139">Le REPL (Read-Evaluate-Print Loop) interactif C# utilise ces API.</span><span class="sxs-lookup"><span data-stu-id="0edde-139">The C# interactive REPL (Read-Evaluate-Print Loop) uses these APIs.</span></span> <span data-ttu-id="0edde-140">Le REPL vous permet d’utiliser C# comme langage de script, en exécutant le code que vous écrivez de manière interactive.</span><span class="sxs-lookup"><span data-stu-id="0edde-140">The REPL enables you to use C# as a scripting language, executing the code interactively as you write it.</span></span>

### <a name="workspaces-apis"></a><span data-ttu-id="0edde-141">API des espaces de travail</span><span class="sxs-lookup"><span data-stu-id="0edde-141">Workspaces APIs</span></span>

<span data-ttu-id="0edde-142">La couche des espaces de travail contient les API des espaces de travail, à partir desquelles sont effectuées les analyses de code et la refactorisation dans les solutions entières.</span><span class="sxs-lookup"><span data-stu-id="0edde-142">The Workspaces layer contains the Workspace API, which is the starting point for doing code analysis and refactoring over entire solutions.</span></span> <span data-ttu-id="0edde-143">Elle vous aide à organiser toutes les informations sur les projets d’une solution dans un modèle objet unique. Ce modèle vous permet d’accéder directement aux modèles objet de la couche du compilateur sans avoir à analyser des fichiers, configurer des options ou gérer des dépendances entre projets.</span><span class="sxs-lookup"><span data-stu-id="0edde-143">It assists you in organizing all the information about the projects in a solution into single object model, offering you direct access to the compiler layer object models without needing to parse files, configure options, or manage project-to-project dependencies.</span></span>

<span data-ttu-id="0edde-144">De plus, la couche des espaces de travail expose un ensemble d’API utilisées pour l’implémentation d’outils d’analyse du code et de refactorisation qui fonctionnent dans un environnement hôte, tel que l’IDE Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0edde-144">In addition, the Workspaces layer surfaces a set of APIs used when implementing code analysis and refactoring tools that function within a host environment like the Visual Studio IDE.</span></span> <span data-ttu-id="0edde-145">Les API Rechercher toutes les références, Mise en forme et Génération de code en sont des exemples.</span><span class="sxs-lookup"><span data-stu-id="0edde-145">Examples include the Find All References, Formatting, and Code Generation APIs.</span></span>

<span data-ttu-id="0edde-146">Cette couche n’a pas de dépendances sur les composants Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0edde-146">This layer has no dependencies on Visual Studio components.</span></span>
