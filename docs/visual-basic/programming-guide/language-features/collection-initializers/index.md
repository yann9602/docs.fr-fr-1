---
title: Initialiseurs de collections (Visual Basic)
ms.custom: 
ms.date: 07/20/2015
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: devlang-visual-basic
ms.topic: article
f1_keywords: vb.CollectionInitializer
helpviewer_keywords: collection initializers [Visual Basic]
ms.assetid: a9290329-77b0-4fdf-ae75-8fc17287f469
caps.latest.revision: "23"
author: dotnet-bot
ms.author: dotnetcontent
ms.openlocfilehash: 5ec0179df50df453d6058a4b910d17561394140d
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/21/2017
---
# <a name="collection-initializers-visual-basic"></a><span data-ttu-id="35adf-102">Initialiseurs de collections (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="35adf-102">Collection Initializers (Visual Basic)</span></span>
<span data-ttu-id="35adf-103">Les *initialiseurs de collections* fournissent une syntaxe raccourcie qui vous permet de créer une collection et de la remplir avec un ensemble initial de valeurs.</span><span class="sxs-lookup"><span data-stu-id="35adf-103">*Collection initializers* provide a shortened syntax that enables you to create a collection and populate it with an initial set of values.</span></span> <span data-ttu-id="35adf-104">Les initialiseurs de collections sont utiles lorsque vous créez une collection à partir d’un ensemble de valeurs connues (par exemple, une liste d’options de menu ou de catégories, un ensemble initial de valeurs numériques, une liste statique de chaînes telles que des noms de jours ou de mois, ou des emplacements géographiques tels qu’une liste d’états utilisée pour la validation).</span><span class="sxs-lookup"><span data-stu-id="35adf-104">Collection initializers are useful when you are creating a collection from a set of known values, for example, a list of menu options or categories, an initial set of numeric values, a static list of strings such as day or month names, or geographic locations such as a list of states that is used for validation.</span></span>  
  
 <span data-ttu-id="35adf-105">Pour plus d’informations sur les collections, consultez [Collections](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b).</span><span class="sxs-lookup"><span data-stu-id="35adf-105">For more information about collections, see [Collections](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b).</span></span>  
  
 <span data-ttu-id="35adf-106">Vous identifiez un initialiseur de collection à l’aide du mot clé `From` suivi d’accolades (`{}`).</span><span class="sxs-lookup"><span data-stu-id="35adf-106">You identify a collection initializer by using the `From` keyword followed by braces (`{}`).</span></span> <span data-ttu-id="35adf-107">Cette syntaxe est similaire à la syntaxe des littéraux de tableau décrite dans [Tableaux](../../../../visual-basic/programming-guide/language-features/arrays/index.md).</span><span class="sxs-lookup"><span data-stu-id="35adf-107">This is similar to the array literal syntax that is described in [Arrays](../../../../visual-basic/programming-guide/language-features/arrays/index.md).</span></span> <span data-ttu-id="35adf-108">Les exemples suivants montrent différentes manières d’utiliser des initialiseurs de collections pour créer des collections.</span><span class="sxs-lookup"><span data-stu-id="35adf-108">The following examples show various ways to use collection initializers to create collections.</span></span>  
  
 [!code-vb[VbVbalrCollectionInitializers#1](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#1)]  
  
> [!NOTE]
>  <span data-ttu-id="35adf-109">C# fournit également des initialiseurs de collections.</span><span class="sxs-lookup"><span data-stu-id="35adf-109">C# also provides collection initializers.</span></span> <span data-ttu-id="35adf-110">Les initialiseurs de collections C# fournissent les mêmes fonctionnalités que les initialiseurs de collections Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="35adf-110">C# collection initializers provide the same functionality as Visual Basic collection initializers.</span></span> <span data-ttu-id="35adf-111">Pour plus d’informations sur les initialiseurs de collections C#, consultez [Initialiseurs d’objets et de collections](../../../../csharp/programming-guide/classes-and-structs/object-and-collection-initializers.md).</span><span class="sxs-lookup"><span data-stu-id="35adf-111">For more information about C# collection initializers, see [Object and Collection Initializers](../../../../csharp/programming-guide/classes-and-structs/object-and-collection-initializers.md).</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="35adf-112">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="35adf-112">Syntax</span></span>  
 <span data-ttu-id="35adf-113">Un initialiseur de collection se compose d’une liste de valeurs séparées par des virgules et placées entre accolades (`{}`), précédées par le mot clé `From`, comme illustré dans le code suivant.</span><span class="sxs-lookup"><span data-stu-id="35adf-113">A collection initializer consists of a list of comma-separated values that are enclosed in braces (`{}`), preceded by the `From` keyword, as shown in the following code.</span></span>  
  
 [!code-vb[VbVbalrCollectionInitializers#2](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#2)]  
  
 <span data-ttu-id="35adf-114">Lorsque vous créez une collection, comme un <xref:System.Collections.Generic.List%601> ou un <xref:System.Collections.Generic.Dictionary%602>, vous devez fournir le type de collection avant l’initialiseur de collection, comme indiqué dans le code suivant.</span><span class="sxs-lookup"><span data-stu-id="35adf-114">When you create a collection, such as a <xref:System.Collections.Generic.List%601> or a <xref:System.Collections.Generic.Dictionary%602>, you must supply the collection type before the collection initializer, as shown in the following code.</span></span>  
  
 [!code-vb[VbVbalrCollectionInitializers#13](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#13)]  
  
> [!NOTE]
>  <span data-ttu-id="35adf-115">Vous ne pouvez pas combiner un initialiseur de collection et un initialiseur d’objet pour initialiser le même objet de collection.</span><span class="sxs-lookup"><span data-stu-id="35adf-115">You cannot combine both a collection initializer and an object initializer to initialize the same collection object.</span></span> <span data-ttu-id="35adf-116">Vous pouvez utiliser des initialiseurs d’objets pour initialiser des objets dans un initialiseur de collection.</span><span class="sxs-lookup"><span data-stu-id="35adf-116">You can use object initializers to initialize objects in a collection initializer.</span></span>  
  
## <a name="creating-a-collection-by-using-a-collection-intializer"></a><span data-ttu-id="35adf-117">Création d’une collection à l’aide d’un initialiseur de collection</span><span class="sxs-lookup"><span data-stu-id="35adf-117">Creating a Collection by Using a Collection Intializer</span></span>  
 <span data-ttu-id="35adf-118">Lorsque vous créez une collection à l’aide d’un initialiseur de collection, chaque valeur fournie dans l’initialiseur de collection est passée à la méthode `Add` appropriée de la collection.</span><span class="sxs-lookup"><span data-stu-id="35adf-118">When you create a collection by using a collection initializer, each value that is supplied in the collection initializer is passed to the appropriate `Add` method of the collection.</span></span> <span data-ttu-id="35adf-119">Par exemple, si vous créez un <xref:System.Collections.Generic.List%601> en utilisant un initialiseur de collection, chaque valeur de chaîne de l’initialiseur de collection est passée à la méthode <xref:System.Collections.Generic.List%601.Add%2A>.</span><span class="sxs-lookup"><span data-stu-id="35adf-119">For example, if you create a <xref:System.Collections.Generic.List%601> by using a collection initializer, each string value in the collection initializer is passed to the <xref:System.Collections.Generic.List%601.Add%2A> method.</span></span> <span data-ttu-id="35adf-120">Si vous souhaitez créer une collection à l’aide d’un initialiseur de collection, le type spécifié doit être un type de collection valide.</span><span class="sxs-lookup"><span data-stu-id="35adf-120">If you want to create a collection by using a collection initializer, the specified type must be valid collection type.</span></span> <span data-ttu-id="35adf-121">Les types de collections valides sont, par exemple, des classes qui implémentent l’interface <xref:System.Collections.Generic.IEnumerable%601> ou qui héritent de la classe <xref:System.Collections.CollectionBase>.</span><span class="sxs-lookup"><span data-stu-id="35adf-121">Examples of valid collection types include classes that implement the <xref:System.Collections.Generic.IEnumerable%601> interface or inherit the <xref:System.Collections.CollectionBase> class.</span></span> <span data-ttu-id="35adf-122">Le type spécifié doit également exposer une méthode `Add` qui répond aux critères suivants.</span><span class="sxs-lookup"><span data-stu-id="35adf-122">The specified type must also expose an `Add` method that meets the following criteria.</span></span>  
  
-   <span data-ttu-id="35adf-123">La méthode `Add` doit être disponible à partir de la portée dans laquelle l’initialiseur de collection est appelé.</span><span class="sxs-lookup"><span data-stu-id="35adf-123">The `Add` method must be available from the scope in which the collection initializer is being called.</span></span> <span data-ttu-id="35adf-124">La méthode `Add` ne doit pas nécessairement être publique si vous utilisez l’initialiseur de collection dans un scénario où les méthodes non publiques de la collection sont accessibles.</span><span class="sxs-lookup"><span data-stu-id="35adf-124">The `Add` method does not have to be public if you are using the collection initializer in a scenario where non-public methods of the collection can be accessed.</span></span>  
  
-   <span data-ttu-id="35adf-125">La méthode `Add` doit être un membre d’instance ou un membre `Shared` de la classe de collection, ou une méthode d’extension.</span><span class="sxs-lookup"><span data-stu-id="35adf-125">The `Add` method must be an instance member or `Shared` member of the collection class, or an extension method.</span></span>  
  
-   <span data-ttu-id="35adf-126">Il doit exister une méthode `Add` pouvant être mise en correspondance, selon les règles de résolution de surcharge, avec les types fournis dans l’initialiseur de collection.</span><span class="sxs-lookup"><span data-stu-id="35adf-126">An `Add` method must exist that can be matched, based on overload resolution rules, to the types that are supplied in the collection initializer.</span></span>  
  
 <span data-ttu-id="35adf-127">Ainsi, l’exemple de code suivant montre comment créer une collection `List(Of Customer)` à l’aide d’un initialiseur de collection.</span><span class="sxs-lookup"><span data-stu-id="35adf-127">For example, the following code example shows how to create a `List(Of Customer)` collection by using a collection initializer.</span></span> <span data-ttu-id="35adf-128">Lorsque le code est exécuté, chaque objet `Customer` est passé à la méthode `Add(Customer)` de la liste générique.</span><span class="sxs-lookup"><span data-stu-id="35adf-128">When the code is run, each `Customer` object is passed to the `Add(Customer)` method of the generic list.</span></span>  
  
 [!code-vb[VbVbalrCollectionInitializers#9](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#9)]  
  
 <span data-ttu-id="35adf-129">L’exemple de code suivant montre le code équivalent qui n’utilise pas d’initialiseur de collection.</span><span class="sxs-lookup"><span data-stu-id="35adf-129">The following code example shows equivalent code that does not use a collection initializer.</span></span>  
  
 [!code-vb[VbVbalrCollectionInitializers#10](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#10)]  
  
 <span data-ttu-id="35adf-130">Si la collection a une méthode `Add` ayant des paramètres qui correspondent au constructeur de l’objet `Customer`, vous pouvez imbriquer des valeurs de paramètre pour la méthode `Add` dans les initialiseurs de collections, comme indiqué dans la section suivante.</span><span class="sxs-lookup"><span data-stu-id="35adf-130">If the collection has an `Add` method that has parameters that match the constructor for the `Customer` object, you could nest parameter values for the `Add` method within collection initializers, as discussed in the next section.</span></span> <span data-ttu-id="35adf-131">Si la collection n’a pas une telle méthode `Add`, vous pouvez en créer une comme méthode d’extension.</span><span class="sxs-lookup"><span data-stu-id="35adf-131">If the collection does not have such an `Add` method, you can create one as an extension method.</span></span> <span data-ttu-id="35adf-132">Pour obtenir un exemple montrant comment créer une méthode `Add` comme méthode d’extension pour une collection, consultez [Guide pratique pour créer une méthode d’extension Add utilisée par un initialiseur de collection](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-an-add-extension-method-used-by-a-collection-initializer.md).</span><span class="sxs-lookup"><span data-stu-id="35adf-132">For an example of how to create an `Add` method as an extension method for a collection, see [How to: Create an Add Extension Method Used by a Collection Initializer](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-an-add-extension-method-used-by-a-collection-initializer.md).</span></span> <span data-ttu-id="35adf-133">Pour obtenir un exemple montrant comment créer une collection personnalisée pouvant être utilisée avec un initialiseur de collection, consultez [Guide pratique pour créer une collection utilisée par un initialiseur de collection](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md).</span><span class="sxs-lookup"><span data-stu-id="35adf-133">For an example of how to create a custom collection that can be used with a collection initializer, see [How to: Create a Collection Used by a Collection Initializer](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md).</span></span>  
  
## <a name="nesting-collection-initializers"></a><span data-ttu-id="35adf-134">Imbrication d’initialiseurs de collections</span><span class="sxs-lookup"><span data-stu-id="35adf-134">Nesting Collection Initializers</span></span>  
 <span data-ttu-id="35adf-135">Vous pouvez imbriquer des valeurs dans un initialiseur de collection pour identifier une surcharge spécifique d’une méthode `Add` pour la collection qui est créée.</span><span class="sxs-lookup"><span data-stu-id="35adf-135">You can nest values within a collection initializer to identify a specific overload of an `Add` method for the collection that is being created.</span></span> <span data-ttu-id="35adf-136">Les valeurs passées à la méthode `Add` doivent être séparées par des virgules et placées entre accolades (`{}`), comme vous le feriez dans un littéral de tableau ou un initialiseur de collection.</span><span class="sxs-lookup"><span data-stu-id="35adf-136">The values passed to the `Add` method must be separated by commas and enclosed in braces (`{}`), like you would do in an array literal or collection initializer.</span></span>  
  
 <span data-ttu-id="35adf-137">Lorsque vous créez une collection à l’aide de valeurs imbriquées, chaque élément de la liste de valeurs imbriquée est passé comme argument à la méthode `Add` correspondant aux types d’éléments.</span><span class="sxs-lookup"><span data-stu-id="35adf-137">When you create a collection by using nested values, each element of the nested value list is passed as an argument to the `Add` method that matches the element types.</span></span> <span data-ttu-id="35adf-138">Ainsi, l’exemple de code suivant crée un <xref:System.Collections.Generic.Dictionary%602> dans lequel les clés sont de type `Integer` et les valeurs sont de type `String`.</span><span class="sxs-lookup"><span data-stu-id="35adf-138">For example, the following code example creates a <xref:System.Collections.Generic.Dictionary%602> in which the keys are of type `Integer` and the values are of type `String`.</span></span> <span data-ttu-id="35adf-139">Chacune des listes de valeurs imbriquées est mise en correspondance avec la méthode <xref:System.Collections.Generic.Dictionary%602.Add%2A> pour `Dictionary`.</span><span class="sxs-lookup"><span data-stu-id="35adf-139">Each of the nested value lists is matched to the <xref:System.Collections.Generic.Dictionary%602.Add%2A> method for the `Dictionary`.</span></span>  
  
 [!code-vb[VbVbalrCollectionInitializers#5](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#5)]  
  
 <span data-ttu-id="35adf-140">L’exemple de code précédent est équivalent au code suivant.</span><span class="sxs-lookup"><span data-stu-id="35adf-140">The previous code example is equivalent to the following code.</span></span>  
  
 [!code-vb[VbVbalrCollectionInitializers#6](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#6)]  
  
 <span data-ttu-id="35adf-141">Seules les listes de valeurs imbriquées du premier niveau d’imbrication sont envoyées à la méthode `Add` pour le type de collection.</span><span class="sxs-lookup"><span data-stu-id="35adf-141">Only nested value lists from the first level of nesting are sent to the `Add` method for the collection type.</span></span> <span data-ttu-id="35adf-142">Les niveaux d’imbrication plus profonds sont traités comme des littéraux de tableau et les listes de valeurs imbriquées ne sont pas mises en correspondance avec la méthode `Add` de toute collection.</span><span class="sxs-lookup"><span data-stu-id="35adf-142">Deeper levels of nesting are treated as array literals and the nested value lists are not matched to the `Add` method of any collection.</span></span>  
  
## <a name="related-topics"></a><span data-ttu-id="35adf-143">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="35adf-143">Related Topics</span></span>  
  
|<span data-ttu-id="35adf-144">Titre</span><span class="sxs-lookup"><span data-stu-id="35adf-144">Title</span></span>|<span data-ttu-id="35adf-145">Description</span><span class="sxs-lookup"><span data-stu-id="35adf-145">Description</span></span>|  
|---|---|  
|[<span data-ttu-id="35adf-146">Guide pratique : créer une méthode d’extension Add utilisée par un initialiseur de collection</span><span class="sxs-lookup"><span data-stu-id="35adf-146">How to: Create an Add Extension Method Used by a Collection Initializer</span></span>](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-an-add-extension-method-used-by-a-collection-initializer.md)|<span data-ttu-id="35adf-147">Montre comment créer une méthode d’extension appelée `Add` qui peut être utilisée pour renseigner une collection avec des valeurs d’un initialiseur de collection.</span><span class="sxs-lookup"><span data-stu-id="35adf-147">Shows how to create an extension method called `Add` that can be used to populate a collection with values from a collection initializer.</span></span>|  
|[<span data-ttu-id="35adf-148">Guide pratique : créer une collection utilisée par un initialiseur de collection</span><span class="sxs-lookup"><span data-stu-id="35adf-148">How to: Create a Collection Used by a Collection Initializer</span></span>](../../../../visual-basic/programming-guide/language-features/collection-initializers/how-to-create-a-collection-used-by-a-collection-initializer.md)|<span data-ttu-id="35adf-149">Montre comment activer l’utilisation d’un initialiseur de collection en incluant une méthode `Add` dans une classe de collection qui implémente `IEnumerable`.</span><span class="sxs-lookup"><span data-stu-id="35adf-149">Shows how to enable use of a collection initializer by including an `Add` method in a collection class that implements `IEnumerable`.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="35adf-150">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="35adf-150">See Also</span></span>  
 [<span data-ttu-id="35adf-151">Collections</span><span class="sxs-lookup"><span data-stu-id="35adf-151">Collections</span></span>](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b)  
 [<span data-ttu-id="35adf-152">Tableaux</span><span class="sxs-lookup"><span data-stu-id="35adf-152">Arrays</span></span>](../../../../visual-basic/programming-guide/language-features/arrays/index.md)  
 [<span data-ttu-id="35adf-153">Initialiseurs d’objets : types nommés et anonymes</span><span class="sxs-lookup"><span data-stu-id="35adf-153">Object Initializers: Named and Anonymous Types</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)  
 [<span data-ttu-id="35adf-154">New (opérateur)</span><span class="sxs-lookup"><span data-stu-id="35adf-154">New Operator</span></span>](../../../../visual-basic/language-reference/operators/new-operator.md)  
 [<span data-ttu-id="35adf-155">Propriétés implémentées automatiquement</span><span class="sxs-lookup"><span data-stu-id="35adf-155">Auto-Implemented Properties</span></span>](../../../../visual-basic/programming-guide/language-features/procedures/auto-implemented-properties.md)  
 [<span data-ttu-id="35adf-156">Comment : initialiser une variable tableau en Visual Basic</span><span class="sxs-lookup"><span data-stu-id="35adf-156">How to: Initialize an Array Variable in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md)  
 [<span data-ttu-id="35adf-157">Inférence de type local</span><span class="sxs-lookup"><span data-stu-id="35adf-157">Local Type Inference</span></span>](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)  
 [<span data-ttu-id="35adf-158">Types anonymes</span><span class="sxs-lookup"><span data-stu-id="35adf-158">Anonymous Types</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)  
 [<span data-ttu-id="35adf-159">Introduction à LINQ en Visual Basic</span><span class="sxs-lookup"><span data-stu-id="35adf-159">Introduction to LINQ in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)  
 [<span data-ttu-id="35adf-160">Guide pratique : créer une liste d’éléments</span><span class="sxs-lookup"><span data-stu-id="35adf-160">How to: Create a List of Items</span></span>](../../../../visual-basic/programming-guide/concepts/linq/how-to-create-a-list-of-items.md)
