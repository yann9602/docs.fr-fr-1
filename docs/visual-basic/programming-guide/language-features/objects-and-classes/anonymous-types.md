---
title: Types anonymes (Visual Basic)
ms.custom: 
ms.date: 07/20/2015
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: devlang-visual-basic
ms.topic: article
f1_keywords: vb.AnonymousType
helpviewer_keywords:
- anonymous types [Visual Basic], about anonymous types
- anonymous types [Visual Basic]
- types [Visual Basic], anonymous
ms.assetid: 7b87532c-4b3e-4398-8503-6ea9d67574a4
caps.latest.revision: "46"
author: dotnet-bot
ms.author: dotnetcontent
ms.openlocfilehash: 530e21e1595f9bbc3436280418287413e2a48111
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/21/2017
---
# <a name="anonymous-types-visual-basic"></a><span data-ttu-id="2b194-102">Types anonymes (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="2b194-102">Anonymous Types (Visual Basic)</span></span>
<span data-ttu-id="2b194-103">Visual Basic prend en charge les types anonymes, qui vous permettent de créer des objets sans écrire de définition de classe pour le type de données.</span><span class="sxs-lookup"><span data-stu-id="2b194-103">Visual Basic supports anonymous types, which enable you to create objects without writing a class definition for the data type.</span></span> <span data-ttu-id="2b194-104">À la place, le compilateur se charge de générer une classe.</span><span class="sxs-lookup"><span data-stu-id="2b194-104">Instead, the compiler generates a class for you.</span></span> <span data-ttu-id="2b194-105">La classe n’a aucun nom utilisable, hérite directement de <xref:System.Object>et contient les propriétés que vous spécifiez dans la déclaration de l’objet.</span><span class="sxs-lookup"><span data-stu-id="2b194-105">The class has no usable name, inherits directly from <xref:System.Object>, and contains the properties you specify in declaring the object.</span></span> <span data-ttu-id="2b194-106">Étant donné que le nom du type de données n’est pas spécifié, il est appelé un *type anonyme*.</span><span class="sxs-lookup"><span data-stu-id="2b194-106">Because the name of the data type is not specified, it is referred to as an *anonymous type*.</span></span>  
  
 <span data-ttu-id="2b194-107">L’exemple suivant déclare et crée la variable `product` comme une instance d’un type anonyme qui a deux propriétés, `Name` et `Price`.</span><span class="sxs-lookup"><span data-stu-id="2b194-107">The following example declares and creates variable `product` as an instance of an anonymous type that has two properties, `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#1](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_1.vb)]  
  
 <span data-ttu-id="2b194-108">A *expression de requête* utilise des types anonymes pour combiner des colonnes de données sélectionnées par une requête.</span><span class="sxs-lookup"><span data-stu-id="2b194-108">A *query expression* uses anonymous types to combine columns of data selected by a query.</span></span> <span data-ttu-id="2b194-109">Vous ne pouvez pas définir le type du résultat à l’avance, car vous ne pouvez pas prédire les colonnes de qu'une requête particulière.</span><span class="sxs-lookup"><span data-stu-id="2b194-109">You cannot define the type of the result in advance, because you cannot predict the columns a particular query might select.</span></span> <span data-ttu-id="2b194-110">Les types anonymes vous permettent de vous permettent d’écrire une requête qui sélectionne n’importe quel nombre de colonnes, dans n’importe quel ordre.</span><span class="sxs-lookup"><span data-stu-id="2b194-110">Anonymous types enable you to write a query that selects any number of columns, in any order.</span></span> <span data-ttu-id="2b194-111">Le compilateur crée un type de données qui correspond aux propriétés spécifiées et l’ordre spécifié.</span><span class="sxs-lookup"><span data-stu-id="2b194-111">The compiler creates a data type that matches the specified properties and the specified order.</span></span>  
  
 <span data-ttu-id="2b194-112">Dans les exemples suivants, `products` est une liste d’objets de produit, chacun d'entre eux ayant de nombreuses propriétés.</span><span class="sxs-lookup"><span data-stu-id="2b194-112">In the following examples, `products` is a list of product objects, each of which has many properties.</span></span> <span data-ttu-id="2b194-113">Variable `namePriceQuery` contient la définition d’une requête qui, lorsqu’elle est exécutée, retourne une collection d’instances d’un type anonyme qui a deux propriétés, `Name` et `Price`.</span><span class="sxs-lookup"><span data-stu-id="2b194-113">Variable `namePriceQuery` holds the definition of a query that, when it is executed, returns a collection of instances of an anonymous type that has two properties, `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#2](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_2.vb)]  
  
 <span data-ttu-id="2b194-114">Variable `nameQuantityQuery` contient la définition d’une requête qui, lorsqu’elle est exécutée, retourne une collection d’instances d’un type anonyme qui a deux propriétés, `Name` et `OnHand`.</span><span class="sxs-lookup"><span data-stu-id="2b194-114">Variable `nameQuantityQuery` holds the definition of a query that, when it is executed, returns a collection of instances of an anonymous type that has two properties, `Name` and `OnHand`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#3](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_3.vb)]  
  
 <span data-ttu-id="2b194-115">Pour plus d’informations sur le code créé par le compilateur pour un type anonyme, consultez [définition de Type anonyme](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md).</span><span class="sxs-lookup"><span data-stu-id="2b194-115">For more information about the code created by the compiler for an anonymous type, see [Anonymous Type Definition](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md).</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="2b194-116">Le nom du type anonyme est compilateur généré et peut varier de compilation en compilation.</span><span class="sxs-lookup"><span data-stu-id="2b194-116">The name of the anonymous type is compiler generated and may vary from compilation to compilation.</span></span> <span data-ttu-id="2b194-117">Votre code ne doit pas utiliser ou s’appuient sur le nom d’un type anonyme, car le nom peut changer lorsqu’un projet est recompilé.</span><span class="sxs-lookup"><span data-stu-id="2b194-117">Your code should not use or rely on the name of an anonymous type because the name might change when a project is recompiled.</span></span>  
  
## <a name="declaring-an-anonymous-type"></a><span data-ttu-id="2b194-118">Déclaration d’un Type anonyme</span><span class="sxs-lookup"><span data-stu-id="2b194-118">Declaring an Anonymous Type</span></span>  
 <span data-ttu-id="2b194-119">La déclaration d’une instance d’un type anonyme utilise une liste d’initialiseurs pour spécifier les propriétés du type.</span><span class="sxs-lookup"><span data-stu-id="2b194-119">The declaration of an instance of an anonymous type uses an initializer list to specify the properties of the type.</span></span> <span data-ttu-id="2b194-120">Vous pouvez spécifier uniquement les propriétés lorsque vous déclarez un type anonyme, pas autres éléments de classe telles que des méthodes ou des événements.</span><span class="sxs-lookup"><span data-stu-id="2b194-120">You can specify only properties when you declare an anonymous type, not other class elements such as methods or events.</span></span> <span data-ttu-id="2b194-121">Dans l’exemple suivant, `product1` est une instance d’un type anonyme qui a deux propriétés : `Name` et `Price`.</span><span class="sxs-lookup"><span data-stu-id="2b194-121">In the following example, `product1` is an instance of an anonymous type that has two properties: `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#4](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_4.vb)]  
  
 <span data-ttu-id="2b194-122">Si vous désignez des propriétés comme propriétés de clé, vous pouvez les utiliser pour comparer deux instances de type anonyme sont égales.</span><span class="sxs-lookup"><span data-stu-id="2b194-122">If you designate properties as key properties, you can use them to compare two anonymous type instances for equality.</span></span> <span data-ttu-id="2b194-123">Toutefois, les valeurs des propriétés de clé ne peut pas être modifiés.</span><span class="sxs-lookup"><span data-stu-id="2b194-123">However, the values of key properties cannot be changed.</span></span> <span data-ttu-id="2b194-124">Consultez la section Propriétés de clé plus loin dans cette rubrique pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="2b194-124">See the Key Properties section later in this topic for more information.</span></span>  
  
 <span data-ttu-id="2b194-125">Notez que la déclaration d’une instance d’un type anonyme est semblable à la déclaration d’une instance d’un type nommé à l’aide d’un initialiseur d’objet :</span><span class="sxs-lookup"><span data-stu-id="2b194-125">Notice that declaring an instance of an anonymous type is like declaring an instance of a named type by using an object initializer:</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#5](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_5.vb)]  
  
 <span data-ttu-id="2b194-126">Pour plus d’informations sur les autres façons de spécifier les propriétés de type anonymes, consultez [Comment : déduire les noms de propriétés et les Types dans les déclarations de Type anonyme](../../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md).</span><span class="sxs-lookup"><span data-stu-id="2b194-126">For more information about other ways to specify anonymous type properties, see [How to: Infer Property Names and Types in Anonymous Type Declarations](../../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md).</span></span>  
  
## <a name="key-properties"></a><span data-ttu-id="2b194-127">Propriétés de clé</span><span class="sxs-lookup"><span data-stu-id="2b194-127">Key Properties</span></span>  
 <span data-ttu-id="2b194-128">Propriétés de clé diffèrent des propriétés non-clés de plusieurs manières fondamentales :</span><span class="sxs-lookup"><span data-stu-id="2b194-128">Key properties differ from non-key properties in several fundamental ways:</span></span>  
  
-   <span data-ttu-id="2b194-129">Seules les valeurs des propriétés de clé sont comparées afin de déterminer si deux instances sont égales.</span><span class="sxs-lookup"><span data-stu-id="2b194-129">Only the values of key properties are compared in order to determine whether two instances are equal.</span></span>  
  
-   <span data-ttu-id="2b194-130">Les valeurs des propriétés de clé sont en lecture seule et ne peut pas être modifiés.</span><span class="sxs-lookup"><span data-stu-id="2b194-130">The values of key properties are read-only and cannot be changed.</span></span>  
  
-   <span data-ttu-id="2b194-131">Uniquement les valeurs de propriété de clé sont incluses dans l’algorithme de code généré par le compilateur de hachage pour un type anonyme.</span><span class="sxs-lookup"><span data-stu-id="2b194-131">Only key property values are included in the compiler-generated hash code algorithm for an anonymous type.</span></span>  
  
### <a name="equality"></a><span data-ttu-id="2b194-132">Égalité</span><span class="sxs-lookup"><span data-stu-id="2b194-132">Equality</span></span>  
 <span data-ttu-id="2b194-133">Instances de types anonymes peuvent être égales uniquement si elles sont des instances du même type anonyme.</span><span class="sxs-lookup"><span data-stu-id="2b194-133">Instances of anonymous types can be equal only if they are instances of the same anonymous type.</span></span> <span data-ttu-id="2b194-134">Le compilateur traite deux instances comme instances du même type si elles répondent aux conditions suivantes :</span><span class="sxs-lookup"><span data-stu-id="2b194-134">The compiler treats two instances as instances of the same type if they meet the following conditions:</span></span>  
  
-   <span data-ttu-id="2b194-135">Ils sont déclarés dans le même assembly.</span><span class="sxs-lookup"><span data-stu-id="2b194-135">They are declared in the same assembly.</span></span>  
  
-   <span data-ttu-id="2b194-136">Leurs propriétés ont les mêmes noms, les mêmes types déduits et sont déclarées dans le même ordre.</span><span class="sxs-lookup"><span data-stu-id="2b194-136">Their properties have the same names, the same inferred types, and are declared in the same order.</span></span> <span data-ttu-id="2b194-137">Les comparaisons de noms ne respectent pas la casse.</span><span class="sxs-lookup"><span data-stu-id="2b194-137">Name comparisons are not case-sensitive.</span></span>  
  
-   <span data-ttu-id="2b194-138">Les mêmes propriétés dans chaque sont marquées comme propriétés de clé.</span><span class="sxs-lookup"><span data-stu-id="2b194-138">The same properties in each are marked as key properties.</span></span>  
  
-   <span data-ttu-id="2b194-139">Au moins une propriété de chaque déclaration est une propriété de clé.</span><span class="sxs-lookup"><span data-stu-id="2b194-139">At least one property in each declaration is a key property.</span></span>  
  
 <span data-ttu-id="2b194-140">Une instance d’un type anonyme qui ne possède aucune propriété de clé est uniquement égale à elle-même.</span><span class="sxs-lookup"><span data-stu-id="2b194-140">An instance of an anonymous types that has no key properties is equal only to itself.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#6](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_6.vb)]  
  
 <span data-ttu-id="2b194-141">Deux instances du même type anonyme sont égales si les valeurs de leurs propriétés de clé sont égales.</span><span class="sxs-lookup"><span data-stu-id="2b194-141">Two instances of the same anonymous type are equal if the values of their key properties are equal.</span></span> <span data-ttu-id="2b194-142">Les exemples suivants illustrent la façon dont l’égalité est testée.</span><span class="sxs-lookup"><span data-stu-id="2b194-142">The following examples illustrate how equality is tested.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#7](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_7.vb)]  
  
### <a name="read-only-values"></a><span data-ttu-id="2b194-143">Valeurs en lecture seule</span><span class="sxs-lookup"><span data-stu-id="2b194-143">Read-Only Values</span></span>  
 <span data-ttu-id="2b194-144">Les valeurs des propriétés de clé ne peut pas être modifiés.</span><span class="sxs-lookup"><span data-stu-id="2b194-144">The values of key properties cannot be changed.</span></span> <span data-ttu-id="2b194-145">Par exemple, dans `prod8` dans l’exemple précédent, le `Name` et `Price` sont des champs `read-only`, mais `OnHand` peut être modifié.</span><span class="sxs-lookup"><span data-stu-id="2b194-145">For example, in `prod8` in the previous example, the `Name` and `Price` fields are `read-only`, but `OnHand` can be changed.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#8](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_8.vb)]  
  
## <a name="anonymous-types-from-query-expressions"></a><span data-ttu-id="2b194-146">Types anonymes à partir d’Expressions de requête</span><span class="sxs-lookup"><span data-stu-id="2b194-146">Anonymous Types from Query Expressions</span></span>  
 <span data-ttu-id="2b194-147">Les expressions de requête ne nécessitent pas toujours de la création de types anonymes.</span><span class="sxs-lookup"><span data-stu-id="2b194-147">Query expressions do not always require the creation of anonymous types.</span></span> <span data-ttu-id="2b194-148">Lorsque cela est possible, ils utilisent un type existant pour contenir les données de colonne.</span><span class="sxs-lookup"><span data-stu-id="2b194-148">When possible, they use an existing type to hold the column data.</span></span> <span data-ttu-id="2b194-149">Cela se produit lorsque la requête retourne des enregistrements entiers à partir de la source de données, ou qu’un seul champ de chaque enregistrement.</span><span class="sxs-lookup"><span data-stu-id="2b194-149">This occurs when the query returns either whole records from the data source, or only one field from each record.</span></span> <span data-ttu-id="2b194-150">Dans les exemples de code suivants, `customers` est une collection d’objets d’un `Customer` classe.</span><span class="sxs-lookup"><span data-stu-id="2b194-150">In the following code examples, `customers` is a collection of objects of a `Customer` class.</span></span> <span data-ttu-id="2b194-151">La classe possède de nombreuses propriétés, et vous pouvez inclure un ou plusieurs d'entre eux dans le résultat de requête, dans n’importe quel ordre.</span><span class="sxs-lookup"><span data-stu-id="2b194-151">The class has many properties, and you can include one or more of them in the query result, in any order.</span></span> <span data-ttu-id="2b194-152">Dans les deux premiers exemples, aucun type anonyme n’est requis, car les requêtes sélectionnent les éléments de types nommés :</span><span class="sxs-lookup"><span data-stu-id="2b194-152">In the first two examples, no anonymous types are required because the queries select elements of named types:</span></span>  
  
-   <span data-ttu-id="2b194-153">`custs1`contient une collection de chaînes, car `cust.Name` est une chaîne.</span><span class="sxs-lookup"><span data-stu-id="2b194-153">`custs1` contains a collection of strings, because `cust.Name` is a string.</span></span>  
  
     [!code-vb[VbVbalrAnonymousTypes#30](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_9.vb)]  
  
-   <span data-ttu-id="2b194-154">`custs2`contient une collection de `Customer` des objets, car chaque élément de `customers` est un `Customer` objet et l’élément entier est sélectionné par la requête.</span><span class="sxs-lookup"><span data-stu-id="2b194-154">`custs2` contains a collection of `Customer` objects, because each element of `customers` is a `Customer` object, and the whole element is selected by the query.</span></span>  
  
     [!code-vb[VbVbalrAnonymousTypes#31](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_10.vb)]  
  
 <span data-ttu-id="2b194-155">Toutefois, les types nommés appropriés ne sont pas toujours disponibles.</span><span class="sxs-lookup"><span data-stu-id="2b194-155">However, appropriate named types are not always available.</span></span> <span data-ttu-id="2b194-156">Vous pouvez souhaiter sélectionner les noms des clients et des adresses pour un objectif, les numéros d’ID de client et les emplacements pour une autre et les noms des clients, les adresses et historiques de commande pour un tiers.</span><span class="sxs-lookup"><span data-stu-id="2b194-156">You might want to select customer names and addresses for one purpose, customer ID numbers and locations for another, and customer names, addresses, and order histories for a third.</span></span> <span data-ttu-id="2b194-157">Les types anonymes vous permettent de vous permet de sélectionner n’importe quelle combinaison de propriétés, dans n’importe quel ordre, sans déclarer d’abord un nouveau type nommé pour contenir le résultat.</span><span class="sxs-lookup"><span data-stu-id="2b194-157">Anonymous types enable you to select any combination of properties, in any order, without first declaring a new named type to hold the result.</span></span> <span data-ttu-id="2b194-158">Au lieu de cela, le compilateur crée un type anonyme pour chaque compilation de propriétés.</span><span class="sxs-lookup"><span data-stu-id="2b194-158">Instead, the compiler creates an anonymous type for each compilation of properties.</span></span> <span data-ttu-id="2b194-159">La requête suivante sélectionne uniquement le nom du client et numéro d’identification de chaque `Customer` dans l’objet `customers`.</span><span class="sxs-lookup"><span data-stu-id="2b194-159">The following query selects only the customer's name and ID number from each `Customer` object in `customers`.</span></span> <span data-ttu-id="2b194-160">Par conséquent, le compilateur crée un type anonyme qui contient uniquement ces deux propriétés.</span><span class="sxs-lookup"><span data-stu-id="2b194-160">Therefore, the compiler creates an anonymous type that contains only those two properties.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTYpes#32](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_11.vb)]  
  
 <span data-ttu-id="2b194-161">Les noms et les types de données des propriétés du type anonyme sont effectuées à partir des arguments à `Select`, `cust.Name` et `cust.ID`.</span><span class="sxs-lookup"><span data-stu-id="2b194-161">Both the names and the data types of the properties in the anonymous type are taken from the arguments to `Select`, `cust.Name` and `cust.ID`.</span></span> <span data-ttu-id="2b194-162">Les propriétés dans un type anonyme qui est créé par une requête sont toujours des propriétés de clé.</span><span class="sxs-lookup"><span data-stu-id="2b194-162">The properties in an anonymous type that is created by a query are always key properties.</span></span> <span data-ttu-id="2b194-163">Lorsque `custs3` est exécutée dans l’exemple suivant `For Each` boucle, le résultat est une collection d’instances d’un type anonyme avec deux propriétés de clé, `Name` et `ID`.</span><span class="sxs-lookup"><span data-stu-id="2b194-163">When `custs3` is executed in the following `For Each` loop, the result is a collection of instances of an anonymous type with two key properties, `Name` and `ID`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#33](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_12.vb)]  
  
 <span data-ttu-id="2b194-164">Les éléments de la collection représentée par `custs3` sont fortement typées, et vous pouvez utiliser IntelliSense pour naviguer dans les propriétés disponibles et vérifier leurs types.</span><span class="sxs-lookup"><span data-stu-id="2b194-164">The elements in the collection represented by `custs3` are strongly typed, and you can use IntelliSense to navigate through the available properties and to verify their types.</span></span>  
  
 <span data-ttu-id="2b194-165">Pour plus d’informations, consultez [Introduction à LINQ en Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md).</span><span class="sxs-lookup"><span data-stu-id="2b194-165">For more information, see [Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md).</span></span>  
  
## <a name="deciding-whether-to-use-anonymous-types"></a><span data-ttu-id="2b194-166">S’il faut utiliser des Types anonymes</span><span class="sxs-lookup"><span data-stu-id="2b194-166">Deciding Whether to Use Anonymous Types</span></span>  
 <span data-ttu-id="2b194-167">Avant de créer un objet en tant qu’instance d’une classe anonyme, considérez si c’est la meilleure option.</span><span class="sxs-lookup"><span data-stu-id="2b194-167">Before you create an object as an instance of an anonymous class, consider whether that is the best option.</span></span> <span data-ttu-id="2b194-168">Par exemple, si vous souhaitez créer un objet temporaire pour contenir les données connexes, et vous n’avez pas besoin d’autres champs et les méthodes susceptibles de contenir une classe complète, un type anonyme est une bonne solution.</span><span class="sxs-lookup"><span data-stu-id="2b194-168">For example, if you want to create a temporary object to contain related data, and you have no need for other fields and methods that a complete class might contain, an anonymous type is a good solution.</span></span> <span data-ttu-id="2b194-169">Les types anonymes sont également pratiques si vous souhaitez une autre sélection de propriétés pour chaque déclaration ou si vous souhaitez modifier l’ordre des propriétés.</span><span class="sxs-lookup"><span data-stu-id="2b194-169">Anonymous types are also convenient if you want a different selection of properties for each declaration, or if you want to change the order of the properties.</span></span> <span data-ttu-id="2b194-170">Toutefois, si votre projet inclut plusieurs objets qui ont les mêmes propriétés, dans un ordre fixe, vous pouvez les déclarer plus facilement à l’aide d’un type nommé avec un constructeur de classe.</span><span class="sxs-lookup"><span data-stu-id="2b194-170">However, if your project includes several objects that have the same properties, in a fixed order, you can declare them more easily by using a named type with a class constructor.</span></span> <span data-ttu-id="2b194-171">Par exemple, avec un constructeur approprié, il est plus facile de déclarer plusieurs instances d’un `Product` classe plutôt que de déclarer plusieurs instances d’un type anonyme.</span><span class="sxs-lookup"><span data-stu-id="2b194-171">For example, with an appropriate constructor, it is easier to declare several instances of a `Product` class than it is to declare several instances of an anonymous type.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#9](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_13.vb)]  
  
 <span data-ttu-id="2b194-172">Un autre avantage des types nommés est que le compilateur peut intercepter une erreur de frappe accidentelle d’un nom de propriété.</span><span class="sxs-lookup"><span data-stu-id="2b194-172">Another advantage of named types is that the compiler can catch an accidental mistyping of a property name.</span></span> <span data-ttu-id="2b194-173">Dans les exemples précédents, `firstProd2`, `secondProd2`, et `thirdProd2` sont destinés à être des instances du même type anonyme.</span><span class="sxs-lookup"><span data-stu-id="2b194-173">In the previous examples, `firstProd2`, `secondProd2`, and `thirdProd2` are intended to be instances of the same anonymous type.</span></span> <span data-ttu-id="2b194-174">Toutefois, si vous avez accidentellement déclarer `thirdProd2` dans une des façons suivantes, son type serait différent de celui du `firstProd2` et `secondProd2`.</span><span class="sxs-lookup"><span data-stu-id="2b194-174">However, if you were to accidentally declare `thirdProd2` in one of the following ways, its type would be different from that of `firstProd2` and `secondProd2`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#10](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_14.vb)]  
  
 <span data-ttu-id="2b194-175">Plus important encore, il existe des limitations sur l’utilisation de types anonymes qui ne s’appliquent pas aux instances de types nommés.</span><span class="sxs-lookup"><span data-stu-id="2b194-175">More importantly, there are limitations on the use of anonymous types that do not apply to instances of named types.</span></span> <span data-ttu-id="2b194-176">`firstProd2`, `secondProd2`, et `thirdProd2` sont des instances du même type anonyme.</span><span class="sxs-lookup"><span data-stu-id="2b194-176">`firstProd2`, `secondProd2`, and `thirdProd2` are instances of the same anonymous type.</span></span> <span data-ttu-id="2b194-177">Toutefois, le nom du type anonyme partagé n’est pas disponible et ne peut pas apparaître dans lequel un nom de type est attendu dans votre code.</span><span class="sxs-lookup"><span data-stu-id="2b194-177">However, the name for the shared anonymous type is not available and cannot appear where a type name is expected in your code.</span></span> <span data-ttu-id="2b194-178">Par exemple, un type anonyme ne peut pas être utilisé pour définir une signature de méthode pour déclarer une autre variable ou champ ou dans une déclaration de type.</span><span class="sxs-lookup"><span data-stu-id="2b194-178">For example, an anonymous type cannot be used to define a method signature, to declare another variable or field, or in any type declaration.</span></span> <span data-ttu-id="2b194-179">Par conséquent, les types anonymes ne sont pas appropriés lorsque vous avez besoin de partager des informations pour toutes les méthodes.</span><span class="sxs-lookup"><span data-stu-id="2b194-179">As a result, anonymous types are not appropriate when you have to share information across methods.</span></span>  
  
## <a name="an-anonymous-type-definition"></a><span data-ttu-id="2b194-180">Une définition de Type anonyme</span><span class="sxs-lookup"><span data-stu-id="2b194-180">An Anonymous Type Definition</span></span>  
 <span data-ttu-id="2b194-181">En réponse à la déclaration d’une instance d’un type anonyme, le compilateur crée une nouvelle définition de classe qui contient les propriétés spécifiées.</span><span class="sxs-lookup"><span data-stu-id="2b194-181">In response to the declaration of an instance of an anonymous type, the compiler creates a new class definition that contains the specified properties.</span></span>  
  
 <span data-ttu-id="2b194-182">Si le type anonyme contient au moins une propriété de clé, la définition substitue trois membres hérités de <xref:System.Object>: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, et <xref:System.Object.ToString%2A>.</span><span class="sxs-lookup"><span data-stu-id="2b194-182">If the anonymous type contains at least one key property, the definition overrides three members inherited from <xref:System.Object>: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, and <xref:System.Object.ToString%2A>.</span></span> <span data-ttu-id="2b194-183">Le code produit pour tester l’égalité et de la détermination de que la valeur de code de hachage considère uniquement les propriétés de clé.</span><span class="sxs-lookup"><span data-stu-id="2b194-183">The code produced for testing equality and determining the hash code value considers only the key properties.</span></span> <span data-ttu-id="2b194-184">Si le type anonyme ne contient aucune propriété de clé, seulement <xref:System.Object.ToString%2A> est remplacée.</span><span class="sxs-lookup"><span data-stu-id="2b194-184">If the anonymous type contains no key properties, only <xref:System.Object.ToString%2A> is overridden.</span></span> <span data-ttu-id="2b194-185">Propriétés explicitement nommées d’un type anonyme ne peut pas entrer en conflit avec ces méthodes générées.</span><span class="sxs-lookup"><span data-stu-id="2b194-185">Explicitly named properties of an anonymous type cannot conflict with these generated methods.</span></span> <span data-ttu-id="2b194-186">Autrement dit, vous ne pouvez pas utiliser `.Equals`, `.GetHashCode`, ou `.ToString` pour nommer une propriété.</span><span class="sxs-lookup"><span data-stu-id="2b194-186">That is, you cannot use `.Equals`, `.GetHashCode`, or `.ToString` to name a property.</span></span>  
  
 <span data-ttu-id="2b194-187">Les définitions de type anonyme qui ont au moins une propriété de clé implémentent également le <xref:System.IEquatable%601?displayProperty=nameWithType> interface, où `T` est le type du type anonyme.</span><span class="sxs-lookup"><span data-stu-id="2b194-187">Anonymous type definitions that have at least one key property also implement the <xref:System.IEquatable%601?displayProperty=nameWithType> interface, where `T` is the type of the anonymous type.</span></span>  
  
 <span data-ttu-id="2b194-188">Pour plus d’informations sur le code créé par le compilateur et les fonctionnalités des méthodes substituées, consultez [définition de Type anonyme](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md).</span><span class="sxs-lookup"><span data-stu-id="2b194-188">For more information about the code created by the compiler and the functionality of the overridden methods, see [Anonymous Type Definition](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2b194-189">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2b194-189">See Also</span></span>  
 [<span data-ttu-id="2b194-190">Initialiseurs d’objets : types nommés et anonymes</span><span class="sxs-lookup"><span data-stu-id="2b194-190">Object Initializers: Named and Anonymous Types</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)  
 [<span data-ttu-id="2b194-191">Inférence de type local</span><span class="sxs-lookup"><span data-stu-id="2b194-191">Local Type Inference</span></span>](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)  
 [<span data-ttu-id="2b194-192">Introduction à LINQ en Visual Basic</span><span class="sxs-lookup"><span data-stu-id="2b194-192">Introduction to LINQ in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)  
 [<span data-ttu-id="2b194-193">Guide pratique : déduire les types et les noms de propriétés dans des déclarations de types anonymes</span><span class="sxs-lookup"><span data-stu-id="2b194-193">How to: Infer Property Names and Types in Anonymous Type Declarations</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md)  
 [<span data-ttu-id="2b194-194">Définition du type anonyme</span><span class="sxs-lookup"><span data-stu-id="2b194-194">Anonymous Type Definition</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md)  
 [<span data-ttu-id="2b194-195">Key</span><span class="sxs-lookup"><span data-stu-id="2b194-195">Key</span></span>](../../../../visual-basic/language-reference/modifiers/key.md)
