---
title: "Vue d'ensemble des applications Windows Forms et non managées"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-winforms
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- COM [Windows Forms]
- Windows Forms, unmanaged
- COM interop
- ActiveX controls [Windows Forms], about ActiveX controls
- Windows Forms, interop
ms.assetid: 0a26d99d-8135-4895-8760-c9a2b5f67f14
caps.latest.revision: "12"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 9ad64588727584a9b3de0a95e9bad252a3fb0581
ms.sourcegitcommit: c0dd436f6f8f44dc80dc43b07f6841a00b74b23f
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/19/2018
---
# <a name="windows-forms-and-unmanaged-applications-overview"></a><span data-ttu-id="8e55a-102">Vue d'ensemble des applications Windows Forms et non managées</span><span class="sxs-lookup"><span data-stu-id="8e55a-102">Windows Forms and Unmanaged Applications Overview</span></span>
<span data-ttu-id="8e55a-103">Les contrôles et les applications Windows Forms peuvent interagir avec des applications non managées, avec certaines restrictions.</span><span class="sxs-lookup"><span data-stu-id="8e55a-103">Windows Forms applications and controls can interoperate with unmanaged applications, with some caveats.</span></span> <span data-ttu-id="8e55a-104">Les sections suivantes décrivent les scénarios et les configurations pris en charge et non pris en charge par les applications et les contrôles Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="8e55a-104">The following sections describe the scenarios and configurations that Windows Forms applications and controls support and those that they do not support.</span></span>  
  
## <a name="windows-forms-controls-and-activex-applications"></a><span data-ttu-id="8e55a-105">Contrôles Windows Forms et Applications ActiveX</span><span class="sxs-lookup"><span data-stu-id="8e55a-105">Windows Forms Controls and ActiveX Applications</span></span>  
 <span data-ttu-id="8e55a-106">À l'exception de Microsoft Internet Explorer et de Microsoft Foundation Classes (MFC), les contrôles Windows Forms ne sont pas pris en charge dans les applications conçues pour héberger des contrôles ActiveX.</span><span class="sxs-lookup"><span data-stu-id="8e55a-106">With the exception of Microsoft Internet Explorer and Microsoft Foundation Classes (MFC), Windows Forms controls are not supported in applications designed to host ActiveX controls.</span></span> <span data-ttu-id="8e55a-107">Les autres applications et outils de développement capables d'héberger des contrôles ActiveX, y compris les conteneurs de test ActiveX des versions de Visual Studio antérieures à Visual Studio .NET 2003, ne sont pas des hôtes pris en charge pour les contrôles Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="8e55a-107">Other applications and development tools that are capable of hosting ActiveX controls, including the ActiveX test containers from versions of Visual Studio that are earlier than Visual Studio .NET 2003, are not supported hosts for Windows Forms controls.</span></span>  
  
 <span data-ttu-id="8e55a-108">Ces contraintes s'appliquent également à l'utilisation des contrôles Windows Forms via l'interopérabilité COM Component Object Model.</span><span class="sxs-lookup"><span data-stu-id="8e55a-108">These constraints also apply to the use of Windows Forms controls through Component Object Model COM interop.</span></span> <span data-ttu-id="8e55a-109">L'utilisation d'un contrôle Windows Forms via un wrapper CCW (COM Callable Wrapper) est prise en charge uniquement dans Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="8e55a-109">The use of a Windows Forms control through a COM callable wrapper (CCW) is supported only in Internet Explorer.</span></span> <span data-ttu-id="8e55a-110">Pour plus d'informations sur l'interopérabilité COM, consultez</span><span class="sxs-lookup"><span data-stu-id="8e55a-110">For more information about COM interop, see</span></span>  
  
 <span data-ttu-id="8e55a-111">[COM Interop](../../../visual-basic/programming-guide/com-interop/index.md).</span><span class="sxs-lookup"><span data-stu-id="8e55a-111">[COM Interop](../../../visual-basic/programming-guide/com-interop/index.md).</span></span>  
  
 <span data-ttu-id="8e55a-112">Le tableau suivant indique la prise en charge de l'hébergement ActiveX disponible pour les contrôles Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="8e55a-112">The following table shows the available ActiveX hosting support for Windows Forms controls.</span></span>  
  
|<span data-ttu-id="8e55a-113">Version de Windows Forms</span><span class="sxs-lookup"><span data-stu-id="8e55a-113">Windows Forms version</span></span>|<span data-ttu-id="8e55a-114">Prise en charge</span><span class="sxs-lookup"><span data-stu-id="8e55a-114">Support</span></span>|  
|---------------------------|-------------|  
|<span data-ttu-id="8e55a-115">.NET Framework version 1.0</span><span class="sxs-lookup"><span data-stu-id="8e55a-115">.NET Framework version 1.0</span></span>|<span data-ttu-id="8e55a-116">Internet Explorer 5.01 et versions ultérieures</span><span class="sxs-lookup"><span data-stu-id="8e55a-116">Internet Explorer 5.01 and later versions</span></span>|  
|<span data-ttu-id="8e55a-117">.NET Framework version 1.1 et ultérieures</span><span class="sxs-lookup"><span data-stu-id="8e55a-117">.NET Framework version 1.1 and later</span></span>|<span data-ttu-id="8e55a-118">Internet Explorer 5.01 et versions ultérieures</span><span class="sxs-lookup"><span data-stu-id="8e55a-118">Internet Explorer 5.01 and later versions</span></span><br /><br /> <span data-ttu-id="8e55a-119">Bibliothèque MFC (Microsoft Foundation Class) 7.0 et versions ultérieures</span><span class="sxs-lookup"><span data-stu-id="8e55a-119">Microsoft Foundation Classes (MFC) 7.0 and later</span></span>|  
  
## <a name="hosting-windows-forms-components-as-activex-controls"></a><span data-ttu-id="8e55a-120">Hébergement de composants Windows Forms en tant que contrôles ActiveX</span><span class="sxs-lookup"><span data-stu-id="8e55a-120">Hosting Windows Forms components as ActiveX controls</span></span>  
 <span data-ttu-id="8e55a-121">Dans .NET Framework 1.1, la prise en charge a été étendue pour inclure MFC 7.0 et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="8e55a-121">In the .NET Framework 1.1, support was extended to include MFC 7.0 and later versions.</span></span> <span data-ttu-id="8e55a-122">Cette prise en charge comprend tout conteneur qui est entièrement compatible avec le conteneur de contrôles ActiveX MFC 7.0 et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="8e55a-122">This support includes any container that is fully compatible with the MFC 7.0 and later ActiveX control container.</span></span>  
  
 <span data-ttu-id="8e55a-123">Toutefois, l'inscription des contrôles Windows Forms en tant que contrôles ActiveX n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="8e55a-123">However, registration of Windows Forms controls as ActiveX controls is not supported.</span></span> <span data-ttu-id="8e55a-124">En outre, l'appel de la méthode `com.ms.win32.Ole32.CoCreateInstance` pour les contrôles Windows Forms n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="8e55a-124">Also, calling the `com.ms.win32.Ole32.CoCreateInstance` method for Windows Forms controls is not supported.</span></span> <span data-ttu-id="8e55a-125">Seule l'activation managée des contrôles Windows Forms est prise en charge.</span><span class="sxs-lookup"><span data-stu-id="8e55a-125">Only managed activation of Windows Forms controls is supported.</span></span> <span data-ttu-id="8e55a-126">Une fois que vous avez créé un contrôle Windows Forms, vous pouvez l'héberger dans une application MFC comme tout contrôle ActiveX.</span><span class="sxs-lookup"><span data-stu-id="8e55a-126">Once you create a Windows Forms control, you can host it in an MFC application just as with an ActiveX control.</span></span>  
  
 <span data-ttu-id="8e55a-127">Pour utiliser des contrôles Windows Forms dans votre application non managée, vous devez soit héberger le CLR à l'aide des API d'hébergement CLR non managées, soit utiliser les fonctionnalités d'interopérabilité C++.</span><span class="sxs-lookup"><span data-stu-id="8e55a-127">To use Windows Forms controls in your unmanaged application, you must either host the CLR using the unmanaged CLR hosting APIs or use the C++ interop features.</span></span> <span data-ttu-id="8e55a-128">L'utilisation des fonctionnalités d'interopérabilité C++ est la solution recommandée.</span><span class="sxs-lookup"><span data-stu-id="8e55a-128">Using the C++ interop features is the recommended solution.</span></span>  
  
## <a name="windows-forms-in-com-client-applications"></a><span data-ttu-id="8e55a-129">Windows Forms dans les applications clientes COM</span><span class="sxs-lookup"><span data-stu-id="8e55a-129">Windows Forms in COM client applications</span></span>  
 <span data-ttu-id="8e55a-130">Quand vous ouvrez un Windows Form à partir d'une application cliente COM, telle qu'une application Visual Basic 6.0 ou une application MFC, le formulaire peut se comporter de façon inattendue.</span><span class="sxs-lookup"><span data-stu-id="8e55a-130">When you open a Windows Form from a COM client application, such as a Visual Basic 6.0 application or an MFC application, the form may behave unexpectedly.</span></span> <span data-ttu-id="8e55a-131">Par exemple, quand vous appuyez sur la touche Tab, le focus ne passe pas d'un contrôle à un autre.</span><span class="sxs-lookup"><span data-stu-id="8e55a-131">For example, when you press the TAB key, the focus does not change from one control to another control.</span></span> <span data-ttu-id="8e55a-132">Quand vous appuyez sur la touche Entrée pendant qu'un bouton de commande a le focus, l'événement <xref:System.Windows.Forms.Control.Click> du bouton n'est pas déclenché.</span><span class="sxs-lookup"><span data-stu-id="8e55a-132">When you press the ENTER key while a command button has focus, the button's <xref:System.Windows.Forms.Control.Click> event is not raised.</span></span> <span data-ttu-id="8e55a-133">Vous pouvez également constater un comportement inattendu pour les combinaisons de touches ou l'activité de la souris.</span><span class="sxs-lookup"><span data-stu-id="8e55a-133">You may also experience unexpected behavior for keystrokes or mouse activity.</span></span>  
  
 <span data-ttu-id="8e55a-134">Ce comportement se produit car l'application non managée n'implémente pas la prise en charge de boucle de message dont Windows Forms a besoin pour fonctionner correctement.</span><span class="sxs-lookup"><span data-stu-id="8e55a-134">This behavior occurs because the unmanaged application does not implement the message loop support that Windows Forms requires to work correctly.</span></span> <span data-ttu-id="8e55a-135">La boucle de message fournie par l'application cliente COM est fondamentalement différente de la boucle de message Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="8e55a-135">The message loop provided by the COM client application is fundamentally different from the Windows Forms message loop.</span></span>  
  
 <span data-ttu-id="8e55a-136">La boucle de message d'une application est une boucle de programme interne qui récupère les messages à partir de la file d'attente de messages d'un thread, les traduit, puis les envoie à l'application pour qu'ils soient gérés.</span><span class="sxs-lookup"><span data-stu-id="8e55a-136">An application's message loop is an internal program loop that retrieves messages from a thread's message queue, translates them, and then sends them to the application to be handled.</span></span> <span data-ttu-id="8e55a-137">La boucle de message pour un Windows Form n'a pas la même architecture que les boucles de messages fournies par les applications antérieures, telles que les applications Visual Basic 6.0 et les applications MFC.</span><span class="sxs-lookup"><span data-stu-id="8e55a-137">The message loop for a Windows Form does not have the same architecture as message loops that earlier applications, such as Visual Basic 6.0 applications and MFC applications, provide.</span></span> <span data-ttu-id="8e55a-138">Les messages de fenêtre publiés dans la boucle de message peuvent être traités différemment de ce à quoi s'attend le Windows Form.</span><span class="sxs-lookup"><span data-stu-id="8e55a-138">The window messages that are posted to the message loop may be handled differently than the Windows Form expects.</span></span> <span data-ttu-id="8e55a-139">Ainsi, un comportement inattendu peut se produire.</span><span class="sxs-lookup"><span data-stu-id="8e55a-139">Therefore, unexpected behavior may occur.</span></span> <span data-ttu-id="8e55a-140">Certaines combinaisons de touches peuvent ne pas fonctionner, certaines activités de la souris peuvent ne pas fonctionne ou certains événements peuvent ne pas être déclenchés comme prévu.</span><span class="sxs-lookup"><span data-stu-id="8e55a-140">Some keystroke combinations may not work, some mouse activity may not work, or some events may not be raised as expected.</span></span>  
  
## <a name="resolving-interoperability-issues"></a><span data-ttu-id="8e55a-141">Résolution des problèmes d'interopérabilité</span><span class="sxs-lookup"><span data-stu-id="8e55a-141">Resolving Interoperability Issues</span></span>  
 <span data-ttu-id="8e55a-142">Vous pouvez résoudre ces problèmes en affichant le formulaire sur une boucle de message [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], que vous pouvez créer à l'aide de la méthode <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="8e55a-142">You can resolve these problems by displaying the form on a [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] message loop, which is created by using the <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="8e55a-143">Pour qu'un Windows Form fonctionne correctement à partir d'une application cliente COM, vous devez l'exécuter sur une boucle de message Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="8e55a-143">To make a Windows Form work correctly from a COM client application, you must run it on a Windows Forms message loop.</span></span> <span data-ttu-id="8e55a-144">Pour cela, utilisez l'une des approches suivantes :</span><span class="sxs-lookup"><span data-stu-id="8e55a-144">To do this, use one of the following approaches:</span></span>  
  
-   <span data-ttu-id="8e55a-145">Utilisez la méthode <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> pour afficher le Windows Form.</span><span class="sxs-lookup"><span data-stu-id="8e55a-145">Use the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method to display the Windows Form.</span></span> <span data-ttu-id="8e55a-146">Pour plus d'informations, consultez [How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method](../../../../docs/framework/winforms/advanced/com-interop-by-displaying-a-windows-form-shadow.md).</span><span class="sxs-lookup"><span data-stu-id="8e55a-146">For more information, see [How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method](../../../../docs/framework/winforms/advanced/com-interop-by-displaying-a-windows-form-shadow.md).</span></span>  
  
-   <span data-ttu-id="8e55a-147">Affichez chaque Windows Form sur un nouveau thread.</span><span class="sxs-lookup"><span data-stu-id="8e55a-147">Display each Windows Form on a new thread.</span></span> <span data-ttu-id="8e55a-148">Pour plus d’informations, consultez [Comment : prendre en charge l’interopérabilité COM en affichant chaque Windows Form sur son propre thread](../../../../docs/framework/winforms/advanced/how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md).</span><span class="sxs-lookup"><span data-stu-id="8e55a-148">For more information, see [How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread](../../../../docs/framework/winforms/advanced/how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8e55a-149">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="8e55a-149">See Also</span></span>  
 [<span data-ttu-id="8e55a-150">Applications Windows Forms et non managées</span><span class="sxs-lookup"><span data-stu-id="8e55a-150">Windows Forms and Unmanaged Applications</span></span>](../../../../docs/framework/winforms/advanced/windows-forms-and-unmanaged-applications.md)  
 [<span data-ttu-id="8e55a-151">COM Interop</span><span class="sxs-lookup"><span data-stu-id="8e55a-151">COM Interop</span></span>](../../../visual-basic/programming-guide/com-interop/index.md)  
 [<span data-ttu-id="8e55a-152">Interopérabilité COM dans les applications .NET Framework</span><span class="sxs-lookup"><span data-stu-id="8e55a-152">COM Interoperability in .NET Framework Applications</span></span>](~/docs/visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)  
 [<span data-ttu-id="8e55a-153">Exemples d’interopérabilité COM</span><span class="sxs-lookup"><span data-stu-id="8e55a-153">COM Interoperability Samples</span></span>](http://msdn.microsoft.com/library/09c38567-6380-4d70-848a-e896a4ca05f4)  
 [<span data-ttu-id="8e55a-154">Aximp.exe (importateur de contrôles Active X Windows Forms)</span><span class="sxs-lookup"><span data-stu-id="8e55a-154">Aximp.exe (Windows Forms ActiveX Control Importer)</span></span>](../../../../docs/framework/tools/aximp-exe-windows-forms-activex-control-importer.md)  
 [<span data-ttu-id="8e55a-155">Exposition de composants .NET Framework à COM</span><span class="sxs-lookup"><span data-stu-id="8e55a-155">Exposing .NET Framework Components to COM</span></span>](../../../../docs/framework/interop/exposing-dotnet-components-to-com.md)  
 [<span data-ttu-id="8e55a-156">Empaquetage d'un assembly pour COM</span><span class="sxs-lookup"><span data-stu-id="8e55a-156">Packaging an Assembly for COM</span></span>](../../../../docs/framework/interop/packaging-an-assembly-for-com.md)  
 [<span data-ttu-id="8e55a-157">Inscription d’assemblys dans COM</span><span class="sxs-lookup"><span data-stu-id="8e55a-157">Registering Assemblies with COM</span></span>](../../../../docs/framework/interop/registering-assemblies-with-com.md)  
 [<span data-ttu-id="8e55a-158">Guide pratique pour prendre en charge COM Interop en affichant un Windows Form avec la méthode ShowDialog</span><span class="sxs-lookup"><span data-stu-id="8e55a-158">How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method</span></span>](../../../../docs/framework/winforms/advanced/com-interop-by-displaying-a-windows-form-shadow.md)  
 [<span data-ttu-id="8e55a-159">Comment : prendre en charge l’interopérabilité COM en affichant chaque Windows Form sur son propre thread</span><span class="sxs-lookup"><span data-stu-id="8e55a-159">How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread</span></span>](../../../../docs/framework/winforms/advanced/how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)
