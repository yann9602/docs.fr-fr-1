---
title: "Authentification Windows intégrée avec protection étendue"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 81731998-d5e7-49e4-ad38-c8e6d01689d0
caps.latest.revision: "13"
author: mcleblanc
ms.author: markl
manager: markl
ms.workload: dotnet
ms.openlocfilehash: a453a2142ee8c3d1ab8d8d00e84e1ead60c46d91
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/22/2017
---
# <a name="integrated-windows-authentication-with-extended-protection"></a><span data-ttu-id="b7cbb-102">Authentification Windows intégrée avec protection étendue</span><span class="sxs-lookup"><span data-stu-id="b7cbb-102">Integrated Windows Authentication with Extended Protection</span></span>
<span data-ttu-id="b7cbb-103">Certaines améliorations apportées changent la manière dont l’authentification Windows intégrée est gérée par les classes <xref:System.Net.HttpWebRequest>, <xref:System.Net.HttpListener>, <xref:System.Net.Mail.SmtpClient>, <xref:System.Net.Security.SslStream>, <xref:System.Net.Security.NegotiateStream> et les classes associées dans l’espace de noms <xref:System.Net> et les espaces de noms associés.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-103">Enhancements were made that affect how integrated Windows authentication is handled by the <xref:System.Net.HttpWebRequest>, <xref:System.Net.HttpListener>, <xref:System.Net.Mail.SmtpClient>, <xref:System.Net.Security.SslStream>, <xref:System.Net.Security.NegotiateStream>, and related classes in the <xref:System.Net> and related namespaces.</span></span> <span data-ttu-id="b7cbb-104">La prise en charge de la protection étendue a été ajoutée pour renforcer la sécurité.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-104">Support was added for extended protection to enhance security.</span></span>  
  
 <span data-ttu-id="b7cbb-105">Ces modifications peuvent affecter les applications qui utilisent ces classes pour effectuer des demandes web et recevoir des réponses quand l’authentification Windows intégrée est utilisée.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-105">These changes can affect applications that use these classes to make web requests and receive responses where integrated Windows authentication is used.</span></span> <span data-ttu-id="b7cbb-106">Elles peuvent aussi avoir un impact sur les serveurs web et les applications clientes configurés pour utiliser l’authentification Windows intégrée.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-106">This change can also impact web servers and client applications that are configured to use integrated Windows authentication.</span></span>  
  
 <span data-ttu-id="b7cbb-107">Ces modifications peuvent affecter les applications qui utilisent ces classes pour effectuer d’autres types de demandes et recevoir des réponses quand l’authentification Windows intégrée est utilisée.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-107">These changes can also affect applications that use these classes to make other types of requests and receive responses where integrated Windows authentication is used.</span></span>  
  
 <span data-ttu-id="b7cbb-108">Les modifications pour la prise en charge de la protection étendue concernent uniquement les applications s’exécutant sur Windows 7 et Windows Server 2008 R2.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-108">The changes to support extended protection are available only for applications on Windows 7 and Windows Server 2008 R2.</span></span> <span data-ttu-id="b7cbb-109">Les fonctionnalités de protection étendue ne sont pas disponibles dans les versions antérieures de Windows.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-109">The extended protection features are not available on earlier versions of Windows.</span></span>  
  
## <a name="overview"></a><span data-ttu-id="b7cbb-110">Vue d'ensemble</span><span class="sxs-lookup"><span data-stu-id="b7cbb-110">Overview</span></span>  
 <span data-ttu-id="b7cbb-111">La conception de l’authentification Windows intégrée permet à certaines réponses aux demandes d’informations d’identification d’être universelles, ce qui signifie qu’elles peuvent être réutilisées ou transférées.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-111">The design of integrated Windows authentication allows for some credential challenge responses to be universal, meaning they can be re-used or forwarded.</span></span> <span data-ttu-id="b7cbb-112">Les réponses aux demandes doivent être construites au minimum avec des informations spécifiques à la cible et, de préférence, avec également des informations spécifiques au canal.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-112">The challenge responses should be constructed at a minimum with target specific information and preferably also with some channel specific information.</span></span> <span data-ttu-id="b7cbb-113">Les services peuvent alors fournir une protection étendue pour garantir que les réponses aux demandes d’informations d’identification contiennent des informations propres aux services, telles qu’un nom de principal du service (SPN).</span><span class="sxs-lookup"><span data-stu-id="b7cbb-113">Services can then provide extended protection to ensure that credential challenge responses contain service specific information such as a Service Principal Name (SPN).</span></span> <span data-ttu-id="b7cbb-114">Grâce à la présence de ces informations dans les échanges d’informations d’identification, les services assurent une meilleure protection contre l’utilisation malveillante de certaines réponses aux demandes d’informations d’identification qui ont été utilisées de manière incorrecte.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-114">With this information in the credential exchanges, services are able to better protect against malicious use of credential challenge responses that might have been improperly used.</span></span>  
  
 <span data-ttu-id="b7cbb-115">La conception de la protection étendue est une amélioration apportée aux protocoles d’authentification qui vise à atténuer les risques d’attaques par relais d’authentification.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-115">The extended protection design is an enhancement to authentication protocols designed to mitigate authentication relay attacks.</span></span> <span data-ttu-id="b7cbb-116">Elle repose sur le concept d’informations de liaison de service et de canal.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-116">It revolves around the concept of channel and service binding information.</span></span>  
  
 <span data-ttu-id="b7cbb-117">Les objectifs généraux sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="b7cbb-117">The overall objectives are the following:</span></span>  
  
1.  <span data-ttu-id="b7cbb-118">Si le client est mis à jour pour prendre en charge la protection étendue, les applications doivent fournir des informations de liaison de service et de canal à tous les protocoles d’authentification pris en charge.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-118">If the client is updated to support the extended protection, applications should supply a channel binding and service binding information to all supported authentication protocols.</span></span> <span data-ttu-id="b7cbb-119">Les informations de liaison de canal peuvent uniquement être fournies s’il y a un canal TLS auquel effectuer la liaison.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-119">Channel binding information can only be supplied when there is a channel (TLS) to bind to.</span></span> <span data-ttu-id="b7cbb-120">Les informations de liaison de service doivent toujours être fournies.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-120">Service binding information should always be supplied.</span></span>  
  
2.  <span data-ttu-id="b7cbb-121">S’ils sont configurés de manière appropriée, les serveurs mis à jour vérifient les informations de liaison de service et de canal contenues dans le jeton d’authentification client et rejettent la tentative d’authentification si les liaisons de canal ne correspondent pas.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-121">Updated servers which are properly configured may verify the channel and service binding information when it is present in the client authentication token and reject the authentication attempt if the channel bindings do not match.</span></span> <span data-ttu-id="b7cbb-122">Selon le scénario de déploiement, les serveurs vérifient la liaison de canal ou la liaison de service, ou les deux liaisons.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-122">Depending on the deployment scenario, servers may verify channel binding, service binding or both.</span></span>  
  
3.  <span data-ttu-id="b7cbb-123">Les serveurs mis à jour ont la possibilité d’accepter ou de rejeter les demandes de client de bas niveau qui ne contiennent pas les informations de liaison de canal basées sur la stratégie.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-123">Updated servers have the ability to accept or reject down-level client requests that do not contain the channel binding information based on policy.</span></span>  
  
 <span data-ttu-id="b7cbb-124">Les informations utilisées par la protection étendue sont constituées d’au moins un des deux éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="b7cbb-124">Information used by extended protection consists of one or both of the following two parts:</span></span>  
  
1.  <span data-ttu-id="b7cbb-125">Un jeton de liaison de canal.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-125">A Channel Binding Token or CBT.</span></span>  
  
2.  <span data-ttu-id="b7cbb-126">Des informations de liaison de service sous la forme d’un nom de principal du service (SPN).</span><span class="sxs-lookup"><span data-stu-id="b7cbb-126">Service Binding information in the form of a Service Principal Name or SPN.</span></span>  
  
 <span data-ttu-id="b7cbb-127">Les informations de liaison de service sont une indication de l’intention d’un client de s’authentifier auprès d’un point de terminaison de service particulier.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-127">Service Binding information is an indication of a client’s intent to authenticate to a particular service endpoint.</span></span> <span data-ttu-id="b7cbb-128">Elles sont transmises du client au serveur avec les propriétés suivantes :</span><span class="sxs-lookup"><span data-stu-id="b7cbb-128">It is communicated from client to server with the following properties:</span></span>  
  
-   <span data-ttu-id="b7cbb-129">La valeur du SPN doit être fournie au serveur d’authentification client au format texte en clair.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-129">The SPN value must be available to the server performing client authentication in clear text form.</span></span>  
  
-   <span data-ttu-id="b7cbb-130">La valeur du SPN est publique.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-130">The value of the SPN is public.</span></span>  
  
-   <span data-ttu-id="b7cbb-131">Le SPN doit être protégé par chiffrement pendant son transfert pour empêcher l’insertion, la suppression ou la modification de sa valeur par une attaque de l’intercepteur.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-131">The SPN must be cryptographically protected in transit such that a man-in-the-middle attack cannot insert, remove or modify its value.</span></span>  
  
 <span data-ttu-id="b7cbb-132">Un jeton de liaison de canal est une propriété du canal sécurisé externe (par exemple, TLS) qui permet de lier ce canal à une conversation sur un canal interne authentifié par le client.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-132">A CBT is a property of the outer secure channel (such as TLS) used to tie (bind) it to a conversation over an inner, client-authenticated channel.</span></span> <span data-ttu-id="b7cbb-133">Le jeton de liaison de canal doit avoir les propriétés suivantes (qui sont également définies dans la norme RFC 5056 publiée par l’IETF) :</span><span class="sxs-lookup"><span data-stu-id="b7cbb-133">The CBT must have the following properties (also defined by IETF RFC 5056):</span></span>  
  
-   <span data-ttu-id="b7cbb-134">Quand un canal externe existe, la valeur du jeton de liaison de canal doit être une propriété qui identifie le canal externe ou le point de terminaison de serveur, arrivés indépendamment côté client et côté serveur d’une conversation.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-134">When an outer channel exists, the value of the CBT must be a property identifying either the outer channel or the server endpoint, independently arrived at by both client and server sides of a conversation.</span></span>  
  
-   <span data-ttu-id="b7cbb-135">La valeur du jeton de liaison de canal envoyé par le client ne doit pas être une valeur falsifiable par un attaquant.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-135">Value of the CBT sent by the client must not be something an attacker can influence.</span></span>  
  
-   <span data-ttu-id="b7cbb-136">La confidentialité de la valeur du jeton de liaison de canal n’est pas garantie.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-136">No guarantees are made about secrecy of the CBT value.</span></span> <span data-ttu-id="b7cbb-137">Toutefois, cela ne signifie pas que la valeur de la liaison de service ou que les informations de liaison de canal seront toujours exposées à d’autres parties que le serveur effectuant l’authentification, car elles sont parfois chiffrées par le protocole de transport du jeton de liaison de canal.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-137">This does not however mean that the value of the service binding as well as channel binding information can always be examined by any other but the server performing authentication, as the protocol carrying the CBT may be encrypting it.</span></span>  
  
-   <span data-ttu-id="b7cbb-138">L’intégrité du jeton de liaison de canal doit être protégée par chiffrement pendant le transfert du jeton pour empêcher l’insertion, la suppression ou la modification de sa valeur par un attaquant.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-138">The CBT must be cryptographically integrity protected in transit such that an attacker cannot insert, remove or modify its value.</span></span>  
  
 <span data-ttu-id="b7cbb-139">La liaison de canal s’effectue par le client qui transfère le SPN et le jeton de liaison de canal au serveur de manière infalsifiable.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-139">Channel binding is accomplished by the client transferring the SPN and the CBT to the server in a tamperproof fashion.</span></span> <span data-ttu-id="b7cbb-140">Le serveur valide les informations de liaison de canal conformément à sa stratégie et rejette les tentatives d’authentification pour lesquelles il ne pense pas être la cible prévue.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-140">The server validates the channel binding information in accordance with its policy and rejects authentication attempts for which it does not believe itself to have been the intended target.</span></span> <span data-ttu-id="b7cbb-141">Les deux canaux sont ainsi liés par chiffrement.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-141">This way, the two channels become cryptographically bound together.</span></span>  
  
 <span data-ttu-id="b7cbb-142">Pour garantir la compatibilité avec les clients et applications existants, un serveur peut être configuré pour autoriser les tentatives d’authentification effectuées par des clients qui ne prennent pas encore en charge la protection étendue.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-142">To preserve compatibility with existing clients and applications, a server may be configured to allow authentication attempts by clients that do not yet support extended protection.</span></span> <span data-ttu-id="b7cbb-143">Cette configuration est « partiellement sécurisée », au lieu d’être « entièrement sécurisée ».</span><span class="sxs-lookup"><span data-stu-id="b7cbb-143">This is referred to as a "partially hardened" configuration, in contrast to a "fully hardened" configuration.</span></span>  
  
 <span data-ttu-id="b7cbb-144">Plusieurs composants des espaces de noms <xref:System.Net> et <xref:System.Net.Security> effectuent l’authentification Windows intégrée pour le compte d’une application appelante.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-144">Multiple components in the <xref:System.Net> and <xref:System.Net.Security> namespaces perform integrated Windows authentication on behalf of a calling application.</span></span> <span data-ttu-id="b7cbb-145">Cette section décrit les modifications apportées aux composants System.Net pour ajouter une protection étendue lors de l’utilisation de l’authentification Windows intégrée.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-145">This section describes changes to System.Net components to add extended protection in their use of integrated Windows authentication.</span></span>  
  
 <span data-ttu-id="b7cbb-146">La protection étendue est prise en charge sur Windows 7.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-146">Extended protection is currently supported on Windows 7.</span></span> <span data-ttu-id="b7cbb-147">Un mécanisme intégré permet à une application de déterminer si le système d’exploitation prend en charge la protection étendue.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-147">A mechanism is provided so an application can determine if the operating system supports extended protection.</span></span>  
  
## <a name="changes-to-support-extended-protection"></a><span data-ttu-id="b7cbb-148">Modifications pour prendre en charge la protection étendue</span><span class="sxs-lookup"><span data-stu-id="b7cbb-148">Changes to Support Extended Protection</span></span>  
 <span data-ttu-id="b7cbb-149">Selon le protocole d’authentification choisi, le processus d’authentification utilisé avec l’authentification Windows intégrée inclut souvent une réponse émise par l’ordinateur de destination et renvoyée à l’ordinateur client.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-149">The authentication process used with integrated Windows authentication, depending on the authentication protocol used, often includes a challenge issued by the destination computer and sent back to the client computer.</span></span> <span data-ttu-id="b7cbb-150">La protection étendue ajoute de nouvelles fonctionnalités à ce processus d’authentification.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-150">Extended protection adds new features to this authentication process</span></span>  
  
 <span data-ttu-id="b7cbb-151">L’espace de noms <xref:System.Security.Authentication.ExtendedProtection> fournit la prise en charge de l’authentification avec protection étendue pour les applications.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-151">The <xref:System.Security.Authentication.ExtendedProtection> namespace provides support for authentication using extended protection for applications.</span></span> <span data-ttu-id="b7cbb-152">Dans cet espace de noms, la classe <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> représente une liaison de canal.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-152">The <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> class in this namespace represents a channel binding.</span></span> <span data-ttu-id="b7cbb-153">Dans cet espace de noms, la classe <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> représente la stratégie de protection étendue utilisée par le serveur pour valider les connexions client entrantes.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-153">The <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> class in this namespace represents the extended protection policy used by the server to validate incoming client connections.</span></span> <span data-ttu-id="b7cbb-154">D’autres membres de classe sont utilisés avec la protection étendue.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-154">Other class members are used with extended protection.</span></span>  
  
 <span data-ttu-id="b7cbb-155">Pour les applications serveur, ces classes comportent les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="b7cbb-155">For server applications, these classes include the following:</span></span>  
  
 <span data-ttu-id="b7cbb-156">Une classe <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> qui a les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="b7cbb-156">A <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> that has the following elements:</span></span>  
  
-   <span data-ttu-id="b7cbb-157">Une propriété <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy.OSSupportsExtendedProtection%2A> qui indique si le système d’exploitation prend en charge l’authentification Windows intégrée avec protection étendue.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-157">An <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy.OSSupportsExtendedProtection%2A> property that indicates whether the operating system supports integrated windows authentication with extended protection.</span></span>  
  
-   <span data-ttu-id="b7cbb-158">Une valeur <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> qui indique quand la stratégie de protection étendue doit être appliquée.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-158">A <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> value that indicates when the extended protection policy should be enforced.</span></span>  
  
-   <span data-ttu-id="b7cbb-159">Une valeur <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> qui spécifie le scénario de déploiement.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-159">A <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> value that indicates the deployment scenario.</span></span> <span data-ttu-id="b7cbb-160">Cette valeur détermine la façon dont la protection étendue est vérifiée.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-160">This influences how extended protection is checked.</span></span>  
  
-   <span data-ttu-id="b7cbb-161">Un élément <xref:System.Security.Authentication.ExtendedProtection.ServiceNameCollection> facultatif qui contient la liste des noms de principal de service personnalisés auxquels est comparé le nom de principal du service fourni par le client comme cible de l’authentification.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-161">An optional <xref:System.Security.Authentication.ExtendedProtection.ServiceNameCollection> that contains the custom SPN list that is used to match against the SPN provided by the client as the intended target of the authentication.</span></span>  
  
-   <span data-ttu-id="b7cbb-162">Un élément <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> facultatif qui contient une liaison de canal personnalisée à utiliser pour la validation.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-162">An optional <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> that contains a custom channel binding to use for validation.</span></span> <span data-ttu-id="b7cbb-163">Ce scénario n’est pas courant.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-163">This scenario is not a common case</span></span>  
  
 <span data-ttu-id="b7cbb-164">L’espace de noms <xref:System.Security.Authentication.ExtendedProtection.Configuration> fournit la prise en charge de la configuration de l’authentification avec protection étendue pour les applications.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-164">The <xref:System.Security.Authentication.ExtendedProtection.Configuration> namespace provides support for configuration of authentication using extended protection for applications.</span></span>  
  
 <span data-ttu-id="b7cbb-165">Plusieurs modifications ont été apportées aux fonctionnalités pour permettre la prise en charge de la protection étendue dans l’espace de noms <xref:System.Net> existant.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-165">A number of feature changes were made to support extended protection in the existing <xref:System.Net> namespace.</span></span> <span data-ttu-id="b7cbb-166">Ces modifications sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="b7cbb-166">These changes include the following:</span></span>  
  
-   <span data-ttu-id="b7cbb-167">Ajout d’une nouvelle classe <xref:System.Net.TransportContext> à l’espace de noms <xref:System.Net> qui représente un contexte de transport.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-167">A new <xref:System.Net.TransportContext> class added to the <xref:System.Net> namespace that represents a transport context.</span></span>  
  
-   <span data-ttu-id="b7cbb-168">Ajout des nouvelles méthodes de surcharge <xref:System.Net.HttpWebRequest.EndGetRequestStream%2A> et <xref:System.Net.HttpWebRequest.GetRequestStream%2A> dans la classe <xref:System.Net.HttpWebRequest> qui permettent la récupération du <xref:System.Net.TransportContext> pour prendre en charge la protection étendue dans les applications clientes.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-168">New <xref:System.Net.HttpWebRequest.EndGetRequestStream%2A> and <xref:System.Net.HttpWebRequest.GetRequestStream%2A> overload methods in the <xref:System.Net.HttpWebRequest> class that allow retrieving the <xref:System.Net.TransportContext> to support extended protection for client applications.</span></span>  
  
-   <span data-ttu-id="b7cbb-169">Ajouts aux classes <xref:System.Net.HttpListener> et <xref:System.Net.HttpListenerRequest> pour prendre en charge les applications serveur.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-169">Additions to the <xref:System.Net.HttpListener> and <xref:System.Net.HttpListenerRequest> classes to support server applications.</span></span>  
  
 <span data-ttu-id="b7cbb-170">Pour prendre en charge la protection étendue dans les applications clientes SMTP, une fonctionnalité a été modifiée dans l’espace de noms <xref:System.Net.Mail> :</span><span class="sxs-lookup"><span data-stu-id="b7cbb-170">A feature change was made to support extended protection for SMTP client applications in the existing <xref:System.Net.Mail> namespace:</span></span>  
  
-   <span data-ttu-id="b7cbb-171">Une propriété <xref:System.Net.Mail.SmtpClient.TargetName%2A> dans la classe <xref:System.Net.Mail.SmtpClient> qui représente le nom de principal du service à utiliser lors de l’authentification avec protection étendue dans les applications clientes SMTP.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-171">A <xref:System.Net.Mail.SmtpClient.TargetName%2A> property in the <xref:System.Net.Mail.SmtpClient> class that represents the SPN to use for authentication when using extended protection for SMTP client applications.</span></span>  
  
 <span data-ttu-id="b7cbb-172">Plusieurs modifications ont été apportées aux fonctionnalités pour permettre la prise en charge de la protection étendue dans l’espace de noms <xref:System.Net.Security> existant.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-172">A number of feature changes were made to support extended protection in the existing <xref:System.Net.Security> namespace.</span></span> <span data-ttu-id="b7cbb-173">Ces modifications sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="b7cbb-173">These changes include the following:</span></span>  
  
-   <span data-ttu-id="b7cbb-174">Ajout des nouvelles méthodes de surcharge <xref:System.Net.Security.NegotiateStream.BeginAuthenticateAsClient%2A> et <xref:System.Net.Security.NegotiateStream.AuthenticateAsClient%2A> dans la classe <xref:System.Net.Security.NegotiateStream> qui permettent le passage d’un jeton de liaison de canal pour prendre en charge la protection étendue dans les applications clientes.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-174">New <xref:System.Net.Security.NegotiateStream.BeginAuthenticateAsClient%2A> and <xref:System.Net.Security.NegotiateStream.AuthenticateAsClient%2A> overload methods in the <xref:System.Net.Security.NegotiateStream> class that allow passing a CBT to support extended protection for client applications.</span></span>  
  
-   <span data-ttu-id="b7cbb-175">Ajout des nouvelles méthodes de surcharge <xref:System.Net.Security.NegotiateStream.BeginAuthenticateAsServer%2A> et <xref:System.Net.Security.NegotiateStream.AuthenticateAsServer%2A> dans la classe <xref:System.Net.Security.NegotiateStream> qui permettent le passage d’un <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> pour prendre en charge la protection étendue dans les applications serveur.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-175">New <xref:System.Net.Security.NegotiateStream.BeginAuthenticateAsServer%2A> and <xref:System.Net.Security.NegotiateStream.AuthenticateAsServer%2A> overload methods in the <xref:System.Net.Security.NegotiateStream> class that allow passing an <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> to support extended protection for server applications.</span></span>  
  
-   <span data-ttu-id="b7cbb-176">Ajout d’une nouvelle propriété <xref:System.Net.Security.SslStream.TransportContext%2A> dans la classe <xref:System.Net.Security.SslStream> pour prendre en charge la protection étendue dans les applications clientes et serveur.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-176">A new <xref:System.Net.Security.SslStream.TransportContext%2A> property in the <xref:System.Net.Security.SslStream> class to support extended protection for client and server applications.</span></span>  
  
 <span data-ttu-id="b7cbb-177">Une nouvelle propriété <xref:System.Net.Configuration.SmtpNetworkElement> a été ajoutée dans l’espace de noms <xref:System.Net.Security> pour prendre en charge la configuration de la protection étendue pour les clients SMTP.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-177">A <xref:System.Net.Configuration.SmtpNetworkElement> property was added to support configuration of extended protection for SMTP clients in the <xref:System.Net.Security> namespace.</span></span>  
  
## <a name="extended-protection-for-client-applications"></a><span data-ttu-id="b7cbb-178">Protection étendue pour les applications clientes</span><span class="sxs-lookup"><span data-stu-id="b7cbb-178">Extended Protection for Client Applications</span></span>  
 <span data-ttu-id="b7cbb-179">La prise en charge de la protection étendue est automatique pour la plupart des applications clientes.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-179">Extended protection support for most client applications happens automatically.</span></span> <span data-ttu-id="b7cbb-180">Les classes <xref:System.Net.HttpWebRequest> et <xref:System.Net.Mail.SmtpClient> prennent en charge la protection étendue quand la version sous-jacente de Windows la prend en charge.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-180">The <xref:System.Net.HttpWebRequest> and <xref:System.Net.Mail.SmtpClient> classes support extended protection whenever the underlying version of Windows supports extended protection.</span></span> <span data-ttu-id="b7cbb-181">Une instance <xref:System.Net.HttpWebRequest> envoie un nom de principal du service construit à partir de l’<xref:System.Uri>.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-181">An <xref:System.Net.HttpWebRequest> instance sends an SPN constructed from the <xref:System.Uri>.</span></span> <span data-ttu-id="b7cbb-182">Par défaut, une instance <xref:System.Net.Mail.SmtpClient> envoie un nom de principal du service construit à partir du nom d’hôte du serveur de messagerie SMTP.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-182">By default, an <xref:System.Net.Mail.SmtpClient> instance sends an SPN constructed from the host name of the SMTP mail server.</span></span>  
  
 <span data-ttu-id="b7cbb-183">Pour l’authentification personnalisée, les applications clientes peuvent utiliser les méthodes <xref:System.Net.HttpWebRequest.EndGetRequestStream%28System.IAsyncResult%2CSystem.Net.TransportContext%40%29?displayProperty=nameWithType> ou <xref:System.Net.HttpWebRequest.GetRequestStream%28System.Net.TransportContext%40%29?displayProperty=nameWithType> de la classe <xref:System.Net.HttpWebRequest> qui permettent de récupérer le <xref:System.Net.TransportContext> et le jeton de liaison de canal à l’aide de la méthode <xref:System.Net.TransportContext.GetChannelBinding%2A>.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-183">For custom authentication, client applications can use the <xref:System.Net.HttpWebRequest.EndGetRequestStream%28System.IAsyncResult%2CSystem.Net.TransportContext%40%29?displayProperty=nameWithType> or <xref:System.Net.HttpWebRequest.GetRequestStream%28System.Net.TransportContext%40%29?displayProperty=nameWithType> methods in the <xref:System.Net.HttpWebRequest> class that allow retrieving the <xref:System.Net.TransportContext> and the CBT using the <xref:System.Net.TransportContext.GetChannelBinding%2A> method.</span></span>  
  
 <span data-ttu-id="b7cbb-184">Le nom de principal du service à utiliser pour l’authentification Windows intégrée et envoyé par une instance <xref:System.Net.HttpWebRequest> à un service donné peut être substitué en définissant la propriété <xref:System.Net.AuthenticationManager.CustomTargetNameDictionary%2A>.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-184">The SPN to use for integrated Windows authentication sent by an <xref:System.Net.HttpWebRequest> instance to a given service can be overridden by setting the <xref:System.Net.AuthenticationManager.CustomTargetNameDictionary%2A> property.</span></span>  
  
 <span data-ttu-id="b7cbb-185">La propriété <xref:System.Net.Mail.SmtpClient.TargetName%2A> permet de définir un nom principal de service personnalisé à utiliser pour l’authentification Windows intégrée de la connexion SMTP.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-185">The <xref:System.Net.Mail.SmtpClient.TargetName%2A> property can be used to set a custom SPN to use for integrated Windows authentication for the SMTP connection.</span></span>  
  
## <a name="extended-protection-for-server-applications"></a><span data-ttu-id="b7cbb-186">Protection étendue pour les applications serveur</span><span class="sxs-lookup"><span data-stu-id="b7cbb-186">Extended Protection for Server Applications</span></span>  
 <span data-ttu-id="b7cbb-187"><xref:System.Net.HttpListener> fournit automatiquement des mécanismes de validation des liaisons de service pendant l’authentification HTTP.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-187"><xref:System.Net.HttpListener> automatically provides mechanisms for validating service bindings when performing HTTP authentication.</span></span>  
  
 <span data-ttu-id="b7cbb-188">Le scénario le plus sécurisé consiste à activer la protection étendue pour les préfixes HTTPS://.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-188">The most secure scenario is to enable extended protection for HTTPS:// prefixes.</span></span> <span data-ttu-id="b7cbb-189">Dans ce cas, définissez <xref:System.Net.HttpListener.ExtendedProtectionPolicy%2A?displayProperty=nameWithType> à <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy>, où <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> a la valeur <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> ou <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> et où <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> a la valeur <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario.TransportSelected>. La valeur <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> met <xref:System.Net.HttpListener> en mode partiellement sécurisé, tandis que <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> correspond au mode entièrement sécurisé.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-189">In this case, set <xref:System.Net.HttpListener.ExtendedProtectionPolicy%2A?displayProperty=nameWithType> to an <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> with <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> set to <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> or <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>, and <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> set to <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario.TransportSelected> A value of  <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> puts <xref:System.Net.HttpListener> in partially hardened mode, while <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> corresponds to fully hardened mode.</span></span>  
  
 <span data-ttu-id="b7cbb-190">Dans cette configuration, quand une demande est envoyée au serveur via un canal sécurisé externe, celui-ci est interrogé pour fournir une liaison de canal.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-190">In this configuration when a request is made to the server through an outer secure channel, the outer channel is queried for a channel binding.</span></span> <span data-ttu-id="b7cbb-191">Cette liaison de canal est passée aux appels d’authentification SSPI, qui vérifient ensuite la correspondance avec la liaison de canal dans l’objet blob d’authentification.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-191">This channel binding is passed to the authentication SSPI calls, which validate that the channel binding in the authentication blob matches.</span></span> <span data-ttu-id="b7cbb-192">Il y a trois cas possibles :</span><span class="sxs-lookup"><span data-stu-id="b7cbb-192">There are three possible outcomes:</span></span>  
  
1.  <span data-ttu-id="b7cbb-193">Le système d’exploitation sous-jacent du serveur ne prend pas en charge la protection étendue.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-193">The server’s underlying operating system does not support extended protection.</span></span> <span data-ttu-id="b7cbb-194">La demande n’est pas exposée à l’application, et une réponse d’autorisation refusée (401) est retournée au client.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-194">The request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="b7cbb-195">Un message est consigné dans la source de la trace <xref:System.Net.HttpListener> indiquant la raison de l’échec.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-195">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
2.  <span data-ttu-id="b7cbb-196">L’appel SSPI échoue. Cela signifie que le client a spécifié une liaison de canal qui ne correspond pas à la valeur attendue récupérée à partir du canal externe, ou que le client n’a pas pu fournir de liaison de canal alors que la stratégie de protection étendue sur le serveur est configurée avec le paramètre <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-196">The SSPI call fails indicating that either the client specified a channel binding that did not match the expected value retrieved from the outer channel or the client failed to supply a channel binding when the extended protection policy on the server was configured for <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>.</span></span> <span data-ttu-id="b7cbb-197">Dans les deux cas, la demande n’est pas exposée à l’application, et une réponse d’autorisation refusée (401) est retournée au client.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-197">In both cases, the request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="b7cbb-198">Un message est consigné dans la source de la trace <xref:System.Net.HttpListener> indiquant la raison de l’échec.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-198">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
3.  <span data-ttu-id="b7cbb-199">Le client spécifie la liaison de canal appropriée ou bien il est autorisé à se connecter sans spécifier de liaison de canal du fait que la stratégie de protection étendue sur le serveur est configurée avec le paramètre <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported>. La demande est retournée à l’application pour être traitée.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-199">The client specifies the correct channel binding or is allowed to connect without specifying a channel binding since the extended protection policy on the server is configured with <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> The request is returned to the application for processing.</span></span> <span data-ttu-id="b7cbb-200">Aucune vérification de nom de service n’est effectuée automatiquement.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-200">No service name check is performed automatically.</span></span> <span data-ttu-id="b7cbb-201">Une application peut choisir d’effectuer elle-même la validation des noms de service à l’aide de la propriété <xref:System.Net.HttpListenerRequest.ServiceName%2A>, mais dans ce cas, cela est inutile.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-201">An application may choose to perform its own service name validation using the <xref:System.Net.HttpListenerRequest.ServiceName%2A> property, but under these circumstances it is redundant.</span></span>  
  
 <span data-ttu-id="b7cbb-202">Si une application effectue elle-même des appels SSPI dans le cadre d’une authentification basée sur les objets blob échangés dans le corps d’une requête HTTP et qu’elle souhaite prendre en charge la liaison de canal, elle doit récupérer la liaison de canal attendue du canal sécurisé externe en utilisant <xref:System.Net.HttpListener> pour la passer ensuite à la fonction [AcceptSecurityContext](http://go.microsoft.com/fwlink/?LinkId=147021) Win32.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-202">If an application makes its own SSPI calls to perform authentication based on blobs passed back and forth within the body of an HTTP request and wishes to support channel binding, it needs to retrieve the expected channel binding from the outer secure channel using <xref:System.Net.HttpListener> in order to pass it to native Win32 [AcceptSecurityContext](http://go.microsoft.com/fwlink/?LinkId=147021) function.</span></span> <span data-ttu-id="b7cbb-203">Pour cela, utilisez la propriété <xref:System.Net.HttpListenerRequest.TransportContext%2A> et appelez la méthode <xref:System.Net.TransportContext.GetChannelBinding%2A> qui permet de récupérer le jeton de liaison de canal.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-203">To do this, use the <xref:System.Net.HttpListenerRequest.TransportContext%2A> property and call <xref:System.Net.TransportContext.GetChannelBinding%2A> method to retrieve the CBT.</span></span> <span data-ttu-id="b7cbb-204">Seules les liaisons de point de terminaison sont prises en charge.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-204">Only endpoint bindings are supported.</span></span> <span data-ttu-id="b7cbb-205">Si une autre liaison que la liaison <xref:System.Security.Authentication.ExtendedProtection.ChannelBindingKind.Endpoint> est spécifiée, une <xref:System.NotSupportedException> est levée.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-205">If anything other <xref:System.Security.Authentication.ExtendedProtection.ChannelBindingKind.Endpoint> is specified, a <xref:System.NotSupportedException> will be thrown.</span></span> <span data-ttu-id="b7cbb-206">Si le système d’exploitation sous-jacent prend en charge la liaison de canal, la méthode <xref:System.Net.TransportContext.GetChannelBinding%2A> retourne un <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding><xref:System.Runtime.InteropServices.SafeHandle> enveloppant (wrap) un pointeur dans une liaison de canal qui permet de passer la fonction [AcceptSecurityContext](http://go.microsoft.com/fwlink/?LinkId=147021) comme membre pvBuffer d’une structure SecBuffer elle-même passée dans le paramètre `pInput`.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-206">If the underlying operating system supports channel binding, the <xref:System.Net.TransportContext.GetChannelBinding%2A> method will return a <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding><xref:System.Runtime.InteropServices.SafeHandle> wrapping a pointer to a channel binding suitable for passing to [AcceptSecurityContext](http://go.microsoft.com/fwlink/?LinkId=147021) function as the pvBuffer member of a SecBuffer structure passed in the `pInput` parameter.</span></span> <span data-ttu-id="b7cbb-207">La propriété <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding.Size%2A> contient la longueur, en octets, de la liaison de canal.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-207">The <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding.Size%2A> property contains the length, in bytes, of the channel binding.</span></span> <span data-ttu-id="b7cbb-208">Si le système d’exploitation sous-jacent ne prend pas en charge les liaisons de canal, la fonction retourne la valeur `null`.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-208">If the underlying operating system does not support channel bindings, the function will return `null`.</span></span>  
  
 <span data-ttu-id="b7cbb-209">Un autre scénario possible consiste à activer la protection étendue pour les préfixes HTTP:// quand les proxies ne sont pas utilisés.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-209">Another possible scenario is to enable extended protection for HTTP:// prefixes when proxies are not used.</span></span> <span data-ttu-id="b7cbb-210">Dans ce cas, définissez <xref:System.Net.HttpListener.ExtendedProtectionPolicy%2A?displayProperty=nameWithType> à <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy>, où <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> a la valeur <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> ou <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> et où <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> a la valeur <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario.TransportSelected>. La valeur <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> met <xref:System.Net.HttpListener> en mode partiellement sécurisé, tandis que <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> correspond au mode entièrement sécurisé.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-210">In this case, set <xref:System.Net.HttpListener.ExtendedProtectionPolicy%2A?displayProperty=nameWithType> to an <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> with <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> set to <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> or <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>, and <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> set to <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario.TransportSelected> A value of  <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> puts <xref:System.Net.HttpListener> in partially hardened mode, while <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> corresponds to fully hardened mode.</span></span>  
  
 <span data-ttu-id="b7cbb-211">Une liste par défaut de noms de service autorisés est créée à partir des préfixes qui ont été inscrits avec <xref:System.Net.HttpListener>.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-211">A default list of allowed service names is created based on the prefixes which have been registered with the <xref:System.Net.HttpListener>.</span></span> <span data-ttu-id="b7cbb-212">Cette liste par défaut peut être examinée à l’aide de la propriété <xref:System.Net.HttpListener.DefaultServiceNames%2A>.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-212">This default list can be examined through the <xref:System.Net.HttpListener.DefaultServiceNames%2A> property.</span></span> <span data-ttu-id="b7cbb-213">Si cette liste n’est pas complète, une application peut spécifier une collection de noms de service personnalisés dans le constructeur de la classe <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy>. Cette collection est alors utilisée à la place de la liste de noms de service par défaut.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-213">If this list is not comprehensive, an application can specify a custom service name collection in the constructor for the <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> class which will be used instead of the default service name list.</span></span>  
  
 <span data-ttu-id="b7cbb-214">Dans cette configuration, quand une demande est faite au serveur sans canal sécurisé externe, l’authentification s’effectue normalement, sans vérification de la liaison de canal.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-214">In this configuration, when a request is made to the server without an outer secure channel authentication proceeds normally without a channel binding check.</span></span> <span data-ttu-id="b7cbb-215">Si l’authentification réussit, le contexte est interrogé pour retourner le nom de service que le client a fourni et validé par rapport à la liste des noms de service autorisés.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-215">If the authentication succeeds, the context is queried for the service name that the client provided and validated against the list of acceptable service names.</span></span> <span data-ttu-id="b7cbb-216">Il y a quatre cas possibles :</span><span class="sxs-lookup"><span data-stu-id="b7cbb-216">There are four possible outcomes:</span></span>  
  
1.  <span data-ttu-id="b7cbb-217">Le système d’exploitation sous-jacent du serveur ne prend pas en charge la protection étendue.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-217">The server’s underlying operating system does not support extended protection.</span></span> <span data-ttu-id="b7cbb-218">La demande n’est pas exposée à l’application, et une réponse d’autorisation refusée (401) est retournée au client.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-218">The request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="b7cbb-219">Un message est consigné dans la source de la trace <xref:System.Net.HttpListener> indiquant la raison de l’échec.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-219">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
2.  <span data-ttu-id="b7cbb-220">Le système d’exploitation sous-jacent du client ne prend pas en charge la protection étendue.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-220">The client’s underlying operating system does not support extended protection.</span></span> <span data-ttu-id="b7cbb-221">Dans la configuration <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported>, la tentative d’authentification réussit et la demande est retournée à l’application.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-221">In the <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> configuration, the authentication attempt will succeed and the request will be returned to the application.</span></span> <span data-ttu-id="b7cbb-222">Dans la configuration <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>, la tentative d’authentification échoue.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-222">In the <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> configuration, the authentication attempt will fail.</span></span> <span data-ttu-id="b7cbb-223">La demande n’est pas exposée à l’application, et une réponse d’autorisation refusée (401) est retournée au client.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-223">The request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="b7cbb-224">Un message est consigné dans la source de la trace <xref:System.Net.HttpListener> indiquant la raison de l’échec.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-224">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
3.  <span data-ttu-id="b7cbb-225">Le système d’exploitation sous-jacent du client prend en charge la protection étendue, mais l’application n’a pas spécifié de liaison de service.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-225">The client’s underlying operating system supports extended protection, but the application did not specify a service binding.</span></span> <span data-ttu-id="b7cbb-226">La demande n’est pas exposée à l’application, et une réponse d’autorisation refusée (401) est retournée au client.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-226">The request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="b7cbb-227">Un message est consigné dans la source de la trace <xref:System.Net.HttpListener> indiquant la raison de l’échec.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-227">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
4.  <span data-ttu-id="b7cbb-228">Le client a spécifié une liaison de service.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-228">The client specified a service binding.</span></span> <span data-ttu-id="b7cbb-229">La liaison de service est comparée à la liste des liaisons de service autorisées.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-229">The service binding is compared to the list of allowed service bindings.</span></span> <span data-ttu-id="b7cbb-230">Si elle correspond à une liaison de la liste, la demande est retournée à l’application.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-230">If it matches, the request is returned to the application.</span></span> <span data-ttu-id="b7cbb-231">Sinon, la demande n’est pas exposée à l’application, et une réponse d’autorisation refusée (401) est automatiquement retournée au client.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-231">Otherwise, the request will not be exposed to the application, and an unauthorized (401) response will be automatically returned to the client.</span></span> <span data-ttu-id="b7cbb-232">Un message est consigné dans la source de la trace <xref:System.Net.HttpListener> indiquant la raison de l’échec.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-232">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
 <span data-ttu-id="b7cbb-233">Si cette approche simple basée sur une liste de noms de service autorisés est inappropriée, une application peut effectuer elle-même la validation des noms de service en interrogeant la propriété <xref:System.Net.HttpListenerRequest.ServiceName%2A>.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-233">If this simple approach using an allowed list of acceptable service names is insufficient, an application may provide its own service name validation by querying the <xref:System.Net.HttpListenerRequest.ServiceName%2A> property.</span></span> <span data-ttu-id="b7cbb-234">Dans les cas 1 et 2 ci-dessus, la propriété retourne `null`.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-234">In cases 1 and 2 above, the property will return `null`.</span></span> <span data-ttu-id="b7cbb-235">Dans le cas 3, elle retourne une chaîne vide.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-235">In case 3, it will return an empty string.</span></span> <span data-ttu-id="b7cbb-236">Dans le cas 4, elle retourne le nom de service spécifié par le client.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-236">In case 4, the service name specified by the client will be returned.</span></span>  
  
 <span data-ttu-id="b7cbb-237">Ces fonctionnalités de protection étendue peuvent également être utilisées par les applications serveur pour l’authentification avec d’autres types de demandes et quand des proxies approuvés sont utilisés.</span><span class="sxs-lookup"><span data-stu-id="b7cbb-237">These extended protection features can also be used by server applications for authentication with other types of requests and when trusted proxies are used.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b7cbb-238">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="b7cbb-238">See Also</span></span>  
 <xref:System.Security.Authentication.ExtendedProtection>  
 <xref:System.Security.Authentication.ExtendedProtection.Configuration>
