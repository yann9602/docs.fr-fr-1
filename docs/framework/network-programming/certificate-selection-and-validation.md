---
title: "Sélection et validation de certificats"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: c933aca2-4cd0-4ff1-9df9-267143f25a6f
caps.latest.revision: "15"
author: mcleblanc
ms.author: markl
manager: markl
ms.openlocfilehash: db75c3288b8247f0717c4792c57bfb30bb2e4416
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/21/2017
---
# <a name="certificate-selection-and-validation"></a><span data-ttu-id="3cdff-102">Sélection et validation de certificats</span><span class="sxs-lookup"><span data-stu-id="3cdff-102">Certificate Selection and Validation</span></span>
<span data-ttu-id="3cdff-103">Les classes <xref:System.Net> prennent en charge plusieurs manières de sélectionner et de valider <xref:System.Security.Cryptography.X509Certificates> pour les connexions SSL (Secure Socket Layer).</span><span class="sxs-lookup"><span data-stu-id="3cdff-103">The <xref:System.Net> classes support several ways to select and validate <xref:System.Security.Cryptography.X509Certificates> for Secure Socket Layer (SSL) connections.</span></span> <span data-ttu-id="3cdff-104">Un client peut sélectionner un ou plusieurs certificats pour s’authentifier auprès d’un serveur.</span><span class="sxs-lookup"><span data-stu-id="3cdff-104">A client can select one or more certificates to authenticate itself to a server.</span></span> <span data-ttu-id="3cdff-105">Un serveur peut exiger qu’un certificat client ait un ou plusieurs attributs spécifiques pour l’authentification.</span><span class="sxs-lookup"><span data-stu-id="3cdff-105">A server can require that a client certificate have one or more specific attributes for authentication.</span></span>  
  
## <a name="definition"></a><span data-ttu-id="3cdff-106">Définition</span><span class="sxs-lookup"><span data-stu-id="3cdff-106">Definition</span></span>  
 <span data-ttu-id="3cdff-107">Un certificat est un flux d’octets ASCII qui contient une clé publique, des attributs (tels que numéro de version, numéro de série et date d’expiration) et une signature numérique fournie par une autorité de certification.</span><span class="sxs-lookup"><span data-stu-id="3cdff-107">A certificate is an ASCII byte stream that contains a public key, attributes (such as version number, serial number, and expiration date) and a digital signature from a Certificate Authority.</span></span> <span data-ttu-id="3cdff-108">Les certificats servent à établir une connexion chiffrée ou à authentifier un client auprès d’un serveur.</span><span class="sxs-lookup"><span data-stu-id="3cdff-108">Certificates are used to establish an encrypted connection or to authenticate a client to a server.</span></span>  
  
## <a name="client-certificate-selection-and-validation"></a><span data-ttu-id="3cdff-109">Sélection et validation de certificats clients</span><span class="sxs-lookup"><span data-stu-id="3cdff-109">Client Certificate Selection and Validation</span></span>  
 <span data-ttu-id="3cdff-110">Un client peut sélectionner un ou plusieurs certificats pour une connexion SSL spécifique.</span><span class="sxs-lookup"><span data-stu-id="3cdff-110">A client can select one or more certificates for a specific SSL connection.</span></span> <span data-ttu-id="3cdff-111">Les certificats clients peuvent être associés à la connexion SSL à un serveur web ou à un serveur de messagerie SMTP.</span><span class="sxs-lookup"><span data-stu-id="3cdff-111">Client certificates can be associated with the SSL connection to a web server or an SMTP mail server.</span></span> <span data-ttu-id="3cdff-112">Un client ajoute des certificats à une collection d’objets de classe <xref:System.Security.Cryptography.X509Certificates.X509Certificate> ou <xref:System.Security.Cryptography.X509Certificates.X509Certificate2>.</span><span class="sxs-lookup"><span data-stu-id="3cdff-112">A client adds certificates to a collection of <xref:System.Security.Cryptography.X509Certificates.X509Certificate> or <xref:System.Security.Cryptography.X509Certificates.X509Certificate2> class objects.</span></span> <span data-ttu-id="3cdff-113">Si l’on prend la messagerie électronique comme exemple, la collection de certificats est une instance d’un <xref:System.Security.Cryptography.X509Certificates.X509CertificateCollection> associée à la propriété <xref:System.Net.Mail.SmtpClient.ClientCertificates%2A> de la classe <xref:System.Net.Mail.SmtpClient>.</span><span class="sxs-lookup"><span data-stu-id="3cdff-113">Using email as an example, the certificate collection is an instance of a <xref:System.Security.Cryptography.X509Certificates.X509CertificateCollection>) associated with the <xref:System.Net.Mail.SmtpClient.ClientCertificates%2A> property of the <xref:System.Net.Mail.SmtpClient> class.</span></span> <span data-ttu-id="3cdff-114">La classe <xref:System.Net.HttpWebRequest> a une propriété <xref:System.Net.HttpWebRequest.ClientCertificates%2A> similaire.</span><span class="sxs-lookup"><span data-stu-id="3cdff-114">The <xref:System.Net.HttpWebRequest> class has a similar <xref:System.Net.HttpWebRequest.ClientCertificates%2A> property.</span></span>  
  
 <span data-ttu-id="3cdff-115">La principale différence entre les classes <xref:System.Security.Cryptography.X509Certificates.X509Certificate> et <xref:System.Security.Cryptography.X509Certificates.X509Certificate2> est que la clé privée doit résider dans le magasin de certificats pour la classe <xref:System.Security.Cryptography.X509Certificates.X509Certificate>.</span><span class="sxs-lookup"><span data-stu-id="3cdff-115">The primary difference between the <xref:System.Security.Cryptography.X509Certificates.X509Certificate> and the <xref:System.Security.Cryptography.X509Certificates.X509Certificate2> class is that the private key must reside in the certificate store for the <xref:System.Security.Cryptography.X509Certificates.X509Certificate> class.</span></span>  
  
 <span data-ttu-id="3cdff-116">Même si des certificats sont ajoutés à une collection et associés à une connexion SSL spécifique, aucun certificat ne sera envoyé au serveur si celui-ci ne le demande pas.</span><span class="sxs-lookup"><span data-stu-id="3cdff-116">Even if certificates are added to a collection and associated with a specific SSL connection, no certificates will be sent to the server unless the server requests them.</span></span> <span data-ttu-id="3cdff-117">Si plusieurs certificats clients sont définis sur une connexion, le meilleur sera utilisé sur la base d’un algorithme qui prend en compte la correspondance entre les émetteurs de certificats figurant sur la liste fournie par le serveur et le nom de l’émetteur du certificat client.</span><span class="sxs-lookup"><span data-stu-id="3cdff-117">If multiple client certificates are set on a connection, the best one will be used based on an algorithm that considers the match between the list of certificate issuers provided by the server and the client certificate issuer name.</span></span>  
  
 <span data-ttu-id="3cdff-118">La classe <xref:System.Net.Security.SslStream> fournit un contrôle accru sur la négociation SSL.</span><span class="sxs-lookup"><span data-stu-id="3cdff-118">The <xref:System.Net.Security.SslStream> class provides even more control over the SSL handshake.</span></span> <span data-ttu-id="3cdff-119">Un client peut spécifier un délégué pour sélectionner le certificat client à utiliser.</span><span class="sxs-lookup"><span data-stu-id="3cdff-119">A client can specify a delegate to pick which client certificate to use.</span></span>  
  
 <span data-ttu-id="3cdff-120">Un serveur distant peut vérifier qu’un certificat client est valide, à jour et signé par l’autorité de certification appropriée.</span><span class="sxs-lookup"><span data-stu-id="3cdff-120">A remote server can verify that a client certificate is valid, current, and signed by the appropriate Certificate Authority.</span></span> <span data-ttu-id="3cdff-121">Un délégué peut être ajouté à <xref:System.Net.ServicePointManager.ServerCertificateValidationCallback%2A> pour appliquer la validation de certificat.</span><span class="sxs-lookup"><span data-stu-id="3cdff-121">A delegate can be added to the <xref:System.Net.ServicePointManager.ServerCertificateValidationCallback%2A> to enforce certificate validation.</span></span>  
  
## <a name="client-certificate-selection"></a><span data-ttu-id="3cdff-122">Sélection du certificat client</span><span class="sxs-lookup"><span data-stu-id="3cdff-122">Client Certificate Selection</span></span>  
 <span data-ttu-id="3cdff-123">Le .NET Framework sélectionne le certificat client à présenter au serveur de la manière suivante :</span><span class="sxs-lookup"><span data-stu-id="3cdff-123">The .NET Framework selects the client certificate to present to the server in the following manner:</span></span>  
  
1.  <span data-ttu-id="3cdff-124">Si un certificat client a été présenté précédemment au serveur, le certificat est mis en cache lors de la première présentation puis réutilisé lors des requêtes de certificats clients ultérieures.</span><span class="sxs-lookup"><span data-stu-id="3cdff-124">If a client certificate was presented previously to the server, the certificate is cached when first presented and is reused for subsequent client certificate requests.</span></span>  
  
2.  <span data-ttu-id="3cdff-125">Si un délégué est présent, utilisez toujours le résultat du délégué comme certificat client à sélectionner.</span><span class="sxs-lookup"><span data-stu-id="3cdff-125">If a delegate is present, always use the result from the delegate as the client certificate to select.</span></span> <span data-ttu-id="3cdff-126">Essayez d’utiliser un certificat mis en cache dans la mesure du possible, mais n’utilisez pas d’informations d’identification anonymes mises en cache si le délégué a retourné la valeur null et que la collection de certificats n’est pas vide.</span><span class="sxs-lookup"><span data-stu-id="3cdff-126">Try to use a cached certificate when possible, but do not use cached anonymous credentials if the delegate has returned null and the certificate collection is not empty.</span></span>  
  
3.  <span data-ttu-id="3cdff-127">S’il s’agit de la première demande de certificat client, le Framework énumère les certificats dans <xref:System.Security.Cryptography.X509Certificates.X509Certificate> ou les objets de classe <xref:System.Security.Cryptography.X509Certificates.X509Certificate2> associés à la connexion, à la recherche d’une correspondance entre les émetteurs de certificats figurant sur la liste fournie par le serveur et le nom de l’émetteur du certificat client.</span><span class="sxs-lookup"><span data-stu-id="3cdff-127">If this is the first challenge for a client certificate, the Framework enumerates the certificates in <xref:System.Security.Cryptography.X509Certificates.X509Certificate> or the <xref:System.Security.Cryptography.X509Certificates.X509Certificate2> class objects associated with the connection, looking for a match between the list of certificate issuers provided by the server and the client certificate issuer name.</span></span> <span data-ttu-id="3cdff-128">Le premier certificat qui correspond est envoyé au serveur.</span><span class="sxs-lookup"><span data-stu-id="3cdff-128">The first certificate that matches is sent to the server.</span></span> <span data-ttu-id="3cdff-129">Si aucun certificat ne correspond ou si la collection de certificats est vide, des informations d’identification anonymes sont envoyées au serveur.</span><span class="sxs-lookup"><span data-stu-id="3cdff-129">If no certificate matches or the certificate collection is empty, then an anonymous credential is sent to the server.</span></span>  
  
## <a name="tools-for-certificate-configuration"></a><span data-ttu-id="3cdff-130">Outils pour la configuration de certificat</span><span class="sxs-lookup"><span data-stu-id="3cdff-130">Tools for Certificate Configuration</span></span>  
 <span data-ttu-id="3cdff-131">Un certain nombre d’outils sont disponibles pour la configuration des certificats clients et de serveur.</span><span class="sxs-lookup"><span data-stu-id="3cdff-131">A number of tools are available for client and server certificate configuration.</span></span>  
  
 <span data-ttu-id="3cdff-132">Vous pouvez utiliser *Winhttpcertcfg.exe* pour configurer les certificats clients.</span><span class="sxs-lookup"><span data-stu-id="3cdff-132">The *Winhttpcertcfg.exe* tool can be used to configure client certificates.</span></span> <span data-ttu-id="3cdff-133">L’outil *Winhttpcertcfg.exe* est fourni avec le SDK Windows Server 2003.</span><span class="sxs-lookup"><span data-stu-id="3cdff-133">The *Winhttpcertcfg.exe* tool is provided as one of the tools with the Windows Server 2003 Resource Kit.</span></span> <span data-ttu-id="3cdff-134">Il est également disponible en téléchargement dans le cadre des Outils du Kit de ressources techniques Windows Server 2003 sur www.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="3cdff-134">This tool is also available as a download as part of the Windows Server 2003 Resource Kit Tools at www.microsoft.com.</span></span>  
  
 <span data-ttu-id="3cdff-135">Vous pouvez utiliser *HttpCfg.exe* pour configurer des certificats de serveur pour la classe <xref:System.Net.HttpListener>.</span><span class="sxs-lookup"><span data-stu-id="3cdff-135">*The HttpCfg.exe* tool can be used to configure server certificates for the <xref:System.Net.HttpListener> class.</span></span> <span data-ttu-id="3cdff-136">*HttpCfg.exe* est l’un des outils de support pour Windows Server 2003 et Windows XP Service Pack 2.</span><span class="sxs-lookup"><span data-stu-id="3cdff-136">The *HttpCfg.exe* tool is provided as one of the support tools for Windows Server 2003 and Windows XP Service Pack 2.</span></span> <span data-ttu-id="3cdff-137">*HttpCfg.exe* et les autres outils de support ne sont pas installés par défaut sur Windows Server 2003 ou Windows XP.</span><span class="sxs-lookup"><span data-stu-id="3cdff-137">*HttpCfg.exe* and the other support tools are not installed by default on either Windows Server 2003 or Windows XP.</span></span> <span data-ttu-id="3cdff-138">Sur Windows Server 2003,</span><span class="sxs-lookup"><span data-stu-id="3cdff-138">On Windows Server 2003.</span></span> <span data-ttu-id="3cdff-139">les outils de support sont installés séparément à partir du dossier et du fichier suivants sur le CD-ROM de Windows Server 2003 :</span><span class="sxs-lookup"><span data-stu-id="3cdff-139">the support tools are installed separately from the following folder and file on the Windows Server 2003 CD-ROM:</span></span>  
  
 <span data-ttu-id="3cdff-140">\Support\Tools\Suptools.msi</span><span class="sxs-lookup"><span data-stu-id="3cdff-140">\Support\Tools\Suptools.msi</span></span>  
  
 <span data-ttu-id="3cdff-141">Pour une utilisation avec Windows XP Service Pack 2, les Outils de support Windows XP sont disponibles en téléchargement à partir de www.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="3cdff-141">For use with Windows XP Service Pack 2, the Windows XP Support Tools are available as a download from www.microsoft.com.</span></span>  
  
 <span data-ttu-id="3cdff-142">Le code source d’une version de l’outil *HttpCfg.exe* est également fourni en guise d’exemple avec le SDK Windows Server.</span><span class="sxs-lookup"><span data-stu-id="3cdff-142">The source code to a version of the *HttpCfg.exe* tool is also provided as a sample with the Windows Server SDK.</span></span> <span data-ttu-id="3cdff-143">Le code source de l’exemple *HttpCfg.exe* est installé par défaut avec les exemples de mise en réseau dans le cadre du SDK Windows sous le dossier suivant :</span><span class="sxs-lookup"><span data-stu-id="3cdff-143">The source code to the *HttpCfg.exe* sample is installed by default with the networking samples as part of the Windows SDK under the following folder:</span></span>  
  
 <span data-ttu-id="3cdff-144">*C:\Program Files\Microsoft SDKs\Windows\v1.0\Samples\NetDS\http\serviceconfig*</span><span class="sxs-lookup"><span data-stu-id="3cdff-144">*C:\Program Files\Microsoft SDKs\Windows\v1.0\Samples\NetDS\http\serviceconfig*</span></span>  
  
 <span data-ttu-id="3cdff-145">Outre ces outils, les classes <xref:System.Security.Cryptography.X509Certificates.X509Certificate> et <xref:System.Security.Cryptography.X509Certificates.X509Certificate2> fournissent des méthodes pour charger un certificat à partir du système de fichiers.</span><span class="sxs-lookup"><span data-stu-id="3cdff-145">In addition to these tools, the <xref:System.Security.Cryptography.X509Certificates.X509Certificate> and <xref:System.Security.Cryptography.X509Certificates.X509Certificate2> classes provides methods for loading a certificate from the file system.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3cdff-146">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="3cdff-146">See Also</span></span>  
 [<span data-ttu-id="3cdff-147">Sécurité dans la programmation réseau</span><span class="sxs-lookup"><span data-stu-id="3cdff-147">Security in Network Programming</span></span>](../../../docs/framework/network-programming/security-in-network-programming.md)  
 [<span data-ttu-id="3cdff-148">Programmation réseau dans le .NET Framework</span><span class="sxs-lookup"><span data-stu-id="3cdff-148">Network Programming in the .NET Framework</span></span>](../../../docs/framework/network-programming/index.md)
