---
title: "Prise en charge de SqlClient pour la haute disponibilité et la récupération d'urgence"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 61e0b396-09d7-4e13-9711-7dcbcbd103a0
caps.latest.revision: "13"
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.workload: dotnet
ms.openlocfilehash: 4f6ede253f52682cfe5a698cf4fb02841dc4c1e0
ms.sourcegitcommit: c0dd436f6f8f44dc80dc43b07f6841a00b74b23f
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/19/2018
---
# <a name="sqlclient-support-for-high-availability-disaster-recovery"></a><span data-ttu-id="c3753-102">Prise en charge de SqlClient pour la haute disponibilité et la récupération d'urgence</span><span class="sxs-lookup"><span data-stu-id="c3753-102">SqlClient Support for High Availability, Disaster Recovery</span></span>
<span data-ttu-id="c3753-103">Cette rubrique décrit la prise en charge SqlClient (ajoutée dans [!INCLUDE[net_v45](../../../../../includes/net-v45-md.md)]) de la haute disponibilité, récupération d'urgence -- groupes de disponibilité AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="c3753-103">This topic discusses SqlClient support (added in [!INCLUDE[net_v45](../../../../../includes/net-v45-md.md)]) for high-availability, disaster recovery -- AlwaysOn Availability Groups.</span></span>  <span data-ttu-id="c3753-104">La fonctionnalité Groupes de disponibilité AlwaysOn a été ajoutée à [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012.</span><span class="sxs-lookup"><span data-stu-id="c3753-104">AlwaysOn Availability Groups feature was added to [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012.</span></span> <span data-ttu-id="c3753-105">Pour plus d'informations sur les groupes de disponibilité AlwaysOn, consultez la documentation en ligne de [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c3753-105">For more information about AlwaysOn Availability Groups, see [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] Books Online.</span></span>  
  
 <span data-ttu-id="c3753-106">Vous pouvez à présent spécifier l'écouteur du groupe de disponibilité (haute disponibilité, récupération d'urgence) ou une instance de cluster de basculement [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 dans la propriété de connexion.</span><span class="sxs-lookup"><span data-stu-id="c3753-106">You can now specify the availability group listener of a (high-availability, disaster-recovery) availability group (AG) or [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 Failover Cluster Instance in the connection property.</span></span> <span data-ttu-id="c3753-107">Si une application SqlClient est connectée à une base de données AlwaysOn qui bascule, la connexion initiale est interrompue et l'application doit ouvrir une nouvelle connexion pour continuer les tâches après le basculement.</span><span class="sxs-lookup"><span data-stu-id="c3753-107">If a SqlClient application is connected to an AlwaysOn database that fails over, the original connection is broken and the application must open a new connection to continue work after the failover.</span></span>  
  
 <span data-ttu-id="c3753-108">Si vous ne vous connectez pas à un écouteur du groupe de disponibilité ou à une instance de cluster de basculement [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012, et si plusieurs adresses IP sont associées à un nom d'hôte, SqlClient itèrera de manière séquentielle au sein de toutes les adresses IP associées aux entrées DNS.</span><span class="sxs-lookup"><span data-stu-id="c3753-108">If you are not connecting to an availability group listener or [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 Failover Cluster Instance, and if multiple IP addresses are associated with a hostname, SqlClient will iterate sequentially through all IP addresses associated with DNS entry.</span></span> <span data-ttu-id="c3753-109">Cela peut prendre du temps si la première adresse IP retournée par le serveur DNS n'est liée à aucune carte d'interface réseau.</span><span class="sxs-lookup"><span data-stu-id="c3753-109">This can be time consuming if the first IP address returned by DNS server is not bound to any network interface card (NIC).</span></span> <span data-ttu-id="c3753-110">Lors de la connexion à un écouteur du groupe de disponibilité ou une instance de cluster de basculement [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012, SqlClient tente d'établir des connexions à toutes les adresses IP en parallèle et si une tentative de connexion réussit, le pilote ignore toutes les tentatives de connexion en attente.</span><span class="sxs-lookup"><span data-stu-id="c3753-110">When connecting to an availability group listener or [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 Failover Cluster Instance, SqlClient attempts to establish connections to all IP addresses in parallel and if a connection attempt succeeds, the driver will discard any pending connection attempts.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c3753-111">L'augmentation du délai de connexion et l'implémentation de la logique de nouvelles tentatives de connexion augmentent la probabilité qu'une application se connecte à un groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="c3753-111">Increasing connection timeout and implementing connection retry logic will increase the probability that an application will connect to an availability group.</span></span> <span data-ttu-id="c3753-112">En outre, étant donné qu'une connexion peut échouer en raison d'un basculement, vous devez implémenter la logique pour les nouvelles tentatives de connexion, nouvelle tentative de connexion jusqu'à reconnexion.</span><span class="sxs-lookup"><span data-stu-id="c3753-112">Also, because a connection can fail because of a failover, you should implement connection retry logic, retrying a failed connection until it reconnects.</span></span>  
  
 <span data-ttu-id="c3753-113">Les propriétés de connexion suivantes ont été ajoutées à SqlClient dans [!INCLUDE[net_v45](../../../../../includes/net-v45-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="c3753-113">The following connection properties were added to SqlClient in [!INCLUDE[net_v45](../../../../../includes/net-v45-md.md)]:</span></span>  
  
-   `ApplicationIntent`  
  
-   `MultiSubnetFailover`  
  
 <span data-ttu-id="c3753-114">Vous pouvez modifier par programmation ces mots clés de chaîne de connexion avec :</span><span class="sxs-lookup"><span data-stu-id="c3753-114">You can programmatically modify these connection string keywords with:</span></span>  
  
1.  <xref:System.Data.SqlClient.SqlConnectionStringBuilder.ApplicationIntent%2A>  
  
2.  <xref:System.Data.SqlClient.SqlConnectionStringBuilder.MultiSubnetFailover%2A>  

> [!NOTE]
>  <span data-ttu-id="c3753-115">Paramètre `MultiSubnetFailover` à `true` n’est pas nécessaire avec [!INCLUDE[net_v461](../../../../../includes/net-v461-md.md)]) ou versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="c3753-115">Setting `MultiSubnetFailover` to `true` isn't required with [!INCLUDE[net_v461](../../../../../includes/net-v461-md.md)]) or later versions.</span></span>
  
## <a name="connecting-with-multisubnetfailover"></a><span data-ttu-id="c3753-116">Connexion avec MultiSubnetFailover</span><span class="sxs-lookup"><span data-stu-id="c3753-116">Connecting With MultiSubnetFailover</span></span>  
 <span data-ttu-id="c3753-117">Spécifiez toujours `MultiSubnetFailover=True` lors de la connexion à un écouteur du groupe de disponibilité [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 ou à l'instance de cluster de basculement [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012.</span><span class="sxs-lookup"><span data-stu-id="c3753-117">Always specify `MultiSubnetFailover=True` when connecting to a [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 availability group listener or [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 Failover Cluster Instance.</span></span> <span data-ttu-id="c3753-118">`MultiSubnetFailover` permet le basculement plus rapide de tous les groupes de disponibilité et/ou de l'instance de cluster de basculement dans [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 et réduit considérablement le temps de basculement pour les topologies de sous-réseau unique et de plusieurs sous-réseaux AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="c3753-118">`MultiSubnetFailover` enables faster failover for all Availability Groups and or Failover Cluster Instance in [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 and will significantly reduce failover time for single and multi-subnet AlwaysOn topologies.</span></span> <span data-ttu-id="c3753-119">Pendant un basculement de multi sous-réseau, le client effectue des tentatives de connexion en parallèle.</span><span class="sxs-lookup"><span data-stu-id="c3753-119">During a multi-subnet failover, the client will attempt connections in parallel.</span></span> <span data-ttu-id="c3753-120">Pendant un basculement de sous-réseau, le client effectue des tentatives de connexion TCP de manière agressive.</span><span class="sxs-lookup"><span data-stu-id="c3753-120">During a subnet failover, will aggressively retry the TCP connection.</span></span>  
  
 <span data-ttu-id="c3753-121">La propriété de connexion `MultiSubnetFailover` indique que l'application est déployée dans un groupe de disponibilité ou une instance de cluster de basculement [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 et que SqlClient tente de se connecter à la base de données sur l'instance principale [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] lorsque vous essayez de vous connecter à toutes les adresses IP.</span><span class="sxs-lookup"><span data-stu-id="c3753-121">The `MultiSubnetFailover` connection property indicates that the application is being deployed in an availability group or [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 Failover Cluster Instance and that SqlClient will try to connect to the database on the primary [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] instance by trying to connect to all the IP addresses.</span></span> <span data-ttu-id="c3753-122">Lorsque `MultiSubnetFailover=True` est spécifié pour une connexion, le client effectue des tentatives de connexion TCP plus rapidement que les intervalles de retransmission TCP par défaut du système d'exploitation.</span><span class="sxs-lookup"><span data-stu-id="c3753-122">When `MultiSubnetFailover=True` is specified for a connection, the client retries TCP connection attempts faster than the operating system’s default TCP retransmit intervals.</span></span> <span data-ttu-id="c3753-123">Cela permet une reconnexion plus rapide après basculement d'un groupe de disponibilité AlwaysOn ou d'une instance de cluster de basculement AlwaysOn, et s'applique aux groupes de disponibilité de sous-réseau unique et de multi-sous-réseau et aux instances de cluster de basculement.</span><span class="sxs-lookup"><span data-stu-id="c3753-123">This enables faster reconnection after failover of either an AlwaysOn Availability Group or an AlwaysOn Failover Cluster Instance, and is applicable to both single- and multi-subnet Availability Groups and Failover Cluster Instances.</span></span>  
  
 <span data-ttu-id="c3753-124">Pour plus d'informations sur les mots clés de chaîne de connexion dans SqlClient, consultez <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A>.</span><span class="sxs-lookup"><span data-stu-id="c3753-124">For more information about connection string keywords in SqlClient, see <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A>.</span></span>  
  
 <span data-ttu-id="c3753-125">La spécification de `MultiSubnetFailover=True` lors de la connexion à un élément autre qu'un écouteur du groupe de disponibilité ou une instance de cluster de basculement [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 peut provoquer une diminution des performances, et n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="c3753-125">Specifying `MultiSubnetFailover=True` when connecting to something other than a availability group listener or [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 Failover Cluster Instance may result in a negative performance impact, and is not supported.</span></span>  
  
 <span data-ttu-id="c3753-126">Suivez les indications suivantes pour vous connecter à un serveur dans un groupe de disponibilité ou une instance de cluster de basculement [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 :</span><span class="sxs-lookup"><span data-stu-id="c3753-126">Use the following guidelines to connect to a server in an availability group or [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] 2012 Failover Cluster Instance:</span></span>  
  
-   <span data-ttu-id="c3753-127">Utilisez la propriété de connexion `MultiSubnetFailover` lors de la connexion à un sous-réseau unique ou à un multi-sous-réseau ; elle permet d'améliorer les performances pour les deux.</span><span class="sxs-lookup"><span data-stu-id="c3753-127">Use the `MultiSubnetFailover` connection property when connecting to a single subnet or multi-subnet; it will improve performance for both.</span></span>  
  
-   <span data-ttu-id="c3753-128">Pour vous connecter à un groupe de disponibilité, spécifiez l'écouteur du groupe de disponibilité en tant que serveur dans votre chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="c3753-128">To connect to an availability group, specify the availability group listener of the availability group as the server in your connection string.</span></span>  
  
-   <span data-ttu-id="c3753-129">La connexion à une instance [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] configurée avec plus de 64 adresses IP entraîne un échec de connexion.</span><span class="sxs-lookup"><span data-stu-id="c3753-129">Connecting to a [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] instance configured with more than 64 IP addresses will cause a connection failure.</span></span>  
  
-   <span data-ttu-id="c3753-130">Le comportement d'une application qui utilise la propriété de connexion `MultiSubnetFailover` n'est pas affecté selon le type d'authentification : authentification [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)], authentification Kerberos ou authentification Windows.</span><span class="sxs-lookup"><span data-stu-id="c3753-130">Behavior of an application that uses the `MultiSubnetFailover` connection property is not affected based on the type of authentication: [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] Authentication, Kerberos Authentication, or Windows Authentication.</span></span>  
  
-   <span data-ttu-id="c3753-131">Augmentez la valeur de `Connect Timeout` pour permettre la prise en charge pour le temps de basculement et réduire les tentatives de nouvelle connexion d'application.</span><span class="sxs-lookup"><span data-stu-id="c3753-131">Increase the value of `Connect Timeout` to accommodate for failover time and reduce application connection retry attempts.</span></span>  
  
-   <span data-ttu-id="c3753-132">Les transactions distribuées ne sont pas prises en charge.</span><span class="sxs-lookup"><span data-stu-id="c3753-132">Distributed transactions are not supported.</span></span>  
  
 <span data-ttu-id="c3753-133">Si le routage en lecture seule n'est pas appliqué, la connexion à un emplacement de réplica secondaire échoue dans les situations suivantes :</span><span class="sxs-lookup"><span data-stu-id="c3753-133">If read-only routing is not in effect, connecting to a secondary replica location will fail in the following situations:</span></span>  
  
1.  <span data-ttu-id="c3753-134">Si l'emplacement de réplica secondaire n'est pas configuré pour recevoir des connexions.</span><span class="sxs-lookup"><span data-stu-id="c3753-134">If the secondary replica location is not configured to accept connections.</span></span>  
  
2.  <span data-ttu-id="c3753-135">Si une application utilise `ApplicationIntent=ReadWrite` (voir ci-dessous) et l'emplacement de réplica secondaire est configuré pour l'accès en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="c3753-135">If an application uses `ApplicationIntent=ReadWrite` (discussed below) and the secondary replica location is configured for read-only access.</span></span>  
  
 <span data-ttu-id="c3753-136"><xref:System.Data.SqlClient.SqlDependency> n'est pas pris en charge sur des réplicas secondaires en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="c3753-136"><xref:System.Data.SqlClient.SqlDependency> is not supported on read-only secondary replicas.</span></span>  
  
 <span data-ttu-id="c3753-137">Une connexion échoue si un réplica principal est configuré pour rejeter les charges de travail en lecture seule et la chaîne de connexion contient `ApplicationIntent=ReadOnly`.</span><span class="sxs-lookup"><span data-stu-id="c3753-137">A connection will fail if a primary replica is configured to reject read-only workloads and the connection string contains `ApplicationIntent=ReadOnly`.</span></span>  
  
## <a name="upgrading-to-use-multi-subnet-clusters-from-database-mirroring"></a><span data-ttu-id="c3753-138">Mise à niveau pour utiliser des clusters de multi-sous-réseaux de mise en miroir de bases de données</span><span class="sxs-lookup"><span data-stu-id="c3753-138">Upgrading to Use Multi-Subnet Clusters from Database Mirroring</span></span>  
 <span data-ttu-id="c3753-139">Une erreur de connexion (<xref:System.ArgumentException>) se produira si les mots clés de connexion `MultiSubnetFailover` et `Failover Partner` sont présents dans la chaîne de connexion, ou si `MultiSubnetFailover=True` et un protocole autre que TCP est utilisé.</span><span class="sxs-lookup"><span data-stu-id="c3753-139">A connection error (<xref:System.ArgumentException>) will occur if the `MultiSubnetFailover` and `Failover Partner` connection keywords are present in the connection string, or if `MultiSubnetFailover=True` and a protocol other than TCP is used.</span></span> <span data-ttu-id="c3753-140">Une erreur (<xref:System.Data.SqlClient.SqlException>) peut aussi se produire si `MultiSubnetFailover` est utilisé et [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] retourne une réponse de partenaire de basculement indiquant qu'il fait partie de la paire de mise en miroir de bases de données.</span><span class="sxs-lookup"><span data-stu-id="c3753-140">An error (<xref:System.Data.SqlClient.SqlException>) will also occur if `MultiSubnetFailover` is used and the [!INCLUDE[ssNoVersion](../../../../../includes/ssnoversion-md.md)] returns a failover partner response indicating it is part of a database mirroring pair.</span></span>  
  
 <span data-ttu-id="c3753-141">Si vous mettez à niveau une application SqlClient qui utilise actuellement la mise en miroir de bases de données dans un scénario de multi-sous-réseau, vous devez supprimer la propriété de connexion `Failover Partner` et la remplacer par `MultiSubnetFailover` ayant la valeur `True` et remplacer le nom du serveur dans la chaîne de connexion par un écouteur du groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="c3753-141">If you upgrade a SqlClient application that currently uses database mirroring to a multi-subnet scenario, you should remove the `Failover Partner` connection property and replace it with `MultiSubnetFailover` set to `True` and replace the server name in the connection string with an availability group listener.</span></span> <span data-ttu-id="c3753-142">Si une chaîne de connexion utilise `Failover Partner` et `MultiSubnetFailover=True`, le pilote génère une erreur.</span><span class="sxs-lookup"><span data-stu-id="c3753-142">If a connection string uses `Failover Partner` and `MultiSubnetFailover=True`, the driver will generate an error.</span></span> <span data-ttu-id="c3753-143">Toutefois, si une chaîne de connexion utilise `Failover Partner` et `MultiSubnetFailover=False` (ou `ApplicationIntent=ReadWrite`), l'application utilise la mise en miroir de bases de données.</span><span class="sxs-lookup"><span data-stu-id="c3753-143">However, if a connection string uses `Failover Partner` and `MultiSubnetFailover=False` (or `ApplicationIntent=ReadWrite`), the application will use database mirroring.</span></span>  
  
 <span data-ttu-id="c3753-144">Le pilote retourne une erreur si la mise en miroir de bases de données est utilisée dans la base de données principale du groupe de disponibilité, et si `MultiSubnetFailover=True` est utilisé dans la chaîne de connexion qui se connecte à une base de données principale plutôt qu'à un écouteur du groupe de disponibilité.</span><span class="sxs-lookup"><span data-stu-id="c3753-144">The driver will return an error if database mirroring is used on the primary database in the AG, and if `MultiSubnetFailover=True` is used in the connection string that connects to a primary database instead of to an availability group listener.</span></span>  
  
## <a name="specifying-application-intent"></a><span data-ttu-id="c3753-145">Spécification de l'intention d'application</span><span class="sxs-lookup"><span data-stu-id="c3753-145">Specifying Application Intent</span></span>  
 <span data-ttu-id="c3753-146">Lorsque `ApplicationIntent=ReadOnly`, le client demande une charge de travail de lecture lors de la connexion à une base de données AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="c3753-146">When `ApplicationIntent=ReadOnly`, the client requests a read workload when connecting to an AlwaysOn enabled database.</span></span> <span data-ttu-id="c3753-147">Le serveur applique l'intention au moment de la connexion et pendant une instruction de base de données USE, mais uniquement à une base de données AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="c3753-147">The server will enforce the intent at connection time and during a USE database statement but only to an Always On enabled database.</span></span>  
  
 <span data-ttu-id="c3753-148">Le mot clé `ApplicationIntent` ne fonctionne pas avec les bases de données en lecture seule héritées.</span><span class="sxs-lookup"><span data-stu-id="c3753-148">The `ApplicationIntent` keyword does not work with legacy, read-only databases.</span></span>  
  
 <span data-ttu-id="c3753-149">Une base de données peut autoriser ou interdire les charges de travail de lecture sur la base de données ciblée AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="c3753-149">A database can allow or disallow read workloads on the targeted AlwaysOn database.</span></span> <span data-ttu-id="c3753-150">(Faites ceci avec la clause `ALLOW_CONNECTIONS` des instructions `PRIMARY_ROLE` et `SECONDARY_ROLE`[!INCLUDE[tsql](../../../../../includes/tsql-md.md)].)</span><span class="sxs-lookup"><span data-stu-id="c3753-150">(This is done with the `ALLOW_CONNECTIONS` clause of the `PRIMARY_ROLE` and `SECONDARY_ROLE`[!INCLUDE[tsql](../../../../../includes/tsql-md.md)] statements.)</span></span>  
  
 <span data-ttu-id="c3753-151">Le mot clé `ApplicationIntent` est utilisé pour permettre le routage en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="c3753-151">The `ApplicationIntent` keyword is used to enable read-only routing.</span></span>  
  
## <a name="read-only-routing"></a><span data-ttu-id="c3753-152">Routage en lecture seule</span><span class="sxs-lookup"><span data-stu-id="c3753-152">Read-Only Routing</span></span>  
 <span data-ttu-id="c3753-153">Le routage en lecture seule est une fonctionnalité qui garantit la disponibilité d'un réplica en lecture seule d'une base de données.</span><span class="sxs-lookup"><span data-stu-id="c3753-153">Read-only routing is a feature that can ensure the availability of a read only replica of a database.</span></span> <span data-ttu-id="c3753-154">Pour activer le routage en lecture seule :</span><span class="sxs-lookup"><span data-stu-id="c3753-154">To enable read-only routing:</span></span>  
  
1.  <span data-ttu-id="c3753-155">Vous devez vous connecter à un écouteur du groupe de disponibilité Groupe de disponibilité AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="c3753-155">You must connect to an Always On Availability Group availability group listener.</span></span>  
  
2.  <span data-ttu-id="c3753-156">Le mot clé de chaîne de connexion `ApplicationIntent` doit avoir la valeur `ReadOnly`.</span><span class="sxs-lookup"><span data-stu-id="c3753-156">The `ApplicationIntent` connection string keyword must be set to `ReadOnly`.</span></span>  
  
3.  <span data-ttu-id="c3753-157">Le groupe de disponibilité doit être configuré par l'administrateur de base de données pour permettre le routage en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="c3753-157">The Availability Group must be configured by the database administrator to enable read-only routing.</span></span>  
  
 <span data-ttu-id="c3753-158">Il est possible que plusieurs connexions utilisant le routage en lecture seule ne se connectent pas au même réplica en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="c3753-158">It is possible that multiple connections using read-only routing will not all connect to the same read-only replica.</span></span> <span data-ttu-id="c3753-159">Les modifications de la synchronisation de base de données ou les modifications de la configuration du routage du serveur peuvent entraîner des connexions clientes à des réplicas en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="c3753-159">Changes in database synchronization or changes in the server's routing configuration can result in client connections to different read-only replicas.</span></span> <span data-ttu-id="c3753-160">Pour vous assurer que toutes les demandes en lecture seule se connectent au même réplica en lecture seule, ne passez pas un écouteur du groupe de disponibilité au mot clé de chaîne de connexion `Data Source`.</span><span class="sxs-lookup"><span data-stu-id="c3753-160">To ensure that all read-only requests connect to the same read-only replica, do not pass an availability group listener to the `Data Source` connection string keyword.</span></span> <span data-ttu-id="c3753-161">À la place, spécifiez le nom de l'instance en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="c3753-161">Instead, specify the name of the read-only instance.</span></span>  
  
 <span data-ttu-id="c3753-162">Le routage en lecture seule peut prendre plus longtemps que la connexion au principal, car il se connecte d'abord au principal, puis recherche le meilleur réplica secondaire lisible disponible.</span><span class="sxs-lookup"><span data-stu-id="c3753-162">Read-only routing may take longer than connecting to the primary because read only routing first connects to the primary and then looks for the best available readable secondary.</span></span> <span data-ttu-id="c3753-163">De ce fait, vous devez augmenter le délai d'attente de connexion.</span><span class="sxs-lookup"><span data-stu-id="c3753-163">Because of this, you should increase your login timeout.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c3753-164">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="c3753-164">See Also</span></span>  
 [<span data-ttu-id="c3753-165">Fonctionnalités SQL Server et ADO.NET</span><span class="sxs-lookup"><span data-stu-id="c3753-165">SQL Server Features and ADO.NET</span></span>](../../../../../docs/framework/data/adonet/sql/sql-server-features-and-adonet.md)  
 [<span data-ttu-id="c3753-166">Fournisseurs managés ADO.NET et centre de développement DataSet</span><span class="sxs-lookup"><span data-stu-id="c3753-166">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
