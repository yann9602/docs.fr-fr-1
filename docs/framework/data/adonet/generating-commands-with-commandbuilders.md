---
title: "Génération de commandes avec CommandBuilders"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
ms.assetid: 6e3fb8b5-373b-4f9e-ab03-a22693df8e91
caps.latest.revision: "6"
author: JennieHubbard
ms.author: jhubbard
manager: jhubbard
ms.workload: dotnet
ms.openlocfilehash: 0227da6029f1c565f44c46a08d786149d6da5086
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/22/2017
---
# <a name="generating-commands-with-commandbuilders"></a><span data-ttu-id="613f5-102">Génération de commandes avec CommandBuilders</span><span class="sxs-lookup"><span data-stu-id="613f5-102">Generating Commands with CommandBuilders</span></span>
<span data-ttu-id="613f5-103">Lorsque la propriété `SelectCommand` est spécifiée de manière dynamique au moment de l'exécution, par l'intermédiaire d'un outil de requête qui prend une commande textuelle provenant de l'utilisateur par exemple, il est possible que vous ne puissiez pas spécifier les propriétés `InsertCommand`, `UpdateCommand` ou `DeleteCommand` appropriées au moment de la conception.</span><span class="sxs-lookup"><span data-stu-id="613f5-103">When the `SelectCommand` property is dynamically specified at run time, such as through a query tool that takes a textual command from the user, you may not be able to specify the appropriate `InsertCommand`, `UpdateCommand`, or `DeleteCommand` at design time.</span></span> <span data-ttu-id="613f5-104">Si l'objet <xref:System.Data.DataTable> est mappé à une table de base de données unique ou est généré par elle, vous pouvez tirer parti de l'objet <xref:System.Data.Common.DbCommandBuilder> pour générer automatiquement les propriétés `DeleteCommand`, `InsertCommand` et `UpdateCommand` de l'objet <xref:System.Data.Common.DbDataAdapter>.</span><span class="sxs-lookup"><span data-stu-id="613f5-104">If your <xref:System.Data.DataTable> maps to or is generated from a single database table, you can take advantage of the <xref:System.Data.Common.DbCommandBuilder> object to automatically generate the `DeleteCommand`, `InsertCommand`, and `UpdateCommand` of the <xref:System.Data.Common.DbDataAdapter>.</span></span>  
  
 <span data-ttu-id="613f5-105">Vous devez au minimum définir la propriété `SelectCommand` afin que la génération de automatique de commandes fonctionne.</span><span class="sxs-lookup"><span data-stu-id="613f5-105">As a minimum requirement, you must set the `SelectCommand` property in order for automatic command generation to work.</span></span> <span data-ttu-id="613f5-106">Le schéma de table extrait par la propriété `SelectCommand` détermine la syntaxe des instructions INSERT, UPDATE et DELETE générées automatiquement.</span><span class="sxs-lookup"><span data-stu-id="613f5-106">The table schema retrieved by the `SelectCommand` property determines the syntax of the automatically generated INSERT, UPDATE, and DELETE statements.</span></span>  
  
 <span data-ttu-id="613f5-107">L'objet <xref:System.Data.Common.DbCommandBuilder> doit exécuter `SelectCommand` afin de retourner les métadonnées nécessaires à la construction des commandes INSERT, UPDATE et DELETE SQL.</span><span class="sxs-lookup"><span data-stu-id="613f5-107">The <xref:System.Data.Common.DbCommandBuilder> must execute the `SelectCommand` in order to return the metadata necessary to construct the INSERT, UPDATE, and DELETE SQL commands.</span></span> <span data-ttu-id="613f5-108">En conséquence, un trajet supplémentaire vers la source de données est nécessaire et peut gêner les performances.</span><span class="sxs-lookup"><span data-stu-id="613f5-108">As a result, an extra trip to the data source is necessary, and this can hinder performance.</span></span> <span data-ttu-id="613f5-109">Pour parvenir à une performance optimale, spécifiez vos commandes explicitement plutôt que d'utiliser l'objet <xref:System.Data.Common.DbCommandBuilder>.</span><span class="sxs-lookup"><span data-stu-id="613f5-109">To achieve optimal performance, specify your commands explicitly rather than using the <xref:System.Data.Common.DbCommandBuilder>.</span></span>  
  
 <span data-ttu-id="613f5-110">`SelectCommand` doit aussi retourner au moins une clé primaire ou une colonne unique.</span><span class="sxs-lookup"><span data-stu-id="613f5-110">The `SelectCommand` must also return at least one primary key or unique column.</span></span> <span data-ttu-id="613f5-111">Si aucune n'est présente, une exception `InvalidOperation` est levée et les commandes ne sont pas générées.</span><span class="sxs-lookup"><span data-stu-id="613f5-111">If none are present, an `InvalidOperation` exception is generated, and the commands are not generated.</span></span>  
  
 <span data-ttu-id="613f5-112">Lorsqu'il est associé à `DataAdapter`, l'objet <xref:System.Data.Common.DbCommandBuilder> génère automatiquement les propriétés `InsertCommand`, `UpdateCommand` et `DeleteCommand` du `DataAdapter` si ce sont des références null.</span><span class="sxs-lookup"><span data-stu-id="613f5-112">When associated with a `DataAdapter`, the <xref:System.Data.Common.DbCommandBuilder> automatically generates the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties of the `DataAdapter` if they are null references.</span></span> <span data-ttu-id="613f5-113">Si une `Command` existe déjà pour une propriété, la `Command` existante est utilisée.</span><span class="sxs-lookup"><span data-stu-id="613f5-113">If a `Command` already exists for a property, the existing `Command` is used.</span></span>  
  
 <span data-ttu-id="613f5-114">Les vues de base de données qui sont créées en reliant deux ou plusieurs tables ne sont pas considérées comme une table de base de données unique.</span><span class="sxs-lookup"><span data-stu-id="613f5-114">Database views that are created by joining two or more tables together are not considered a single database table.</span></span> <span data-ttu-id="613f5-115">Dans ce cas, vous ne pouvez pas utiliser l'objet <xref:System.Data.Common.DbCommandBuilder> pour générer automatiquement des commandes et devez spécifier vos commandes explicitement.</span><span class="sxs-lookup"><span data-stu-id="613f5-115">In this instance you cannot use the <xref:System.Data.Common.DbCommandBuilder> to automatically generate commands; you must specify your commands explicitly.</span></span> <span data-ttu-id="613f5-116">Pour plus d’informations sur la définition explicite des commandes pour répercuter les mises à jour à un `DataSet` à la source de données, consultez [mise à jour des Sources de données avec DataAdapters](../../../../docs/framework/data/adonet/updating-data-sources-with-dataadapters.md).</span><span class="sxs-lookup"><span data-stu-id="613f5-116">For information about explicitly setting commands to resolve updates to a `DataSet` back to the data source, see [Updating Data Sources with DataAdapters](../../../../docs/framework/data/adonet/updating-data-sources-with-dataadapters.md).</span></span>  
  
 <span data-ttu-id="613f5-117">Il est possible de mapper les paramètres de sortie à la ligne mise à jour d'un `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="613f5-117">You might want to map output parameters back to the updated row of a `DataSet`.</span></span> <span data-ttu-id="613f5-118">Une tâche courante consisterait à extraire la valeur d'un champ Identité généré automatiquement ou d'un horodatage provenant de la source de données.</span><span class="sxs-lookup"><span data-stu-id="613f5-118">One common task would be retrieving the value of an automatically generated identity field or time stamp from the data source.</span></span> <span data-ttu-id="613f5-119">L'objet <xref:System.Data.Common.DbCommandBuilder> ne mappera pas les paramètres de sortie aux colonnes dans une ligne mise à jour par défaut.</span><span class="sxs-lookup"><span data-stu-id="613f5-119">The <xref:System.Data.Common.DbCommandBuilder> will not map output parameters to columns in an updated row by default.</span></span> <span data-ttu-id="613f5-120">Dans ce cas, vous devez explicitement spécifier votre commande.</span><span class="sxs-lookup"><span data-stu-id="613f5-120">In this instance you must specify your command explicitly.</span></span> <span data-ttu-id="613f5-121">Pour obtenir un exemple de mappage d’un champ identité généré automatiquement à une colonne d’une ligne insérée, consultez [la récupération des valeurs d’identité ou NuméroAuto](../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md).</span><span class="sxs-lookup"><span data-stu-id="613f5-121">For an example of mapping an automatically generated identity field back to a column of an inserted row, see [Retrieving Identity or Autonumber Values](../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md).</span></span>  
  
## <a name="rules-for-automatically-generated-commands"></a><span data-ttu-id="613f5-122">Règles pour les commandes générées automatiquement</span><span class="sxs-lookup"><span data-stu-id="613f5-122">Rules for Automatically Generated Commands</span></span>  
 <span data-ttu-id="613f5-123">Le tableau suivant présente les règles de génération des commandes générées automatiquement.</span><span class="sxs-lookup"><span data-stu-id="613f5-123">The following table shows the rules for how automatically generated commands are generated.</span></span>  
  
|<span data-ttu-id="613f5-124">Commande</span><span class="sxs-lookup"><span data-stu-id="613f5-124">Command</span></span>|<span data-ttu-id="613f5-125">Règle</span><span class="sxs-lookup"><span data-stu-id="613f5-125">Rule</span></span>|  
|-------------|----------|  
|`InsertCommand`|<span data-ttu-id="613f5-126">Insère une ligne dans la source de données pour toutes les lignes de la table dont la propriété <xref:System.Data.DataRow.RowState%2A> a la valeur <xref:System.Data.DataRowState.Added>.</span><span class="sxs-lookup"><span data-stu-id="613f5-126">Inserts a row at the data source for all rows in the table with a <xref:System.Data.DataRow.RowState%2A> of <xref:System.Data.DataRowState.Added>.</span></span> <span data-ttu-id="613f5-127">Insère des valeurs pour toutes les colonnes qui peuvent être mises à jour (mais pas les colonnes comme les identités, les expressions ou les horodatages).</span><span class="sxs-lookup"><span data-stu-id="613f5-127">Inserts values for all columns that are updateable (but not columns such as identities, expressions, or timestamps).</span></span>|  
|`UpdateCommand`|<span data-ttu-id="613f5-128">Met à jour les lignes dans la source de données pour toutes les lignes de la table dont la propriété `RowState` a la valeur <xref:System.Data.DataRowState.Modified>.</span><span class="sxs-lookup"><span data-stu-id="613f5-128">Updates rows at the data source for all rows in the table with a `RowState` of <xref:System.Data.DataRowState.Modified>.</span></span> <span data-ttu-id="613f5-129">Met à jour les valeurs de toutes les colonnes à l'exception de celles qui ne peuvent pas être mises à jour, telles que les identités ou les expressions.</span><span class="sxs-lookup"><span data-stu-id="613f5-129">Updates the values of all columns except for columns that are not updateable, such as identities or expressions.</span></span> <span data-ttu-id="613f5-130">Met à jour toutes les lignes où les valeurs de colonne au niveau de la source de données correspondent aux valeurs de colonne de clé primaire de la ligne et où les colonnes restantes correspondent aux valeurs d'origine de la ligne.</span><span class="sxs-lookup"><span data-stu-id="613f5-130">Updates all rows where the column values at the data source match the primary key column values of the row, and where the remaining columns at the data source match the original values of the row.</span></span> <span data-ttu-id="613f5-131">Pour plus d'informations, voir « Modèle d'accès simultané optimiste pour les mises à jour et les suppressions », plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="613f5-131">For more information, see "Optimistic Concurrency Model for Updates and Deletes," later in this topic.</span></span>|  
|`DeleteCommand`|<span data-ttu-id="613f5-132">Supprime les lignes dans la source de données pour toutes les lignes de la table dont la propriété `RowState` a la valeur <xref:System.Data.DataRowState.Deleted>.</span><span class="sxs-lookup"><span data-stu-id="613f5-132">Deletes rows at the data source for all rows in the table with a `RowState` of <xref:System.Data.DataRowState.Deleted>.</span></span> <span data-ttu-id="613f5-133">Supprime toutes les lignes où les valeurs de colonne correspondent aux valeurs de colonne de clé primaire de la ligne et où les colonnes restantes de la source de données correspondent aux valeurs d'origine de la ligne.</span><span class="sxs-lookup"><span data-stu-id="613f5-133">Deletes all rows where the column values match the primary key column values of the row, and where the remaining columns at the data source match the original values of the row.</span></span> <span data-ttu-id="613f5-134">Pour plus d'informations, voir « Modèle d'accès simultané optimiste pour les mises à jour et les suppressions », plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="613f5-134">For more information, see "Optimistic Concurrency Model for Updates and Deletes," later in this topic.</span></span>|  
  
## <a name="optimistic-concurrency-model-for-updates-and-deletes"></a><span data-ttu-id="613f5-135">Modèle d'accès simultané optimiste pour les mises à jour et les suppressions</span><span class="sxs-lookup"><span data-stu-id="613f5-135">Optimistic Concurrency Model for Updates and Deletes</span></span>  
 <span data-ttu-id="613f5-136">La logique de génération automatique de commandes pour les instructions UPDATE et DELETE est basée sur *d’accès concurrentiel optimiste*: autrement dit, les enregistrements ne sont pas verrouillés pour modification et peut être modifiés par d’autres utilisateurs ou processus à tout moment.</span><span class="sxs-lookup"><span data-stu-id="613f5-136">The logic for generating commands automatically for UPDATE and DELETE statements is based on *optimistic concurrency*--that is, records are not locked for editing and can be modified by other users or processes at any time.</span></span> <span data-ttu-id="613f5-137">Puisqu'un enregistrement aurait pu être modifié après avoir été retourné de l'instruction SELECT mais avant que l'instruction UPDATE ou DELETE ne soit émise, l'instruction UPDATE ou DELETE générée automatiquement contient une clause WHERE spécifiant qu'une ligne n'est mise à jour que si elle contient toutes les valeurs d'origine et n'a pas été supprimée de la source de données.</span><span class="sxs-lookup"><span data-stu-id="613f5-137">Because a record could have been modified after it was returned from the SELECT statement, but before the UPDATE or DELETE statement is issued, the automatically generated UPDATE or DELETE statement contains a WHERE clause, specifying that a row is only updated if it contains all original values and has not been deleted from the data source.</span></span> <span data-ttu-id="613f5-138">Cela permet d'éviter le remplacement de nouvelles données.</span><span class="sxs-lookup"><span data-stu-id="613f5-138">This is done to avoid overwriting new data.</span></span> <span data-ttu-id="613f5-139">Quand une mise à jour générée automatiquement tente de mettre à jour une ligne qui a été supprimée ou qui ne contient pas les valeurs d'origine qui se trouvent dans l'objet <xref:System.Data.DataSet>, la commande n'affecte pas d'enregistrement et un objet <xref:System.Data.DBConcurrencyException> est généré.</span><span class="sxs-lookup"><span data-stu-id="613f5-139">Where an automatically generated update attempts to update a row that has been deleted or that does not contain the original values found in the <xref:System.Data.DataSet>, the command does not affect any records, and a <xref:System.Data.DBConcurrencyException> is thrown.</span></span>  
  
 <span data-ttu-id="613f5-140">Si vous souhaitez que les instructions UPDATE ou DELETE soient exécutées indépendamment des valeurs d'origine, vous devez explicitement définir la propriété `UpdateCommand` pour le `DataAdapter` et ne pas compter sur la génération automatique de commandes.</span><span class="sxs-lookup"><span data-stu-id="613f5-140">If you want the UPDATE or DELETE to complete regardless of original values, you must explicitly set the `UpdateCommand` for the `DataAdapter` and not rely on automatic command generation.</span></span>  
  
## <a name="limitations-of-automatic-command-generation-logic"></a><span data-ttu-id="613f5-141">Limites de la logique de génération automatique de commandes</span><span class="sxs-lookup"><span data-stu-id="613f5-141">Limitations of Automatic Command Generation Logic</span></span>  
 <span data-ttu-id="613f5-142">Les limites suivantes s'appliquent à la génération automatique de commandes.</span><span class="sxs-lookup"><span data-stu-id="613f5-142">The following limitations apply to automatic command generation.</span></span>  
  
### <a name="unrelated-tables-only"></a><span data-ttu-id="613f5-143">Tables dissociées uniquement</span><span class="sxs-lookup"><span data-stu-id="613f5-143">Unrelated Tables Only</span></span>  
 <span data-ttu-id="613f5-144">La logique de génération automatique de commandes génère des instructions INSERT, UPDATE ou DELETE pour les tables autonomes sans prendre en compte les relations avec les autres tables au niveau de la source de données.</span><span class="sxs-lookup"><span data-stu-id="613f5-144">The automatic command generation logic generates INSERT, UPDATE, or DELETE statements for stand-alone tables without taking into account any relationships to other tables at the data source.</span></span> <span data-ttu-id="613f5-145">En conséquence, il est possible que l'appel à `Update`, pour soumettre les modifications pour une colonne qui participe à une contrainte de clé étrangère dans la base de données, échoue.</span><span class="sxs-lookup"><span data-stu-id="613f5-145">As a result, you may encounter a failure when calling `Update` to submit changes for a column that participates in a foreign key constraint in the database.</span></span> <span data-ttu-id="613f5-146">Pour éviter cette exception, n'utilisez pas l'objet <xref:System.Data.Common.DbCommandBuilder> pour mettre à jour les colonnes impliquées dans une contrainte de clé étrangère et spécifiez plutôt explicitement les instructions utilisées pour effectuer l'opération.</span><span class="sxs-lookup"><span data-stu-id="613f5-146">To avoid this exception, do not use the <xref:System.Data.Common.DbCommandBuilder> for updating columns involved in a foreign key constraint; instead, explicitly specify the statements used to perform the operation.</span></span>  
  
### <a name="table-and-column-names"></a><span data-ttu-id="613f5-147">Noms de table et de colonne</span><span class="sxs-lookup"><span data-stu-id="613f5-147">Table and Column Names</span></span>  
 <span data-ttu-id="613f5-148">La logique de génération automatique de commandes peut échouer si les noms de colonne ou de table contiennent des caractères spéciaux (notamment espaces, points, points d'interrogation ou autres caractères non alphanumériques), même s'ils sont délimités par des crochets.</span><span class="sxs-lookup"><span data-stu-id="613f5-148">Automatic command generation logic may fail if column names or table names contain any special characters, such as spaces, periods, quotation marks, or other nonalphanumeric characters, even if delimited by brackets.</span></span> <span data-ttu-id="613f5-149">Selon le fournisseur, le fait de définir les paramètres QuotePrefix et QuoteSuffix peut permettre à la logique de génération de traiter les espaces, mais pas les caractères spéciaux d'échappement.</span><span class="sxs-lookup"><span data-stu-id="613f5-149">Depending on the provider, setting the QuotePrefix and QuoteSuffix parameters may allow the generation logic to process spaces, but it cannot escape special characters.</span></span> <span data-ttu-id="613f5-150">Complet des noms de table sous la forme de *catalog.schema.table* sont pris en charge.</span><span class="sxs-lookup"><span data-stu-id="613f5-150">Fully qualified table names in the form of *catalog.schema.table* are supported.</span></span>  
  
## <a name="using-the-commandbuilder-to-automatically-generate-an-sql-statement"></a><span data-ttu-id="613f5-151">Utilisation de CommandBuilder pour générer automatiquement une instruction SQL</span><span class="sxs-lookup"><span data-stu-id="613f5-151">Using the CommandBuilder to Automatically Generate an SQL Statement</span></span>  
 <span data-ttu-id="613f5-152">Pour générer automatiquement des instructions SQL pour un `DataAdapter`, commencez par définir la propriété `SelectCommand` du `DataAdapter`, puis créez un objet `CommandBuilder` et spécifiez comme argument le `DataAdapter` pour lequel l'objet `CommandBuilder` génère automatiquement des instructions SQL.</span><span class="sxs-lookup"><span data-stu-id="613f5-152">To automatically generate SQL statements for a `DataAdapter`, first set the `SelectCommand` property of the `DataAdapter`, then create a `CommandBuilder` object, and specify as an argument the `DataAdapter` for which the `CommandBuilder` will automatically generate SQL statements.</span></span>  
  
```vb  
' Assumes that connection is a valid SqlConnection object   
' inside of a Using block.  
Dim adapter As SqlDataAdapter = New SqlDataAdapter( _  
  "SELECT * FROM dbo.Customers", connection)  
Dim builder As SqlCommandBuilder = New SqlCommandBuilder(adapter)  
builder.QuotePrefix = "["  
builder.QuoteSuffix = "]"  
```  
  
```csharp  
// Assumes that connection is a valid SqlConnection object  
// inside of a using block.  
SqlDataAdapter adapter = new SqlDataAdapter(  
  "SELECT * FROM dbo.Customers", connection);  
SqlCommandBuilder builder = new SqlCommandBuilder(adapter);  
builder.QuotePrefix = "[";  
builder.QuoteSuffix = "]";  
```  
  
## <a name="modifying-the-selectcommand"></a><span data-ttu-id="613f5-153">Modification de SelectCommand</span><span class="sxs-lookup"><span data-stu-id="613f5-153">Modifying the SelectCommand</span></span>  
 <span data-ttu-id="613f5-154">Si vous modifiez le `CommandText` du `SelectCommand` après la génération automatique des commandes INSERT, UPDATE ou DELETE, une exception peut se produire.</span><span class="sxs-lookup"><span data-stu-id="613f5-154">If you modify the `CommandText` of the `SelectCommand` after the INSERT, UPDATE, or DELETE commands have been automatically generated, an exception may occur.</span></span> <span data-ttu-id="613f5-155">Si le `SelectCommand.CommandText` modifié contient des informations de schéma qui ne sont pas cohérentes par rapport au `SelectCommand.CommandText` utilisé lors de la génération automatique des commandes d'insertion, de mise à jour ou de suppression, les appels ultérieurs à la méthode `DataAdapter.Update` peuvent chercher à accéder à des colonnes qui n'existent plus dans la table actuelle référencée par `SelectCommand` et une exception sera levée.</span><span class="sxs-lookup"><span data-stu-id="613f5-155">If the modified `SelectCommand.CommandText` contains schema information that is inconsistent with the `SelectCommand.CommandText` used when the insert, update, or delete commands were automatically generated, future calls to the `DataAdapter.Update` method may attempt to access columns that no longer exist in the current table referenced by the `SelectCommand`, and an exception will be thrown.</span></span>  
  
 <span data-ttu-id="613f5-156">Vous pouvez actualiser les informations de schéma utilisées par `CommandBuilder` pour générer automatiquement les commandes en appelant la méthode `RefreshSchema` du `CommandBuilder`.</span><span class="sxs-lookup"><span data-stu-id="613f5-156">You can refresh the schema information used by the `CommandBuilder` to automatically generate commands by calling the `RefreshSchema` method of the `CommandBuilder`.</span></span>  
  
 <span data-ttu-id="613f5-157">Si vous souhaitez connaître les commandes générées automatiquement, vous pouvez en obtenir une référence en appliquant les méthodes `GetInsertCommand`, `GetUpdateCommand` et `GetDeleteCommand` de l'objet `CommandBuilder` et en vérifiant la propriété `CommandText` de la commande associée.</span><span class="sxs-lookup"><span data-stu-id="613f5-157">If you want to know what command was automatically generated, you can obtain a reference to the automatically generated commands by using the `GetInsertCommand`, `GetUpdateCommand`, and `GetDeleteCommand` methods of the `CommandBuilder` object and checking the `CommandText` property of the associated command.</span></span>  
  
 <span data-ttu-id="613f5-158">L'exemple de code suivant écrit sur la console la commande de mise à jour générée automatiquement.</span><span class="sxs-lookup"><span data-stu-id="613f5-158">The following code example writes to the console the update command that was automatically generated.</span></span>  
  
```  
Console.WriteLine(builder.GetUpdateCommand().CommandText)  
```  
  
 <span data-ttu-id="613f5-159">L'exemple suivant recrée la table `Customers` dans le dataset `custDS`.</span><span class="sxs-lookup"><span data-stu-id="613f5-159">The following example recreates the `Customers` table in the `custDS` dataset.</span></span> <span data-ttu-id="613f5-160">Le **RefreshSchema** méthode est appelée pour actualiser les commandes générées automatiquement avec ces nouvelles informations de colonne.</span><span class="sxs-lookup"><span data-stu-id="613f5-160">The **RefreshSchema** method is called to refresh the automatically generated commands with this new column information.</span></span>  
  
```vb  
' Assumes an open SqlConnection and SqlDataAdapter inside of a Using block.  
adapter.SelectCommand.CommandText = _  
  "SELECT CustomerID, ContactName FROM dbo.Customers"  
builder.RefreshSchema()  
  
custDS.Tables.Remove(custDS.Tables("Customers"))  
adapter.Fill(custDS, "Customers")  
```  
  
```csharp  
// Assumes an open SqlConnection and SqlDataAdapter inside of a using block.  
adapter.SelectCommand.CommandText =   
  "SELECT CustomerID, ContactName FROM dbo.Customers";  
builder.RefreshSchema();  
  
custDS.Tables.Remove(custDS.Tables["Customers"]);  
adapter.Fill(custDS, "Customers");  
```  
  
## <a name="see-also"></a><span data-ttu-id="613f5-161">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="613f5-161">See Also</span></span>  
 [<span data-ttu-id="613f5-162">Commandes et paramètres</span><span class="sxs-lookup"><span data-stu-id="613f5-162">Commands and Parameters</span></span>](../../../../docs/framework/data/adonet/commands-and-parameters.md)  
 [<span data-ttu-id="613f5-163">Exécution d’une commande</span><span class="sxs-lookup"><span data-stu-id="613f5-163">Executing a Command</span></span>](../../../../docs/framework/data/adonet/executing-a-command.md)  
 [<span data-ttu-id="613f5-164">DbConnection, DbCommand et DbException</span><span class="sxs-lookup"><span data-stu-id="613f5-164">DbConnection, DbCommand and DbException</span></span>](../../../../docs/framework/data/adonet/dbconnection-dbcommand-and-dbexception.md)  
 [<span data-ttu-id="613f5-165">Fournisseurs managés ADO.NET et centre de développement DataSet</span><span class="sxs-lookup"><span data-stu-id="613f5-165">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
