---
title: Regroupement de connexions OLE DB, ODBC et Oracle Connection
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 2bd83b1e-3ea9-43c4-bade-d9cdb9bbbb04
caps.latest.revision: "3"
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.workload: dotnet
ms.openlocfilehash: d30b28e2a875e64e2c0d1cad43f101cf5fa2f489
ms.sourcegitcommit: ed26cfef4e18f6d93ab822d8c29f902cff3519d1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/17/2018
---
# <a name="ole-db-odbc-and-oracle-connection-pooling"></a><span data-ttu-id="47259-102">Regroupement de connexions OLE DB, ODBC et Oracle Connection</span><span class="sxs-lookup"><span data-stu-id="47259-102">OLE DB, ODBC, and Oracle Connection Pooling</span></span>
<span data-ttu-id="47259-103">Le regroupement de connexions peut considérablement améliorer les performances et l'évolutivité de votre application.</span><span class="sxs-lookup"><span data-stu-id="47259-103">Pooling connections can significantly enhance the performance and scalability of your application.</span></span> <span data-ttu-id="47259-104">Cette section traite du regroupement de connexions pour les fournisseurs de données .NET Framework pour OLE DB, ODBC et Oracle.</span><span class="sxs-lookup"><span data-stu-id="47259-104">This section discusses connection pooling for the .NET Framework data providers for OLE DB, ODBC and Oracle.</span></span>  
  
## <a name="connection-pooling-for-oledb"></a><span data-ttu-id="47259-105">Regroupement de connexions pour OleDb</span><span class="sxs-lookup"><span data-stu-id="47259-105">Connection Pooling for OleDb</span></span>  
 <span data-ttu-id="47259-106">Le fournisseur de données .NET Framework pour OLE DB regroupe automatiquement les connexions utilisant le regroupement de sessions OLE DB.</span><span class="sxs-lookup"><span data-stu-id="47259-106">The .NET Framework Data Provider for OLE DB automatically pools connections using OLE DB session pooling.</span></span> <span data-ttu-id="47259-107">Les arguments string de connexion peuvent être utilisés pour activer ou désactiver les services OLE DB et notamment le regroupement.</span><span class="sxs-lookup"><span data-stu-id="47259-107">Connection string arguments can be used to enable or disable OLE DB services including pooling.</span></span> <span data-ttu-id="47259-108">La chaîne de connexion suivante, par exemple, désactive le regroupement de sessions OLE DB et l'inscription automatique des transactions.</span><span class="sxs-lookup"><span data-stu-id="47259-108">For example, the following connection string disables OLE DB session pooling and automatic transaction enlistment.</span></span>  
  
```  
Provider=SQLOLEDB;OLE DB Services=-4;Data Source=localhost;Integrated Security=SSPI;  
```  
  
 <span data-ttu-id="47259-109">Il est recommandé de toujours fermer ou supprimer une connexion lorsque vous avez fini de l'utiliser afin de retourner la connexion au pool.</span><span class="sxs-lookup"><span data-stu-id="47259-109">We recommend that you always close or dispose of a connection when you are finished using it in order to return the connection to the pool.</span></span> <span data-ttu-id="47259-110">Les connexions qui ne sont pas explicitement fermées risquent de ne pas être retournées au pool.</span><span class="sxs-lookup"><span data-stu-id="47259-110">Connections that are not explicitly closed may not get returned to the pool.</span></span> <span data-ttu-id="47259-111">Par exemple, une connexion devenue hors de portée mais qui n'a pas été explicitement fermée sera retournée au pool de connexion seulement si la taille maximale de celui-ci a été atteinte et si la connexion est toujours valide.</span><span class="sxs-lookup"><span data-stu-id="47259-111">For example, a connection that has gone out of scope but that has not been explicitly closed will only be returned to the connection pool if the maximum pool size has been reached and the connection is still valid.</span></span>  
  
 <span data-ttu-id="47259-112">Pour plus d’informations sur la session OLE DB ou le regroupement des ressources, ainsi que comment désactiver le regroupement par substitution des services par défaut du fournisseur OLE DB, consultez le [Guide du programmeur OLE DB](http://go.microsoft.com/fwlink/?linkid=45232).</span><span class="sxs-lookup"><span data-stu-id="47259-112">For more information about OLE DB session or resource pooling, as well as how to disable pooling by overriding OLE DB provider service defaults, see the [OLE DB Programmer's Guide](http://go.microsoft.com/fwlink/?linkid=45232).</span></span>  
  
## <a name="connection-pooling-for-odbc"></a><span data-ttu-id="47259-113">Regroupement de connexions pour Odbc</span><span class="sxs-lookup"><span data-stu-id="47259-113">Connection Pooling for Odbc</span></span>  
 <span data-ttu-id="47259-114">Le regroupement de connexions du fournisseur de données .NET Framework pour ODBC est géré par le gestionnaire de pilotes ODBC utilisé pour la connexion et n'est pas affecté par le fournisseur de données .NET Framework pour ODBC.</span><span class="sxs-lookup"><span data-stu-id="47259-114">Connection pooling for the .NET Framework Data Provider for ODBC is managed by the ODBC Driver Manager that is used for the connection, and is not affected by the .NET Framework Data Provider for ODBC.</span></span>  
  
 <span data-ttu-id="47259-115">Pour activer ou désactiver le regroupement de connexions, ouvrez **administrateur de sources de données ODBC** dans le dossier Outils d’administration du Panneau de configuration.</span><span class="sxs-lookup"><span data-stu-id="47259-115">To enable or disable connection pooling, open **ODBC Data Source Administrator** in the Administrative Tools folder of Control Panel.</span></span> <span data-ttu-id="47259-116">Le **le regroupement de connexions** onglet vous permet de spécifier des paramètres pour chaque pilote ODBC installé de regroupement de connexions.</span><span class="sxs-lookup"><span data-stu-id="47259-116">The **Connection Pooling** tab allows you to specify connection pooling parameters for each ODBC driver installed.</span></span> <span data-ttu-id="47259-117">Notez que les modifications apportées au regroupement de connexions d'un pilote ODBC affectent toutes les applications qui utilisent ce pilote.</span><span class="sxs-lookup"><span data-stu-id="47259-117">Note that connection pooling changes for a specific ODBC driver affect all applications that use that ODBC driver.</span></span>  
  
 <span data-ttu-id="47259-118">Pour plus d’informations sur le regroupement de connexions ODBC, consultez [INFO : Forum aux Questions sur regroupement de connexions ODBC](http://support.microsoft.com/kb/169470).</span><span class="sxs-lookup"><span data-stu-id="47259-118">For more information on ODBC connection pooling, see [INFO: Frequently Asked Questions About ODBC Connection Pooling](http://support.microsoft.com/kb/169470).</span></span>  
  
## <a name="connection-pooling-for-oracleclient"></a><span data-ttu-id="47259-119">Regroupement de connexions pour OracleClient</span><span class="sxs-lookup"><span data-stu-id="47259-119">Connection Pooling for OracleClient</span></span>  
 <span data-ttu-id="47259-120">Le fournisseur de données .NET Framework pour Oracle assure automatiquement le regroupement de connexions pour votre application cliente ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="47259-120">The .NET Framework Data Provider for Oracle provides connection pooling automatically for your ADO.NET client application.</span></span> <span data-ttu-id="47259-121">Vous pouvez aussi fournir plusieurs modificateurs de chaîne de connexion afin de contrôler le comportement du pool de connexions (voir la section sur le contrôle des pools de connexions avec les mots clés des chaînes de connexion, plus loin dans cette rubrique).</span><span class="sxs-lookup"><span data-stu-id="47259-121">You can also supply several connection string modifiers to control connection pooling behavior (see "Controlling Connection Pooling with Connection String Keywords," later in this topic).</span></span>  
  
### <a name="pool-creation-and-assignment"></a><span data-ttu-id="47259-122">Création et assignation d'un pool</span><span class="sxs-lookup"><span data-stu-id="47259-122">Pool Creation and Assignment</span></span>  
 <span data-ttu-id="47259-123">Lorsqu'une connexion est ouverte, un pool de connexions est créé sur la base d'un algorithme à correspondance exacte qui associe le pool à la chaîne de connexion dans la connexion.</span><span class="sxs-lookup"><span data-stu-id="47259-123">When a connection is opened, a connection pool is created based on an exact matching algorithm that associates the pool with the connection string in the connection.</span></span> <span data-ttu-id="47259-124">Chaque pool de connexions est associé à une chaîne de connexion distincte.</span><span class="sxs-lookup"><span data-stu-id="47259-124">Each connection pool is associated with a distinct connection string.</span></span> <span data-ttu-id="47259-125">Lorsqu'une nouvelle connexion est ouverte, si la chaîne de connexion ne correspond pas exactement à un pool existant, un nouveau pool est créé.</span><span class="sxs-lookup"><span data-stu-id="47259-125">When a new connection is opened, if the connection string is not an exact match to an existing pool, a new pool is created.</span></span>  
  
 <span data-ttu-id="47259-126">Une fois créés, les pools de connexions ne sont détruits qu'à la fin du processus actif.</span><span class="sxs-lookup"><span data-stu-id="47259-126">Once created, connection pools are not destroyed until the active process ends.</span></span> <span data-ttu-id="47259-127">La maintenance des pools inactifs ou vides requiert très peu de ressources système.</span><span class="sxs-lookup"><span data-stu-id="47259-127">Maintaining inactive or empty pools uses very few system resources.</span></span>  
  
### <a name="connection-addition"></a><span data-ttu-id="47259-128">Ajout de connexions</span><span class="sxs-lookup"><span data-stu-id="47259-128">Connection Addition</span></span>  
 <span data-ttu-id="47259-129">Un pool de connexions est créé pour chaque chaîne de connexion unique.</span><span class="sxs-lookup"><span data-stu-id="47259-129">A connection pool is created for each unique connection string.</span></span> <span data-ttu-id="47259-130">Lorsqu'un pool est créé, plusieurs objets de connexion sont créés et ajoutés au pool de sorte que l'exigence de taille minimale du pool soit remplie.</span><span class="sxs-lookup"><span data-stu-id="47259-130">When a pool is created, multiple connection objects are created and added to the pool so that the minimum pool size requirement is satisfied.</span></span> <span data-ttu-id="47259-131">Les connexions sont ajoutées au pool jusqu'à ce que sa taille maximale soit atteinte.</span><span class="sxs-lookup"><span data-stu-id="47259-131">Connections are added to the pool as needed, up to the maximum pool size.</span></span>  
  
 <span data-ttu-id="47259-132">Quand un objet <xref:System.Data.OracleClient.OracleConnection> est demandé, il est obtenu du pool si une connexion utilisable est disponible.</span><span class="sxs-lookup"><span data-stu-id="47259-132">When an <xref:System.Data.OracleClient.OracleConnection> object is requested, it is obtained from the pool if a usable connection is available.</span></span> <span data-ttu-id="47259-133">Pour être utilisable, la connexion ne doit pas être en cours d'utilisation, avoir un contexte de transaction correspondant ou ne pas être associée à un contexte de transaction et avoir un lien valide vers le serveur.</span><span class="sxs-lookup"><span data-stu-id="47259-133">To be usable, the connection must currently be unused, have a matching transaction context or not be associated with any transaction context, and have a valid link to the server.</span></span>  
  
 <span data-ttu-id="47259-134">Si la taille maximale du pool est atteinte et qu'aucune connexion utilisable n'est disponible, la requête est mise en attente.</span><span class="sxs-lookup"><span data-stu-id="47259-134">If the maximum pool size has been reached and no usable connection is available, the request is queued.</span></span> <span data-ttu-id="47259-135">Le dispositif de regroupement répond à ces requêtes en réallouant les connexions à mesure qu'elles se libèrent.</span><span class="sxs-lookup"><span data-stu-id="47259-135">The connection pooler satisfies these requests by reallocating connections as they are released back into the pool.</span></span> <span data-ttu-id="47259-136">Les connexions sont libérées et retournées au pool en cas de fermeture ou de suppression.</span><span class="sxs-lookup"><span data-stu-id="47259-136">Connections are released back into the pool when they are closed or disposed.</span></span>  
  
### <a name="connection-removal"></a><span data-ttu-id="47259-137">Suppression des connexions</span><span class="sxs-lookup"><span data-stu-id="47259-137">Connection Removal</span></span>  
 <span data-ttu-id="47259-138">Le dispositif de regroupement de connexions supprime une connexion du pool restée inactive pendant une période prolongée ou s'il détecte que la connexion au serveur a été interrompue.</span><span class="sxs-lookup"><span data-stu-id="47259-138">The connection pooler removes a connection from the pool after it has been idle for an extended period of time, or if the pooler detects that the connection with the server has been severed.</span></span> <span data-ttu-id="47259-139">Notez que cela ne peut être détecté qu'après une tentative de communication avec le serveur.</span><span class="sxs-lookup"><span data-stu-id="47259-139">Note that this can be detected only after attempting to communicate with the server.</span></span> <span data-ttu-id="47259-140">Si une connexion n'est plus reliée au serveur, elle est marquée comme étant non valide.</span><span class="sxs-lookup"><span data-stu-id="47259-140">If a connection is found that is no longer connected to the server, it is marked as invalid.</span></span> <span data-ttu-id="47259-141">Le dispositif de regroupement analyse périodiquement les pools de connexions à la recherche d'objets qui ont été libérés vers le pool et sont marqués comme étant non valides.</span><span class="sxs-lookup"><span data-stu-id="47259-141">The connection pooler periodically scans connection pools looking for objects that have been released to the pool and are marked as invalid.</span></span> <span data-ttu-id="47259-142">Ces connexions sont alors définitivement supprimées.</span><span class="sxs-lookup"><span data-stu-id="47259-142">These connections are then permanently removed.</span></span>  
  
 <span data-ttu-id="47259-143">Si une connexion existante à un serveur a disparu, il est possible de la retirer du pool si le dispositif de regroupement n'a pas détecté d'interruption de la connexion et ne l'a pas marquée comme non valide.</span><span class="sxs-lookup"><span data-stu-id="47259-143">If a connection exists to a server that has disappeared, this connection can be drawn from the pool if the connection pooler has not detected the severed connection and marked it as invalid.</span></span> <span data-ttu-id="47259-144">Dans ce cas, une exception est générée.</span><span class="sxs-lookup"><span data-stu-id="47259-144">When this occurs, an exception is generated.</span></span> <span data-ttu-id="47259-145">Vous devez cependant toujours fermer la connexion afin de la libérer à nouveau vers le pool.</span><span class="sxs-lookup"><span data-stu-id="47259-145">However, you must still close the connection in order to release it back into the pool.</span></span>  
  
 <span data-ttu-id="47259-146">N'appelez pas une commande `Close` ou `Dispose` sur une `Connection`, un `DataReader` ou tout autre objet managé dans la méthode `Finalize` de votre classe.</span><span class="sxs-lookup"><span data-stu-id="47259-146">Do not call `Close` or `Dispose` on a `Connection`, a `DataReader`, or any other managed object in the `Finalize` method of your class.</span></span> <span data-ttu-id="47259-147">Dans un finaliseur, libérez seulement les ressources non managées que votre classe possède directement.</span><span class="sxs-lookup"><span data-stu-id="47259-147">In a finalizer, only release unmanaged resources that your class owns directly.</span></span> <span data-ttu-id="47259-148">Si votre classe ne possède pas de ressource non managée, n'incluez pas une méthode `Finalize` dans la définition de classe.</span><span class="sxs-lookup"><span data-stu-id="47259-148">If your class does not own any unmanaged resources, do not include a `Finalize` method in your class definition.</span></span> <span data-ttu-id="47259-149">Pour plus d’informations, consultez [le Garbage Collection](../../../../docs/standard/garbage-collection/index.md).</span><span class="sxs-lookup"><span data-stu-id="47259-149">For more information, see [Garbage Collection](../../../../docs/standard/garbage-collection/index.md).</span></span>  
  
### <a name="transaction-support"></a><span data-ttu-id="47259-150">Prise en charge des transactions</span><span class="sxs-lookup"><span data-stu-id="47259-150">Transaction Support</span></span>  
 <span data-ttu-id="47259-151">Les connexions sont retirées du pool et assignées en fonction du contexte de transaction.</span><span class="sxs-lookup"><span data-stu-id="47259-151">Connections are drawn from the pool and assigned based on transaction context.</span></span> <span data-ttu-id="47259-152">Le contexte du thread de requête et la connexion assignée doivent correspondre.</span><span class="sxs-lookup"><span data-stu-id="47259-152">The context of the requesting thread and the assigned connection must match.</span></span> <span data-ttu-id="47259-153">Par conséquent, chaque pool de connexions est en fait sous-divisé en connexions aucun contexte de transaction associé avec eux et dans *N* sous-divisions qui contiennent chacune des connexions avec un contexte de transaction particulier.</span><span class="sxs-lookup"><span data-stu-id="47259-153">Therefore, each connection pool is actually subdivided into connections with no transaction context associated with them, and into *N* subdivisions that each contain connections with a particular transaction context.</span></span>  
  
 <span data-ttu-id="47259-154">Lorsqu’une connexion est fermée, elle est libérée à nouveau vers le pool et dans la sous-division appropriée en fonction de son contexte de transaction.</span><span class="sxs-lookup"><span data-stu-id="47259-154">When a connection is closed, it is released back into the pool and into the appropriate subdivision based on its transaction context.</span></span> <span data-ttu-id="47259-155">Par conséquent, vous pouvez fermer la connexion sans générer d'erreur, même si une transaction distribuée est toujours en attente.</span><span class="sxs-lookup"><span data-stu-id="47259-155">Therefore, you can close the connection without generating an error, even though a distributed transaction is still pending.</span></span> <span data-ttu-id="47259-156">Cela vous permet de valider ou d'abandonner ultérieurement la transaction distribuée.</span><span class="sxs-lookup"><span data-stu-id="47259-156">This allows you to commit or abort the distributed transaction at a later time.</span></span>  
  
### <a name="controlling-connection-pooling-with-connection-string-keywords"></a><span data-ttu-id="47259-157">Contrôle des pools de connexions avec les mots clés des chaînes de connexion</span><span class="sxs-lookup"><span data-stu-id="47259-157">Controlling Connection Pooling with Connection String Keywords</span></span>  
 <span data-ttu-id="47259-158">La propriété <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> de l'objet <xref:System.Data.OracleClient.OracleConnection> prend en charge les paires clé-valeur des chaînes de connexion qui peuvent être utilisées pour ajuster le comportement de la logique de regroupement des connexions.</span><span class="sxs-lookup"><span data-stu-id="47259-158">The <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> property of the <xref:System.Data.OracleClient.OracleConnection> object supports connection string key/value pairs that can be used to adjust the behavior of the connection pooling logic.</span></span>  
  
 <span data-ttu-id="47259-159">Le tableau suivant décrit les valeurs <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> que vous pouvez utiliser pour ajuster le comportement de regroupement des connexions.</span><span class="sxs-lookup"><span data-stu-id="47259-159">The following table describes the <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> values you can use to adjust connection pooling behavior.</span></span>  
  
|<span data-ttu-id="47259-160">Nom</span><span class="sxs-lookup"><span data-stu-id="47259-160">Name</span></span>|<span data-ttu-id="47259-161">Par défaut</span><span class="sxs-lookup"><span data-stu-id="47259-161">Default</span></span>|<span data-ttu-id="47259-162">Description</span><span class="sxs-lookup"><span data-stu-id="47259-162">Description</span></span>|  
|----------|-------------|-----------------|  
|`Connection Lifetime`|<span data-ttu-id="47259-163">0</span><span class="sxs-lookup"><span data-stu-id="47259-163">0</span></span>|<span data-ttu-id="47259-164">Lorsqu'une connexion est retournée au pool, l'heure de sa création est comparée à l'heure actuelle et la connexion est détruite si cet intervalle de temps (en secondes) excède la valeur spécifiée par `Connection Lifetime`.</span><span class="sxs-lookup"><span data-stu-id="47259-164">When a connection is returned to the pool, its creation time is compared with the current time, and the connection is destroyed if that time span (in seconds) exceeds the value specified by `Connection Lifetime`.</span></span> <span data-ttu-id="47259-165">Cela est utile dans les configurations en clusters pour forcer l'équilibrage de la charge entre un serveur en cours d'exécution et un serveur qui vient d'être mis en ligne.</span><span class="sxs-lookup"><span data-stu-id="47259-165">This is useful in clustered configurations to force load balancing between a running server and a server just brought online.</span></span><br /><br /> <span data-ttu-id="47259-166">La valeur zéro (0) aura pour conséquence un délai d'attente maximal pour les connexions regroupées.</span><span class="sxs-lookup"><span data-stu-id="47259-166">A value of zero (0) will cause pooled connections to have the maximum time-out.</span></span>|  
|`Enlist`|<span data-ttu-id="47259-167">'true'</span><span class="sxs-lookup"><span data-stu-id="47259-167">'true'</span></span>|<span data-ttu-id="47259-168">Si la valeur est `true`, le dispositif de regroupement inscrit automatiquement la connexion dans le contexte de transaction en cours du thread de création si un contexte de transaction existe.</span><span class="sxs-lookup"><span data-stu-id="47259-168">When `true`, the pooler automatically enlists the connection in the current transaction context of the creation thread if a transaction context exists.</span></span>|  
|`Max Pool Size`|<span data-ttu-id="47259-169">100</span><span class="sxs-lookup"><span data-stu-id="47259-169">100</span></span>|<span data-ttu-id="47259-170">Nombre maximal de connexions autorisées dans le pool.</span><span class="sxs-lookup"><span data-stu-id="47259-170">The maximum number of connections allowed in the pool.</span></span>|  
|`Min Pool Size`|<span data-ttu-id="47259-171">0</span><span class="sxs-lookup"><span data-stu-id="47259-171">0</span></span>|<span data-ttu-id="47259-172">Nombre minimal de connexions conservées dans le pool.</span><span class="sxs-lookup"><span data-stu-id="47259-172">The minimum number of connections maintained in the pool.</span></span>|  
|`Pooling`|<span data-ttu-id="47259-173">'true'</span><span class="sxs-lookup"><span data-stu-id="47259-173">'true'</span></span>|<span data-ttu-id="47259-174">Si la valeur est `true`, la connexion est retirée du pool approprié ou, si nécessaire, créée et ajoutée au pool approprié.</span><span class="sxs-lookup"><span data-stu-id="47259-174">When `true`, the connection is drawn from the appropriate pool, or if necessary, created and added to the appropriate pool.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="47259-175">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="47259-175">See Also</span></span>  
 [<span data-ttu-id="47259-176">Regroupement de connexions</span><span class="sxs-lookup"><span data-stu-id="47259-176">Connection Pooling</span></span>](../../../../docs/framework/data/adonet/connection-pooling.md)  
 [<span data-ttu-id="47259-177">Compteurs de performance</span><span class="sxs-lookup"><span data-stu-id="47259-177">Performance Counters</span></span>](../../../../docs/framework/data/adonet/performance-counters.md)  
 [<span data-ttu-id="47259-178">Fournisseurs managés ADO.NET et centre de développement DataSet</span><span class="sxs-lookup"><span data-stu-id="47259-178">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
