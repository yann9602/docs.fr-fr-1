---
title: "Guide pratique pour définir et exécuter des méthodes dynamiques"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology:
- dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- reflection emit, dynamic methods
- dynamic methods
ms.assetid: 07d08a99-62c5-4254-bce2-2a75e55a18ab
caps.latest.revision: 12
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.translationtype: HT
ms.sourcegitcommit: 306c608dc7f97594ef6f72ae0f5aaba596c936e1
ms.openlocfilehash: 67e909a7b64500bba533290061652e82ffde07a5
ms.contentlocale: fr-fr
ms.lasthandoff: 07/28/2017

---
# <a name="how-to-define-and-execute-dynamic-methods"></a><span data-ttu-id="7c7b9-102">Guide pratique pour définir et exécuter des méthodes dynamiques</span><span class="sxs-lookup"><span data-stu-id="7c7b9-102">How to: Define and Execute Dynamic Methods</span></span>
<span data-ttu-id="7c7b9-103">Les procédures suivantes montrent comment définir et exécuter une méthode dynamique simple et une méthode dynamique liée à une instance d’une classe.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-103">The following procedures show how to define and execute a simple dynamic method and a dynamic method bound to an instance of a class.</span></span> <span data-ttu-id="7c7b9-104">Pour plus d’informations sur les méthodes dynamiques, consultez la classe <xref:System.Reflection.Emit.DynamicMethod> et [Scénarios de méthodes dynamiques avec Émission de réflexion](http://msdn.microsoft.com/en-us/7c27ea3d-0f24-4bf3-8ceb-f49d33faca5e).</span><span class="sxs-lookup"><span data-stu-id="7c7b9-104">For more information on dynamic methods, see the <xref:System.Reflection.Emit.DynamicMethod> class and [Reflection Emit Dynamic Method Scenarios](http://msdn.microsoft.com/en-us/7c27ea3d-0f24-4bf3-8ceb-f49d33faca5e).</span></span>  
  
### <a name="to-define-and-execute-a-dynamic-method"></a><span data-ttu-id="7c7b9-105">Pour définir et exécuter une méthode dynamique</span><span class="sxs-lookup"><span data-stu-id="7c7b9-105">To define and execute a dynamic method</span></span>  
  
1.  <span data-ttu-id="7c7b9-106">Déclarez un type délégué pour exécuter la méthode.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-106">Declare a delegate type to execute the method.</span></span> <span data-ttu-id="7c7b9-107">Vous pouvez utiliser un délégué générique pour réduire le nombre de types délégués que vous devez déclarer.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-107">Consider using a generic delegate to minimize the number of delegate types you need to declare.</span></span> <span data-ttu-id="7c7b9-108">Le code suivant déclare deux types délégués qui peuvent être utilisés pour la méthode `SquareIt`, et l’un d’eux est générique.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-108">The following code declares two delegate types that could be used for the `SquareIt` method, and one of them is generic.</span></span>  
  
     <span data-ttu-id="7c7b9-109">[!code-cpp[DynamicMethodHowTo#2](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#2)]  [!code-csharp[DynamicMethodHowTo#2](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#2)]  [!code-vb[DynamicMethodHowTo#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#2)]</span><span class="sxs-lookup"><span data-stu-id="7c7b9-109">[!code-cpp[DynamicMethodHowTo#2](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#2)]  [!code-csharp[DynamicMethodHowTo#2](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#2)]  [!code-vb[DynamicMethodHowTo#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#2)]</span></span>  
  
2.  <span data-ttu-id="7c7b9-110">Créez un tableau qui spécifie les types de paramètre de la méthode dynamique.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-110">Create an array that specifies the parameter types for the dynamic method.</span></span> <span data-ttu-id="7c7b9-111">Dans cet exemple, le seul paramètre est un `int` (`Integer` en Visual Basic). Le tableau n’a donc qu’un seul élément.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-111">In this example, the only parameter is an `int` (`Integer` in Visual Basic), so the array has only one element.</span></span>  
  
     <span data-ttu-id="7c7b9-112">[!code-cpp[DynamicMethodHowTo#3](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#3)]  [!code-csharp[DynamicMethodHowTo#3](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#3)]  [!code-vb[DynamicMethodHowTo#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#3)]</span><span class="sxs-lookup"><span data-stu-id="7c7b9-112">[!code-cpp[DynamicMethodHowTo#3](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#3)]  [!code-csharp[DynamicMethodHowTo#3](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#3)]  [!code-vb[DynamicMethodHowTo#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#3)]</span></span>  
  
3.  <span data-ttu-id="7c7b9-113">Créez un <xref:System.Reflection.Emit.DynamicMethod>.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-113">Create a <xref:System.Reflection.Emit.DynamicMethod>.</span></span> <span data-ttu-id="7c7b9-114">Dans cet exemple, la méthode se nomme `SquareIt`.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-114">In this example the method is named `SquareIt`.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="7c7b9-115">Il n’est pas nécessaire de nommer les méthodes dynamiques. Elles ne peuvent pas être appelées par nom.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-115">It is not necessary to give dynamic methods names, and they cannot be invoked by name.</span></span> <span data-ttu-id="7c7b9-116">Plusieurs méthodes dynamiques peuvent avoir le même nom.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-116">Multiple dynamic methods can have the same name.</span></span> <span data-ttu-id="7c7b9-117">Toutefois, le nom apparaît dans les piles des appels et peut être utile pour le débogage.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-117">However, the name appears in call stacks and can be useful for debugging.</span></span>  
  
     <span data-ttu-id="7c7b9-118">Le type de la valeur de retour est spécifié comme `long`.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-118">The type of the return value is specified as `long`.</span></span> <span data-ttu-id="7c7b9-119">La méthode est associée au module qui contient la classe `Example`, qui contient l’exemple de code.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-119">The method is associated with the module that contains the `Example` class, which contains the example code.</span></span> <span data-ttu-id="7c7b9-120">Vous pourriez spécifier n’importe quel module chargé.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-120">Any loaded module could be specified.</span></span> <span data-ttu-id="7c7b9-121">La méthode dynamique agit comme une méthode `static` au niveau du module (`Shared` en Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="7c7b9-121">The dynamic method acts like a module-level `static` method (`Shared` in Visual Basic).</span></span>  
  
     <span data-ttu-id="7c7b9-122">[!code-cpp[DynamicMethodHowTo#4](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#4)]  [!code-csharp[DynamicMethodHowTo#4](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#4)]  [!code-vb[DynamicMethodHowTo#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#4)]</span><span class="sxs-lookup"><span data-stu-id="7c7b9-122">[!code-cpp[DynamicMethodHowTo#4](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#4)]  [!code-csharp[DynamicMethodHowTo#4](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#4)]  [!code-vb[DynamicMethodHowTo#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#4)]</span></span>  
  
4.  <span data-ttu-id="7c7b9-123">Émettez le corps de méthode.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-123">Emit the method body.</span></span> <span data-ttu-id="7c7b9-124">Dans cet exemple, un objet <xref:System.Reflection.Emit.ILGenerator> est utilisé pour émettre le code MSIL (Microsoft Intermediate Language).</span><span class="sxs-lookup"><span data-stu-id="7c7b9-124">In this example, an <xref:System.Reflection.Emit.ILGenerator> object is used to emit the Microsoft intermediate language (MSIL).</span></span> <span data-ttu-id="7c7b9-125">Vous pourriez également utiliser un objet <xref:System.Reflection.Emit.DynamicILInfo> conjointement avec des générateurs de code non managé pour émettre le corps de méthode pour un <xref:System.Reflection.Emit.DynamicMethod>.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-125">Alternatively, a <xref:System.Reflection.Emit.DynamicILInfo> object can be used in conjunction with unmanaged code generators to emit the method body for a <xref:System.Reflection.Emit.DynamicMethod>.</span></span>  
  
     <span data-ttu-id="7c7b9-126">Le code MSIL de cet exemple charge l’argument (qui est un `int`) dans la pile, le convertit en `long`, duplique le `long` et multiplie les deux nombres.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-126">The MSIL in this example loads the argument, which is an `int`, onto the stack, converts it to a `long`, duplicates the `long`, and multiplies the two numbers.</span></span> <span data-ttu-id="7c7b9-127">Cela laisse le résultat au carré sur la pile, et il suffit à la méthode de retourner.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-127">This leaves the squared result on the stack, and all the method has to do is return.</span></span>  
  
     <span data-ttu-id="7c7b9-128">[!code-cpp[DynamicMethodHowTo#5](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#5)]  [!code-csharp[DynamicMethodHowTo#5](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#5)]  [!code-vb[DynamicMethodHowTo#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#5)]</span><span class="sxs-lookup"><span data-stu-id="7c7b9-128">[!code-cpp[DynamicMethodHowTo#5](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#5)]  [!code-csharp[DynamicMethodHowTo#5](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#5)]  [!code-vb[DynamicMethodHowTo#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#5)]</span></span>  
  
5.  <span data-ttu-id="7c7b9-129">Créez une instance du délégué (déclaré à l’étape 1) qui représente la méthode dynamique en appelant la méthode <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A>.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-129">Create an instance of the delegate (declared in step 1) that represents the dynamic method by calling the <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A> method.</span></span> <span data-ttu-id="7c7b9-130">La création du délégué achève la méthode, et toute tentative supplémentaire de changement de la méthode (par exemple l’ajout de code MSIL) est ignorée.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-130">Creating the delegate completes the method, and any further attempts to change the method — for example, adding more MSIL — are ignored.</span></span> <span data-ttu-id="7c7b9-131">Le code suivant crée le délégué et l’appelle, à l’aide d’un délégué générique.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-131">The following code creates the delegate and invokes it, using a generic delegate.</span></span>  
  
     <span data-ttu-id="7c7b9-132">[!code-cpp[DynamicMethodHowTo#6](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#6)]  [!code-csharp[DynamicMethodHowTo#6](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#6)]  [!code-vb[DynamicMethodHowTo#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#6)]</span><span class="sxs-lookup"><span data-stu-id="7c7b9-132">[!code-cpp[DynamicMethodHowTo#6](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#6)]  [!code-csharp[DynamicMethodHowTo#6](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#6)]  [!code-vb[DynamicMethodHowTo#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#6)]</span></span>  
  
### <a name="to-define-and-execute-a-dynamic-method-that-is-bound-to-an-object"></a><span data-ttu-id="7c7b9-133">Pour définir et exécuter une méthode dynamique liée à un objet</span><span class="sxs-lookup"><span data-stu-id="7c7b9-133">To define and execute a dynamic method that is bound to an object</span></span>  
  
1.  <span data-ttu-id="7c7b9-134">Déclarez un type délégué pour exécuter la méthode.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-134">Declare a delegate type to execute the method.</span></span> <span data-ttu-id="7c7b9-135">Vous pouvez utiliser un délégué générique pour réduire le nombre de types délégués que vous devez déclarer.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-135">Consider using a generic delegate to minimize the number of delegate types you need to declare.</span></span> <span data-ttu-id="7c7b9-136">Le code suivant déclare un type délégué générique qui peut être utilisé pour exécuter n’importe quelle méthode avec un paramètre et une valeur de retour, ou une méthode avec deux paramètres et une valeur de retour si le délégué est lié à un objet.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-136">The following code declares a generic delegate type that can be used to execute any method with one parameter and a return value, or a method with two parameters and a return value if the delegate is bound to an object.</span></span>  
  
     <span data-ttu-id="7c7b9-137">[!code-cpp[DynamicMethodHowTo#12](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#12)]  [!code-csharp[DynamicMethodHowTo#12](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#12)]  [!code-vb[DynamicMethodHowTo#12](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#12)]</span><span class="sxs-lookup"><span data-stu-id="7c7b9-137">[!code-cpp[DynamicMethodHowTo#12](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#12)]  [!code-csharp[DynamicMethodHowTo#12](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#12)]  [!code-vb[DynamicMethodHowTo#12](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#12)]</span></span>  
  
2.  <span data-ttu-id="7c7b9-138">Créez un tableau qui spécifie les types de paramètre de la méthode dynamique.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-138">Create an array that specifies the parameter types for the dynamic method.</span></span> <span data-ttu-id="7c7b9-139">Si le délégué représentant la méthode doit être lié à un objet, le premier paramètre doit correspondre au type auquel le délégué est lié.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-139">If the delegate representing the method is to be bound to an object, the first parameter must match the type the delegate is bound to.</span></span> <span data-ttu-id="7c7b9-140">Cet exemple contient deux paramètres, de type `Example` et `int` (`Integer` en Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="7c7b9-140">In this example, there are two parameters, of type `Example` and type `int` (`Integer` in Visual Basic).</span></span>  
  
     <span data-ttu-id="7c7b9-141">[!code-cpp[DynamicMethodHowTo#13](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#13)]  [!code-csharp[DynamicMethodHowTo#13](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#13)]  [!code-vb[DynamicMethodHowTo#13](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#13)]</span><span class="sxs-lookup"><span data-stu-id="7c7b9-141">[!code-cpp[DynamicMethodHowTo#13](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#13)]  [!code-csharp[DynamicMethodHowTo#13](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#13)]  [!code-vb[DynamicMethodHowTo#13](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#13)]</span></span>  
  
3.  <span data-ttu-id="7c7b9-142">Créer un <xref:System.Reflection.Emit.DynamicMethod>.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-142">Create a <xref:System.Reflection.Emit.DynamicMethod>.</span></span> <span data-ttu-id="7c7b9-143">Dans cet exemple, la méthode n’a pas de nom.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-143">In this example the method has no name.</span></span> <span data-ttu-id="7c7b9-144">Le type de la valeur de retour est spécifié comme `int` (`Integer` en Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="7c7b9-144">The type of the return value is specified as `int` (`Integer` in Visual Basic).</span></span> <span data-ttu-id="7c7b9-145">La méthode a accès aux membres privés et protégés de la classe `Example`.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-145">The method has access to the private and protected members of the `Example` class.</span></span>  
  
     <span data-ttu-id="7c7b9-146">[!code-cpp[DynamicMethodHowTo#14](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#14)]  [!code-csharp[DynamicMethodHowTo#14](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#14)]  [!code-vb[DynamicMethodHowTo#14](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#14)]</span><span class="sxs-lookup"><span data-stu-id="7c7b9-146">[!code-cpp[DynamicMethodHowTo#14](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#14)]  [!code-csharp[DynamicMethodHowTo#14](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#14)]  [!code-vb[DynamicMethodHowTo#14](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#14)]</span></span>  
  
4.  <span data-ttu-id="7c7b9-147">Émettez le corps de méthode.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-147">Emit the method body.</span></span> <span data-ttu-id="7c7b9-148">Dans cet exemple, un objet <xref:System.Reflection.Emit.ILGenerator> est utilisé pour émettre le code MSIL (Microsoft Intermediate Language).</span><span class="sxs-lookup"><span data-stu-id="7c7b9-148">In this example, an <xref:System.Reflection.Emit.ILGenerator> object is used to emit the Microsoft intermediate language (MSIL).</span></span> <span data-ttu-id="7c7b9-149">Vous pourriez également utiliser un objet <xref:System.Reflection.Emit.DynamicILInfo> conjointement avec des générateurs de code non managé pour émettre le corps de méthode pour un <xref:System.Reflection.Emit.DynamicMethod>.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-149">Alternatively, a <xref:System.Reflection.Emit.DynamicILInfo> object can be used in conjunction with unmanaged code generators to emit the method body for a <xref:System.Reflection.Emit.DynamicMethod>.</span></span>  
  
     <span data-ttu-id="7c7b9-150">Le code MSIL de cet exemple charge le premier argument, qui est une instance de la classe `Example`, et l’utilise pour charger la valeur d’un champ d’instance privé de type `int`.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-150">The MSIL in this example loads the first argument, which is an instance of the `Example` class, and uses it to load the value of a private instance field of type `int`.</span></span> <span data-ttu-id="7c7b9-151">Le deuxième argument est chargé, et les deux nombres sont multipliés.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-151">The second argument is loaded, and the two numbers are multiplied.</span></span> <span data-ttu-id="7c7b9-152">Si le résultat est supérieur à `int`, la valeur est tronquée et les bits les plus significatifs sont ignorés.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-152">If the result is larger than `int`, the value is truncated and the most significant bits are discarded.</span></span> <span data-ttu-id="7c7b9-153">La méthode retourne, avec la valeur de retour sur la pile.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-153">The method returns, with the return value on the stack.</span></span>  
  
     <span data-ttu-id="7c7b9-154">[!code-cpp[DynamicMethodHowTo#15](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#15)]  [!code-csharp[DynamicMethodHowTo#15](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#15)]  [!code-vb[DynamicMethodHowTo#15](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#15)]</span><span class="sxs-lookup"><span data-stu-id="7c7b9-154">[!code-cpp[DynamicMethodHowTo#15](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#15)]  [!code-csharp[DynamicMethodHowTo#15](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#15)]  [!code-vb[DynamicMethodHowTo#15](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#15)]</span></span>  
  
5.  <span data-ttu-id="7c7b9-155">Créez une instance du délégué (déclaré à l’étape 1) qui représente la méthode dynamique en appelant la surcharge de méthode <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%28System.Type%2CSystem.Object%29>.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-155">Create an instance of the delegate (declared in step 1) that represents the dynamic method by calling the <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%28System.Type%2CSystem.Object%29> method overload.</span></span> <span data-ttu-id="7c7b9-156">La création du délégué achève la méthode, et toute tentative supplémentaire de changement de la méthode (par exemple l’ajout de code MSIL) est ignorée.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-156">Creating the delegate completes the method, and any further attempts to change the method — for example, adding more MSIL — are ignored.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="7c7b9-157">Vous pouvez appeler la méthode <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A> plusieurs fois afin de créer des délégués liés à d’autres instances du type cible.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-157">You can call the <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A> method multiple times to create delegates bound to other instances of the target type.</span></span>  
  
     <span data-ttu-id="7c7b9-158">Le code suivant lie la méthode à une nouvelle instance de la classe `Example` dont le champ de test privé a la valeur 42.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-158">The following code binds the method to a new instance of the `Example` class whose private test field is set to 42.</span></span> <span data-ttu-id="7c7b9-159">Autrement dit, chaque fois que le délégué est appelé, l’instance de `Example` est passée au premier paramètre de la méthode.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-159">That is, each time the delegate is invoked the instance of `Example` is passed to the first parameter of the method.</span></span>  
  
     <span data-ttu-id="7c7b9-160">Le délégué `OneParameter` est utilisé, car le premier paramètre de la méthode reçoit toujours l’instance de `Example`.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-160">The delegate `OneParameter` is used because the first parameter of the method always receives the instance of `Example`.</span></span> <span data-ttu-id="7c7b9-161">Quand le délégué est appelé, seul le deuxième paramètre est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-161">When the delegate is invoked, only the second parameter is required.</span></span>  
  
     <span data-ttu-id="7c7b9-162">[!code-cpp[DynamicMethodHowTo#16](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#16)]  [!code-csharp[DynamicMethodHowTo#16](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#16)]  [!code-vb[DynamicMethodHowTo#16](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#16)]</span><span class="sxs-lookup"><span data-stu-id="7c7b9-162">[!code-cpp[DynamicMethodHowTo#16](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#16)]  [!code-csharp[DynamicMethodHowTo#16](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#16)]  [!code-vb[DynamicMethodHowTo#16](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#16)]</span></span>  
  
## <a name="example"></a><span data-ttu-id="7c7b9-163">Exemple</span><span class="sxs-lookup"><span data-stu-id="7c7b9-163">Example</span></span>  
 <span data-ttu-id="7c7b9-164">L’exemple de code suivant montre une méthode dynamique simple et une méthode dynamique liée à une instance d’une classe.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-164">The following code example demonstrates a simple dynamic method and a dynamic method bound to an instance of a class.</span></span>  
  
 <span data-ttu-id="7c7b9-165">La méthode dynamique simple prend un argument, un entier 32 bits, et retourne le carré 64 bits de cet entier.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-165">The simple dynamic method takes one argument, a 32-bit integer, and returns the 64-bit square of that integer.</span></span> <span data-ttu-id="7c7b9-166">Un délégué générique est utilisé pour appeler la méthode.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-166">A generic delegate is used to invoke the method.</span></span>  
  
 <span data-ttu-id="7c7b9-167">La deuxième méthode dynamique a deux paramètres, de type `Example` et `int` (`Integer` en Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="7c7b9-167">The second dynamic method has two parameters, of type `Example` and type `int` (`Integer` in Visual Basic).</span></span> <span data-ttu-id="7c7b9-168">Quand la méthode dynamique a été créée, elle est liée à une instance de `Example`, à l’aide d’un délégué générique qui a un argument de type `int`.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-168">When the dynamic method has been created, it is bound to an instance of `Example`, using a generic delegate that has one argument of type `int`.</span></span> <span data-ttu-id="7c7b9-169">Le délégué n’a pas d’argument de type `Example`, car le premier paramètre de la méthode reçoit toujours l’instance liée de `Example`.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-169">The delegate does not have an argument of type `Example` because the first parameter of the method always receives the bound instance of `Example`.</span></span> <span data-ttu-id="7c7b9-170">Quand le délégué est appelé, seul l’argument `int` est fourni.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-170">When the delegate is invoked, only the `int` argument is supplied.</span></span> <span data-ttu-id="7c7b9-171">Cette méthode dynamique accède à un champ privé de la classe `Example` et retourne le produit du champ privé et l’argument `int`.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-171">This dynamic method accesses a private field of the `Example` class and returns the product of the private field and the `int` argument.</span></span>  
  
 <span data-ttu-id="7c7b9-172">L’exemple de code définit des délégués qui peuvent être utilisés pour exécuter les méthodes.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-172">The code example defines delegates that can be used to execute the methods.</span></span>  
  
 <span data-ttu-id="7c7b9-173">[!code-cpp[DynamicMethodHowTo#1](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#1)] [!code-csharp[DynamicMethodHowTo#1](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#1)] [!code-vb[DynamicMethodHowTo#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#1)]</span><span class="sxs-lookup"><span data-stu-id="7c7b9-173">[!code-cpp[DynamicMethodHowTo#1](../../../samples/snippets/cpp/VS_Snippets_CLR/DynamicMethodHowTo/cpp/source.cpp#1)] [!code-csharp[DynamicMethodHowTo#1](../../../samples/snippets/csharp/VS_Snippets_CLR/DynamicMethodHowTo/cs/source.cs#1)] [!code-vb[DynamicMethodHowTo#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/DynamicMethodHowTo/vb/source.vb#1)]</span></span>  
  
## <a name="compiling-the-code"></a><span data-ttu-id="7c7b9-174">Compilation du code</span><span class="sxs-lookup"><span data-stu-id="7c7b9-174">Compiling the Code</span></span>  
  
-   <span data-ttu-id="7c7b9-175">Le code contient les instructions `using` C# (`Imports` en Visual Basic) nécessaires à la compilation.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-175">The code contains the C# `using` statements (`Imports` in Visual Basic) necessary for compilation.</span></span>  
  
-   <span data-ttu-id="7c7b9-176">Aucune référence d’assembly supplémentaire n’est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-176">No additional assembly references are required.</span></span>  
  
-   <span data-ttu-id="7c7b9-177">Compilez le code sur la ligne de commande à l’aide de csc.exe, vbc.exe ou cl.exe.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-177">Compile the code at the command line using csc.exe, vbc.exe, or cl.exe.</span></span> <span data-ttu-id="7c7b9-178">Pour compiler le code dans Visual Studio, placez-le dans un modèle de projet d’application console.</span><span class="sxs-lookup"><span data-stu-id="7c7b9-178">To compile the code in Visual Studio, place it in a console application project template.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7c7b9-179">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="7c7b9-179">See Also</span></span>  
 <span data-ttu-id="7c7b9-180"><xref:System.Reflection.Emit.DynamicMethod></span><span class="sxs-lookup"><span data-stu-id="7c7b9-180"><xref:System.Reflection.Emit.DynamicMethod></span></span>   
 <span data-ttu-id="7c7b9-181">[Utilisation de Émission de réflexion](http://msdn.microsoft.com/en-us/ccc6540d-0e2c-4d89-b456-eb7353f9e9ac) </span><span class="sxs-lookup"><span data-stu-id="7c7b9-181">[Using Reflection Emit](http://msdn.microsoft.com/en-us/ccc6540d-0e2c-4d89-b456-eb7353f9e9ac) </span></span>  
 [<span data-ttu-id="7c7b9-182">Scénarios de méthodes dynamiques avec Émission de réflexion</span><span class="sxs-lookup"><span data-stu-id="7c7b9-182">Reflection Emit Dynamic Method Scenarios</span></span>](http://msdn.microsoft.com/en-us/7c27ea3d-0f24-4bf3-8ceb-f49d33faca5e)

