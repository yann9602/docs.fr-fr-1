---
title: "Interopérabilité WPF et Win32"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- hosting WPF content in Win32 window [WPF]
- HWND interop [WPF]
- Win32 code [WPF], WPF interoperation
- interoperability [WPF], Win32
ms.assetid: 0ffbde0d-701d-45a3-a6fa-dd71f4d9772e
caps.latest.revision: "26"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 6ff6e008c95844388930a505caacbaf6d407edd1
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/21/2017
---
# <a name="wpf-and-win32-interoperation"></a><span data-ttu-id="991a4-102">Interopérabilité WPF et Win32</span><span class="sxs-lookup"><span data-stu-id="991a4-102">WPF and Win32 Interoperation</span></span>
<span data-ttu-id="991a4-103">Cette rubrique fournit une vue d’ensemble de l’interopérabilité du code [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] et [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="991a4-103">This topic provides an overview of how to interoperate [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.</span></span> [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]<span data-ttu-id="991a4-104"> propose un environnement de création d'applications élaboré.</span><span class="sxs-lookup"><span data-stu-id="991a4-104"> provides a rich environment for creating applications.</span></span> <span data-ttu-id="991a4-105">Toutefois, si vous avez déjà écrit beaucoup de code [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)], vous avez peut-être intérêt à réutiliser une partie de ce code.</span><span class="sxs-lookup"><span data-stu-id="991a4-105">However, when you have a substantial investment in [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] code, it might be more effective to reuse some of that code.</span></span>  
  

  
<a name="basics"></a>   
## <a name="wpf-and-win32-interoperation-basics"></a><span data-ttu-id="991a4-106">Notions de base de l’interopérabilité WPF et Win32</span><span class="sxs-lookup"><span data-stu-id="991a4-106">WPF and Win32 Interoperation Basics</span></span>  
 <span data-ttu-id="991a4-107">Il existe deux techniques principales pour permettre l’interopérabilité du code [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] et [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="991a4-107">There are two basic techniques for interoperation between [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.</span></span>  
  
-   <span data-ttu-id="991a4-108">Hébergement de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dans une fenêtre [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="991a4-108">Host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="991a4-109">Cette technique vous permet d’utiliser les fonctionnalités graphiques avancées de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dans le framework d’une application et d’une fenêtre [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] standard.</span><span class="sxs-lookup"><span data-stu-id="991a4-109">With this technique, you can use the advanced graphics capabilities of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] within the framework of a standard [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window and application.</span></span>  
  
-   <span data-ttu-id="991a4-110">Hébergement d’une fenêtre [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] dans du contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="991a4-110">Host a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="991a4-111">Grâce à cette technique, vous pouvez utiliser un contrôle [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] personnalisé existant dans un autre contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] et passer des données au-delà des limites.</span><span class="sxs-lookup"><span data-stu-id="991a4-111">With this technique, you can use an existing custom [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] control in the context of other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and pass data across the boundaries.</span></span>  
  
 <span data-ttu-id="991a4-112">Cette rubrique présente les concepts inhérents à chacune de ces techniques.</span><span class="sxs-lookup"><span data-stu-id="991a4-112">Each of these techniques is conceptually introduced in this topic.</span></span> <span data-ttu-id="991a4-113">Pour obtenir une illustration du code nécessaire pour l’hébergement de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dans [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], consultez [Procédure pas à pas : hébergement de contenu WPF dans Win32](../../../../docs/framework/wpf/advanced/walkthrough-hosting-wpf-content-in-win32.md).</span><span class="sxs-lookup"><span data-stu-id="991a4-113">For a more code-oriented illustration of hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], see [Walkthrough: Hosting WPF Content in Win32](../../../../docs/framework/wpf/advanced/walkthrough-hosting-wpf-content-in-win32.md).</span></span> <span data-ttu-id="991a4-114">Pour obtenir une illustration du code nécessaire pour l’hébergement de [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] dans [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], consultez [Procédure pas à pas : hébergement d’un contrôle Win32 dans WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-win32-control-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="991a4-114">For a more code-oriented illustration of hosting [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Walkthrough: Hosting a Win32 Control in WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-win32-control-in-wpf.md).</span></span>  
  
<a name="projects"></a>   
## <a name="wpf-interoperation-projects"></a><span data-ttu-id="991a4-115">Projets d’interopérabilité WPF</span><span class="sxs-lookup"><span data-stu-id="991a4-115">WPF Interoperation Projects</span></span>  
 <span data-ttu-id="991a4-116">Les interfaces [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sont constituées de code managé, mais la plupart des programmes [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] existants sont écrits en code [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] non managé.</span><span class="sxs-lookup"><span data-stu-id="991a4-116">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] are managed code, but most existing [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programs are written in unmanaged [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)].</span></span>  <span data-ttu-id="991a4-117">Vous ne pouvez pas appeler une interface [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] à partir d’un vrai programme non managé.</span><span class="sxs-lookup"><span data-stu-id="991a4-117">You cannot call [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] from a true unmanaged program.</span></span> <span data-ttu-id="991a4-118">Toutefois, vous avez la possibilité d’utiliser l’option `/clr` avec le compilateur [!INCLUDE[TLA#tla_visualcpp](../../../../includes/tlasharptla-visualcpp-md.md)] pour créer un programme managé/non managé mixte dans lequel vous pouvez combiner des appels d’[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] managées et non managées de façon transparente.</span><span class="sxs-lookup"><span data-stu-id="991a4-118">However, by using the `/clr` option with the [!INCLUDE[TLA#tla_visualcpp](../../../../includes/tlasharptla-visualcpp-md.md)] compiler, you can create a mixed managed-unmanaged program where you can seamlessly mix managed and unmanaged [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] calls.</span></span>  
  
 <span data-ttu-id="991a4-119">L’un des problèmes au niveau du projet est l’impossibilité de compiler des fichiers [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] dans un projet [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="991a4-119">One project-level complication is that you cannot compile [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] files into a [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] project.</span></span>  <span data-ttu-id="991a4-120">Il existe toutefois plusieurs techniques de division du projet qui permettent de contourner ce problème.</span><span class="sxs-lookup"><span data-stu-id="991a4-120">There are several project division techniques to compensate for this.</span></span>  
  
-   <span data-ttu-id="991a4-121">Créez une DLL [!INCLUDE[TLA2#tla_cshrp](../../../../includes/tla2sharptla-cshrp-md.md)] qui contient toutes les pages [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] sous la forme d’un assembly compilé, puis ajoutez cette [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] comme référence dans l’exécutable [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="991a4-121">Create a [!INCLUDE[TLA2#tla_cshrp](../../../../includes/tla2sharptla-cshrp-md.md)] DLL that contains all your [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] pages as a compiled assembly, and then have your [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] executable include that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] as a reference.</span></span>  
  
-   <span data-ttu-id="991a4-122">Créez un exécutable [!INCLUDE[TLA2#tla_cshrp](../../../../includes/tla2sharptla-cshrp-md.md)] pour le contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], puis ajoutez une référence à une [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] où se trouve le contenu [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="991a4-122">Create a [!INCLUDE[TLA2#tla_cshrp](../../../../includes/tla2sharptla-cshrp-md.md)] executable for the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and have it reference a [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] that contains the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] content.</span></span>  
  
-   <span data-ttu-id="991a4-123">Utilisez <xref:System.Windows.Markup.XamlReader.Load%2A> pour charger des [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] au moment de l’exécution, au lieu de la compilation de votre [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="991a4-123">Use <xref:System.Windows.Markup.XamlReader.Load%2A> to load any [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] at run time, instead of compiling your [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span>  
  
-   <span data-ttu-id="991a4-124">N’utilisez pas [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] et écrire toutes vos [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dans le code, la création de l’arborescence d’éléments à partir de <xref:System.Windows.Application>.</span><span class="sxs-lookup"><span data-stu-id="991a4-124">Do not use [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] at all, and write all your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in code, building up the element tree from <xref:System.Windows.Application>.</span></span>  
  
 <span data-ttu-id="991a4-125">Utilisez la technique qui vous convient le mieux.</span><span class="sxs-lookup"><span data-stu-id="991a4-125">Use whatever approach works best for you.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="991a4-126">Si vous n’avez pas utilisé [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] auparavant, vous remarquerez peut-être la présence de « nouveaux » mots clés, comme `gcnew` et `nullptr`, dans les exemples de code d’interopérabilité.</span><span class="sxs-lookup"><span data-stu-id="991a4-126">If you have not used [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] before, you might notice some "new" keywords such as `gcnew` and `nullptr` in the interoperation code examples.</span></span> <span data-ttu-id="991a4-127">Ces mots clés remplacent l’ancienne syntaxe avec un double trait de soulignement (`__gc`) et constituent une syntaxe plus naturelle pour le code managé dans [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)].</span><span class="sxs-lookup"><span data-stu-id="991a4-127">These keywords supersede the older double-underscore syntax (`__gc`) and provide a more natural syntax for managed code in [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)].</span></span>  <span data-ttu-id="991a4-128">Pour en savoir plus sur les fonctionnalités managées de [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], consultez [Extensions de composant pour les plateformes d’exécution](/cpp/windows/component-extensions-for-runtime-platforms) et [Hello, C++/CLI](http://go.microsoft.com/fwlink/?LinkId=98739).</span><span class="sxs-lookup"><span data-stu-id="991a4-128">To learn more about the [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] managed features, see [Component Extensions for Runtime Platforms](/cpp/windows/component-extensions-for-runtime-platforms) and [Hello, C++/CLI](http://go.microsoft.com/fwlink/?LinkId=98739).</span></span>  
  
<a name="hwnds"></a>   
## <a name="how-wpf-uses-hwnds"></a><span data-ttu-id="991a4-129">Utilisation des HWND par WPF</span><span class="sxs-lookup"><span data-stu-id="991a4-129">How WPF Uses Hwnds</span></span>  
 <span data-ttu-id="991a4-130">Pour tirer le meilleur parti de l’interopérabilité HWND dans [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], vous devez comprendre de quelle façon [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] utilise les HWND.</span><span class="sxs-lookup"><span data-stu-id="991a4-130">To make the most of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] "HWND interop", you need to understand how [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uses HWNDs.</span></span> <span data-ttu-id="991a4-131">Pour un HWND, vous ne pouvez pas combiner du rendu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] avec du rendu [!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)] ou [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] / [!INCLUDE[TLA2#tla_gdiplus](../../../../includes/tla2sharptla-gdiplus-md.md)].</span><span class="sxs-lookup"><span data-stu-id="991a4-131">For any HWND, you cannot mix [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] rendering with [!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)] rendering or [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] / [!INCLUDE[TLA2#tla_gdiplus](../../../../includes/tla2sharptla-gdiplus-md.md)] rendering.</span></span> <span data-ttu-id="991a4-132">Ceci a plusieurs implications.</span><span class="sxs-lookup"><span data-stu-id="991a4-132">This has a number of implications.</span></span> <span data-ttu-id="991a4-133">D’une part, pour pouvoir combiner ces modèles de rendu, vous devez créer une solution d’interopérabilité et utiliser les segments d’interopérabilité désignés pour chaque modèle de rendu à utiliser.</span><span class="sxs-lookup"><span data-stu-id="991a4-133">Primarily, in order to mix these rendering models at all, you must create an interoperation solution, and use designated segments of interoperation for each rendering model that you choose to use.</span></span> <span data-ttu-id="991a4-134">D’autre part, le comportement de rendu crée une restriction d’« espace de rendu » (« airspace » en anglais) relative aux objectifs de la solution d’interopérabilité.</span><span class="sxs-lookup"><span data-stu-id="991a4-134">Also, the rendering behavior creates an "airspace" restriction for what your interoperation solution can accomplish.</span></span> <span data-ttu-id="991a4-135">Le concept d’« espace de rendu » est expliqué en détail dans la rubrique [Vue d’ensemble des régions de technologie](../../../../docs/framework/wpf/advanced/technology-regions-overview.md).</span><span class="sxs-lookup"><span data-stu-id="991a4-135">The "airspace" concept is explained in greater detail in the topic [Technology Regions Overview](../../../../docs/framework/wpf/advanced/technology-regions-overview.md).</span></span>  
  
 <span data-ttu-id="991a4-136">Tous les éléments [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] affichés sont stockés par un HWND.</span><span class="sxs-lookup"><span data-stu-id="991a4-136">All [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements on the screen are ultimately backed by a HWND.</span></span> <span data-ttu-id="991a4-137">Lorsque vous créez un [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window>, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] crée un HWND de niveau supérieur et utilise un <xref:System.Windows.Interop.HwndSource> pour placer le <xref:System.Windows.Window> et son [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu dans le HWND.</span><span class="sxs-lookup"><span data-stu-id="991a4-137">When you create a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window>, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] creates a top-level HWND, and uses an <xref:System.Windows.Interop.HwndSource> to put the <xref:System.Windows.Window> and its [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content inside the HWND.</span></span>  <span data-ttu-id="991a4-138">Le reste du contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dans l’application partage ce HWND spécifique.</span><span class="sxs-lookup"><span data-stu-id="991a4-138">The rest of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in the application shares that singular HWND.</span></span> <span data-ttu-id="991a4-139">Les menus, les zones de liste déroulante et les autres menus contextuels constituent une exception à ce principe.</span><span class="sxs-lookup"><span data-stu-id="991a4-139">An exception is menus, combo box drop downs, and other pop-ups.</span></span> <span data-ttu-id="991a4-140">Ces éléments créent leur propre fenêtre de niveau supérieur, ce qui explique pourquoi un menu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] peut potentiellement dépasser le bord du HWND de fenêtre qui le contient.</span><span class="sxs-lookup"><span data-stu-id="991a4-140">These elements create their own top-level window, which is why a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] menu can potentially go past the edge of the window HWND that contains it.</span></span> <span data-ttu-id="991a4-141">Lorsque vous utilisez <xref:System.Windows.Interop.HwndHost> pour placer un HWND dans [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] informe [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] comment positionner le nouveau HWND enfant par rapport à la [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window> HWND.</span><span class="sxs-lookup"><span data-stu-id="991a4-141">When you use <xref:System.Windows.Interop.HwndHost> to put an HWND inside [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] informs [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] how to position the new child HWND relative to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window> HWND.</span></span>  
  
 <span data-ttu-id="991a4-142">La transparence dans et entre les HWND est un concept connexe des HWND.</span><span class="sxs-lookup"><span data-stu-id="991a4-142">A related concept to HWND is transparency within and between each HWND.</span></span> <span data-ttu-id="991a4-143">Ceci est également expliqué dans la rubrique [Vue d’ensemble des régions de technologie](../../../../docs/framework/wpf/advanced/technology-regions-overview.md).</span><span class="sxs-lookup"><span data-stu-id="991a4-143">This is also discussed in the topic [Technology Regions Overview](../../../../docs/framework/wpf/advanced/technology-regions-overview.md).</span></span>  
  
<a name="hosting_a_wpf_page"></a>   
## <a name="hosting-wpf-content-in-a-microsoft-win32-window"></a><span data-ttu-id="991a4-144">Hébergement de contenu WPF dans une fenêtre Microsoft Win32</span><span class="sxs-lookup"><span data-stu-id="991a4-144">Hosting WPF Content in a Microsoft Win32 Window</span></span>  
 <span data-ttu-id="991a4-145">La clé d’hébergement une [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sur un [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] fenêtre est la <xref:System.Windows.Interop.HwndSource> classe.</span><span class="sxs-lookup"><span data-stu-id="991a4-145">The key to hosting a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] on a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is the <xref:System.Windows.Interop.HwndSource> class.</span></span> <span data-ttu-id="991a4-146">Cette classe inclut le contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dans un wrapper dans une fenêtre [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], ce qui permet au contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] d’être incorporé dans votre [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] sous la forme d’une fenêtre enfant.</span><span class="sxs-lookup"><span data-stu-id="991a4-146">This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, so that the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content can be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window.</span></span> <span data-ttu-id="991a4-147">L'approche suivante combine [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] et [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dans une même application.</span><span class="sxs-lookup"><span data-stu-id="991a4-147">The following approach combines the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application.</span></span>  
  
1.  <span data-ttu-id="991a4-148">Implémentez le contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] (l’élément racine du contenu) comme une classe managée.</span><span class="sxs-lookup"><span data-stu-id="991a4-148">Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (the content root element) as a managed class.</span></span> <span data-ttu-id="991a4-149">En règle générale, la classe hérite d’une des classes qui peuvent contenir plusieurs éléments enfants et/ou utilisée comme un élément racine, telle que <xref:System.Windows.Controls.DockPanel> ou <xref:System.Windows.Controls.Page>.</span><span class="sxs-lookup"><span data-stu-id="991a4-149">Typically, the class inherits from one of the classes that can contain multiple child elements and/or used as a root element, such as <xref:System.Windows.Controls.DockPanel> or <xref:System.Windows.Controls.Page>.</span></span> <span data-ttu-id="991a4-150">Dans les étapes suivantes, cette classe est appelée « classe de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] » et les instances de la classe sont appelées « objets de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] ».</span><span class="sxs-lookup"><span data-stu-id="991a4-150">In subsequent steps, this class is referred to as the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class, and instances of the class are referred to as [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content objects.</span></span>  
  
2.  <span data-ttu-id="991a4-151">Implémentez une application [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] avec [!INCLUDE[TLA2#tla_cppcli](../../../../includes/tla2sharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="991a4-151">Implement a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application with [!INCLUDE[TLA2#tla_cppcli](../../../../includes/tla2sharptla-cppcli-md.md)].</span></span> <span data-ttu-id="991a4-152">Si vous démarrez avec une application [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] non managée existante, vous pouvez généralement lui permettre d’appeler du code managé en modifiant les paramètres du projet pour inclure l’indicateur de compilateur `/clr` (cette rubrique ne décrit pas de façon exhaustive les éléments potentiellement nécessaires pour la prise en charge de la compilation `/clr`).</span><span class="sxs-lookup"><span data-stu-id="991a4-152">If you are starting with an existing unmanaged [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)] application, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag (the full scope of what might be necessary to support `/clr` compilation is not described in this topic).</span></span>  
  
3.  <span data-ttu-id="991a4-153">Définissez le thread unique cloisonné (STA) comme modèle de thread.</span><span class="sxs-lookup"><span data-stu-id="991a4-153">Set the threading model to Single Threaded Apartment (STA).</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="991a4-154"> utilise ce modèle de thread.</span><span class="sxs-lookup"><span data-stu-id="991a4-154"> uses this threading model.</span></span>  
  
4.  <span data-ttu-id="991a4-155">Gérez la notification WM_CREATE dans votre procédure de fenêtre.</span><span class="sxs-lookup"><span data-stu-id="991a4-155">Handle the WM_CREATE notification in your window procedure.</span></span>  
  
5.  <span data-ttu-id="991a4-156">Dans le gestionnaire (ou une fonction appelée par le gestionnaire), effectuez les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="991a4-156">Within the handler (or a function that the handler calls), do the following:</span></span>  
  
    1.  <span data-ttu-id="991a4-157">Créer un nouveau <xref:System.Windows.Interop.HwndSource> objet avec la fenêtre parente HWND en tant que son `parent` paramètre.</span><span class="sxs-lookup"><span data-stu-id="991a4-157">Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window HWND as its `parent` parameter.</span></span>  
  
    2.  <span data-ttu-id="991a4-158">Créez une instance de la classe de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="991a4-158">Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class.</span></span>  
  
    3.  <span data-ttu-id="991a4-159">Assigner une référence à la [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] objet de contenu pour le <xref:System.Windows.Interop.HwndSource> objet <xref:System.Windows.Interop.HwndSource.RootVisual%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="991a4-159">Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource> object <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property.</span></span>  
  
    4.  <span data-ttu-id="991a4-160">Le <xref:System.Windows.Interop.HwndSource> objet <xref:System.Windows.Interop.HwndSource.Handle%2A> propriété contient le handle de fenêtre (HWND).</span><span class="sxs-lookup"><span data-stu-id="991a4-160">The <xref:System.Windows.Interop.HwndSource> object <xref:System.Windows.Interop.HwndSource.Handle%2A> property contains the window handle (HWND).</span></span> <span data-ttu-id="991a4-161">Pour obtenir un HWND que vous pouvez utiliser dans la partie non managée de l'application, effectuez un cast de `Handle.ToPointer()` en HWND.</span><span class="sxs-lookup"><span data-stu-id="991a4-161">To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND.</span></span>  
  
6.  <span data-ttu-id="991a4-162">Implémentez une classe managée qui contient un champ statique comportant une référence à l’objet de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="991a4-162">Implement a managed class that contains a static field that holds a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object.</span></span> <span data-ttu-id="991a4-163">Cette classe vous permet d’obtenir une référence à la [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] objet de contenu à partir de votre [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code, mais plus important encore, il empêche votre <xref:System.Windows.Interop.HwndSource> par inadvertance le garbage collecté.</span><span class="sxs-lookup"><span data-stu-id="991a4-163">This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code, but more importantly it prevents your <xref:System.Windows.Interop.HwndSource> from being inadvertently garbage collected.</span></span>  
  
7.  <span data-ttu-id="991a4-164">Recevez les notifications de l’objet de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] en attachant un gestionnaire à un ou plusieurs événements de l’objet de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="991a4-164">Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object events.</span></span>  
  
8.  <span data-ttu-id="991a4-165">Communiquez avec l’objet de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] en utilisant la référence que vous avez stockée dans le champ statique pour définir les propriétés, les méthodes d’appel, etc.</span><span class="sxs-lookup"><span data-stu-id="991a4-165">Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object by using the reference that you stored in the static field to set properties, call methods, etc.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="991a4-166">Vous pouvez faire une partie ou la totalité de la définition de la classe de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] de la première étape dans [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] à l’aide de la classe partielle par défaut de la classe de contenu, à condition de créer un assembly distinct et de le référencer.</span><span class="sxs-lookup"><span data-stu-id="991a4-166">You can do some or all of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class definition for Step One in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] using the default partial class of the content class, if you produce a separate assembly and then reference it.</span></span> <span data-ttu-id="991a4-167">Bien que vous incluez généralement un <xref:System.Windows.Application> objet dans le cadre de la compilation de la [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] dans un assembly, vous ne terminez pas à l’aide qui <xref:System.Windows.Application> dans le cadre de l’interopérabilité, vous utilisez simplement une ou plusieurs classes racine pour [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] les fichiers référencés pour l’application et faire référence à leurs classes partielles.</span><span class="sxs-lookup"><span data-stu-id="991a4-167">Although you typically include an <xref:System.Windows.Application> object as part of compiling the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] into an assembly, you do not end up using that <xref:System.Windows.Application> as part of the interoperation, you just use one or more of the root classes for [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] files referred to by the application and reference their partial classes.</span></span> <span data-ttu-id="991a4-168">Le reste de la procédure est quasiment identique à celle présentée ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="991a4-168">The remainder of the procedure is essentially similar to that outlined above.</span></span>  
>   
>  <span data-ttu-id="991a4-169">Chacune de ces étapes est illustrée par du code dans la rubrique [Procédure pas à pas : hébergement de contenu WPF dans Win32](../../../../docs/framework/wpf/advanced/walkthrough-hosting-wpf-content-in-win32.md).</span><span class="sxs-lookup"><span data-stu-id="991a4-169">Each of these steps is illustrated through code in the topic [Walkthrough: Hosting WPF Content in Win32](../../../../docs/framework/wpf/advanced/walkthrough-hosting-wpf-content-in-win32.md).</span></span>  
  
<a name="hosting_an_hwnd"></a>   
## <a name="hosting-a-microsoft-win32-window-in-wpf"></a><span data-ttu-id="991a4-170">Hébergement d’une fenêtre Microsoft Win32 dans WPF</span><span class="sxs-lookup"><span data-stu-id="991a4-170">Hosting a Microsoft Win32 Window in WPF</span></span>  
 <span data-ttu-id="991a4-171">La clé d’hébergement une [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] fenêtre dans les autres [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] le contenu est la <xref:System.Windows.Interop.HwndHost> classe.</span><span class="sxs-lookup"><span data-stu-id="991a4-171">The key to hosting a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window within other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is the <xref:System.Windows.Interop.HwndHost> class.</span></span> <span data-ttu-id="991a4-172">Cette classe inclut la fenêtre dans un wrapper dans un élément [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] qui peut être ajouté à une arborescence d’éléments [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="991a4-172">This class wraps the window in a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] element which can be added to a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] element tree.</span></span> <span data-ttu-id="991a4-173"><xref:System.Windows.Interop.HwndHost>prend également en charge [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] qui permettent d’effectuer des tâches telles que le traitement des messages pour la fenêtre hébergée.</span><span class="sxs-lookup"><span data-stu-id="991a4-173"><xref:System.Windows.Interop.HwndHost> also supports [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] that allow you to do such tasks as process messages for the hosted window.</span></span> <span data-ttu-id="991a4-174">La procédure de base est la suivante :</span><span class="sxs-lookup"><span data-stu-id="991a4-174">The basic procedure is:</span></span>  
  
1.  <span data-ttu-id="991a4-175">Créez une arborescence d’éléments pour une application [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] (à l’aide de code ou de balises).</span><span class="sxs-lookup"><span data-stu-id="991a4-175">Create an element tree for a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application (can be through code or markup).</span></span> <span data-ttu-id="991a4-176">Rechercher un point approprié et autorisé dans l’arborescence d’éléments où les <xref:System.Windows.Interop.HwndHost> implémentation peut être ajoutée comme un élément enfant.</span><span class="sxs-lookup"><span data-stu-id="991a4-176">Find an appropriate and permissible point in the element tree where the <xref:System.Windows.Interop.HwndHost> implementation can be added as a child element.</span></span> <span data-ttu-id="991a4-177">Dans les étapes suivantes, cet élément est appelé élément de réservation.</span><span class="sxs-lookup"><span data-stu-id="991a4-177">In the remainder of these steps, this element is referred to as the reserving element.</span></span>  
  
2.  <span data-ttu-id="991a4-178">Dériver de <xref:System.Windows.Interop.HwndHost> pour créer un objet qui contient votre [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] contenu.</span><span class="sxs-lookup"><span data-stu-id="991a4-178">Derive from <xref:System.Windows.Interop.HwndHost> to create an object that holds your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] content.</span></span>  
  
3.  <span data-ttu-id="991a4-179">Dans cette classe hôte, substituez le <xref:System.Windows.Interop.HwndHost> méthode <xref:System.Windows.Interop.HwndHost.BuildWindowCore%2A>.</span><span class="sxs-lookup"><span data-stu-id="991a4-179">In that host class, override the <xref:System.Windows.Interop.HwndHost> method <xref:System.Windows.Interop.HwndHost.BuildWindowCore%2A>.</span></span> <span data-ttu-id="991a4-180">Retournez le HWND de la fenêtre hébergée.</span><span class="sxs-lookup"><span data-stu-id="991a4-180">Return the HWND of the hosted window.</span></span> <span data-ttu-id="991a4-181">Vous pouvez inclure le ou les contrôles réels dans un wrapper comme une fenêtre enfant de la fenêtre retournée. L’inclusion des contrôles dans un wrapper dans une fenêtre hôte permet au contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] de recevoir facilement les notifications des contrôles.</span><span class="sxs-lookup"><span data-stu-id="991a4-181">You might want to wrap the actual control(s) as a child window of the returned window; wrapping the controls in a host window provides a simple way for your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to receive notifications from the controls.</span></span> <span data-ttu-id="991a4-182">Cette technique permet d’éviter certains problèmes de [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] liés à la gestion des messages à la limite d’un contrôle hébergé.</span><span class="sxs-lookup"><span data-stu-id="991a4-182">This technique helps correct for some [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] issues regarding message handling at the hosted control boundary.</span></span>  
  
4.  <span data-ttu-id="991a4-183">Remplacer la <xref:System.Windows.Interop.HwndHost> méthodes <xref:System.Windows.Interop.HwndHost.DestroyWindowCore%2A> et <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span><span class="sxs-lookup"><span data-stu-id="991a4-183">Override the <xref:System.Windows.Interop.HwndHost> methods <xref:System.Windows.Interop.HwndHost.DestroyWindowCore%2A> and <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span></span> <span data-ttu-id="991a4-184">L’objectif est d’effectuer un nettoyage et de supprimer les références au contenu hébergé, en particulier si vous avez créé des références à des objets non managés.</span><span class="sxs-lookup"><span data-stu-id="991a4-184">The intention here is to process cleanup and remove references to the hosted content, particularly if you created references to unmanaged objects.</span></span>  
  
5.  <span data-ttu-id="991a4-185">Dans votre fichier code-behind, créez une instance de la classe d’hébergement de contrôle et définissez-la comme enfant de l’élément de réservation.</span><span class="sxs-lookup"><span data-stu-id="991a4-185">In your code-behind file, create an instance of the control hosting class and make it a child of the reserving element.</span></span> <span data-ttu-id="991a4-186">En général, vous utiliseriez un gestionnaire d’événements tel que <xref:System.Windows.FrameworkElement.Loaded>, ou utilisez le constructeur de classe partielle.</span><span class="sxs-lookup"><span data-stu-id="991a4-186">Typically you would use an event handler such as <xref:System.Windows.FrameworkElement.Loaded>, or use the partial class constructor.</span></span> <span data-ttu-id="991a4-187">Vous pouvez également ajouter le contenu d’interopérabilité via un comportement au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="991a4-187">But you could also add the interoperation content through a runtime behavior.</span></span>  
  
6.  <span data-ttu-id="991a4-188">Traitez les messages de fenêtre sélectionnés, tels que les notifications de contrôle.</span><span class="sxs-lookup"><span data-stu-id="991a4-188">Process selected window messages, such as control notifications.</span></span> <span data-ttu-id="991a4-189">Il y a deux approches possibles, qui fournissent un accès identique au flux de messages.</span><span class="sxs-lookup"><span data-stu-id="991a4-189">There are two approaches.</span></span> <span data-ttu-id="991a4-190">Votre choix est donc essentiellement motivé par le côté pratique de la programmation.</span><span class="sxs-lookup"><span data-stu-id="991a4-190">Both provide identical access to the message stream, so your choice is largely a matter of programming convenience.</span></span>  
  
    -   <span data-ttu-id="991a4-191">Implémentez traitement des messages pour tous les messages (pas seulement les messages d’arrêt) dans la substitution de la <xref:System.Windows.Interop.HwndHost> méthode <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span><span class="sxs-lookup"><span data-stu-id="991a4-191">Implement message processing for all messages (not just shutdown messages) in your override of the <xref:System.Windows.Interop.HwndHost> method <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span></span>  
  
    -   <span data-ttu-id="991a4-192">Ont l’hébergement [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] élément traiter les messages en gérant la <xref:System.Windows.Interop.HwndHost.MessageHook> événement.</span><span class="sxs-lookup"><span data-stu-id="991a4-192">Have the hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] element process the messages by handling the <xref:System.Windows.Interop.HwndHost.MessageHook> event.</span></span> <span data-ttu-id="991a4-193">Cet événement est déclenché pour chaque message qui est envoyé à la procédure de fenêtre principale de la fenêtre hébergée.</span><span class="sxs-lookup"><span data-stu-id="991a4-193">This event is raised for every message that is sent to the main window procedure of the hosted window.</span></span>  
  
    -   <span data-ttu-id="991a4-194">Impossible de traiter les messages à partir de windows qui ne sont pas à l’aide du processus <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span><span class="sxs-lookup"><span data-stu-id="991a4-194">You cannot process messages from windows that are out of process using <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span></span>  
  
7.  <span data-ttu-id="991a4-195">Communiquez avec la fenêtre hébergée en effectuant un appel de code non managé pour appeler la fonction `SendMessage` non managée.</span><span class="sxs-lookup"><span data-stu-id="991a4-195">Communicate with the hosted window by using platform invoke to call the unmanaged `SendMessage` function.</span></span>  
  
 <span data-ttu-id="991a4-196">L’exécution de ces étapes crée une application qui fonctionne avec des entrées de la souris.</span><span class="sxs-lookup"><span data-stu-id="991a4-196">Following these steps creates an application that works with mouse input.</span></span> <span data-ttu-id="991a4-197">Vous pouvez ajouter la prise en charge de tabulation pour la fenêtre hébergée en implémentant le <xref:System.Windows.Interop.IKeyboardInputSink> interface.</span><span class="sxs-lookup"><span data-stu-id="991a4-197">You can add tabbing support for your hosted window by implementing the <xref:System.Windows.Interop.IKeyboardInputSink> interface.</span></span>  
  
 <span data-ttu-id="991a4-198">Chacune de ces étapes est illustrée par du code dans la rubrique [Procédure pas à pas : hébergement d’un contrôle Win32 dans WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-win32-control-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="991a4-198">Each of these steps is illustrated through code in the topic [Walkthrough: Hosting a Win32 Control in WPF](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-win32-control-in-wpf.md).</span></span>  
  
### <a name="hwnds-inside-wpf"></a><span data-ttu-id="991a4-199">HWND dans WPF</span><span class="sxs-lookup"><span data-stu-id="991a4-199">Hwnds Inside WPF</span></span>  
 <span data-ttu-id="991a4-200">Vous pouvez considérer <xref:System.Windows.Interop.HwndHost> comme un contrôle spécial.</span><span class="sxs-lookup"><span data-stu-id="991a4-200">You can think of <xref:System.Windows.Interop.HwndHost> as a special control.</span></span> <span data-ttu-id="991a4-201">(Techniquement, <xref:System.Windows.Interop.HwndHost> est un <xref:System.Windows.FrameworkElement> classe dérivée, pas un <xref:System.Windows.Controls.Control> classe dérivée, mais il peut être considéré comme un contrôle à des fins d’interopérabilité.) <xref:System.Windows.Interop.HwndHost> résume sous-jacent [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] la nature du contenu hébergé telles que le reste de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] considère le contenu hébergé comme un autre objet de contrôle, qui doit restituer et traiter l’entrée.</span><span class="sxs-lookup"><span data-stu-id="991a4-201">(Technically, <xref:System.Windows.Interop.HwndHost> is a <xref:System.Windows.FrameworkElement> derived class, not a <xref:System.Windows.Controls.Control> derived class, but it can be considered a control for purposes of interoperation.) <xref:System.Windows.Interop.HwndHost> abstracts the underlying [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] nature of the hosted content such that the remainder of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] considers the hosted content to be another control-like object, which should render and process input.</span></span> <span data-ttu-id="991a4-202"><xref:System.Windows.Interop.HwndHost>se comporte généralement comme tout autre [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.FrameworkElement>, bien qu’il existe des différences importantes en termes de sortie (dessin et graphiques) et d’entrée (souris et clavier) selon les limitations de HWND sous-jacents peut prendre en charge.</span><span class="sxs-lookup"><span data-stu-id="991a4-202"><xref:System.Windows.Interop.HwndHost> generally behaves like any other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.FrameworkElement>, although there are some important differences around output (drawing and graphics) and input (mouse and keyboard) based on limitations of what the underlying HWNDs can support.</span></span>  
  
#### <a name="notable-differences-in-output-behavior"></a><span data-ttu-id="991a4-203">Principales différences dans le comportement de sortie</span><span class="sxs-lookup"><span data-stu-id="991a4-203">Notable Differences in Output Behavior</span></span>  
  
-   <span data-ttu-id="991a4-204"><xref:System.Windows.FrameworkElement>, qui est la <xref:System.Windows.Interop.HwndHost> classe de base, a de nombreuses propriétés qui impliquent la modification de l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="991a4-204"><xref:System.Windows.FrameworkElement>, which is the <xref:System.Windows.Interop.HwndHost> base class, has quite a few properties that imply changes to the UI.</span></span> <span data-ttu-id="991a4-205">Ceux-ci incluent des propriétés comme <xref:System.Windows.FrameworkElement.FlowDirection%2A?displayProperty=nameWithType>, ce qui modifie la disposition d’éléments au sein de cet élément en tant que parent.</span><span class="sxs-lookup"><span data-stu-id="991a4-205">These include properties such as <xref:System.Windows.FrameworkElement.FlowDirection%2A?displayProperty=nameWithType>, which changes the layout of elements within that element as a parent.</span></span> <span data-ttu-id="991a4-206">Toutefois, la plupart des propriétés concernées ne sont pas mappées aux équivalents possibles de [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="991a4-206">However, most of these properties are not mapped to possible [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] equivalents, even if such equivalents might exist.</span></span> <span data-ttu-id="991a4-207">Un trop grand nombre de ces propriétés et de leurs significations reposent essentiellement sur la technologie de rendu, ce qui rend les mappages difficiles à utiliser.</span><span class="sxs-lookup"><span data-stu-id="991a4-207">Too many of these properties and their meanings are too rendering-technology specific for mappings to be practical.</span></span> <span data-ttu-id="991a4-208">Par conséquent, définissant les propriétés telles que <xref:System.Windows.FrameworkElement.FlowDirection%2A> sur <xref:System.Windows.Interop.HwndHost> n’a aucun effet.</span><span class="sxs-lookup"><span data-stu-id="991a4-208">Therefore, setting properties such as <xref:System.Windows.FrameworkElement.FlowDirection%2A> on <xref:System.Windows.Interop.HwndHost> has no effect.</span></span>  
  
-   <span data-ttu-id="991a4-209"><xref:System.Windows.Interop.HwndHost>ne peut pas être pivoté, mis à l’échelle, inclinée ou sinon affectées par une transformation.</span><span class="sxs-lookup"><span data-stu-id="991a4-209"><xref:System.Windows.Interop.HwndHost> cannot be rotated, scaled, skewed, or otherwise affected by a Transform.</span></span>  
  
-   <span data-ttu-id="991a4-210"><xref:System.Windows.Interop.HwndHost>ne prend pas en charge le <xref:System.Windows.UIElement.Opacity%2A> propriété (fusion alpha).</span><span class="sxs-lookup"><span data-stu-id="991a4-210"><xref:System.Windows.Interop.HwndHost> does not support the <xref:System.Windows.UIElement.Opacity%2A> property (alpha blending).</span></span> <span data-ttu-id="991a4-211">Si le contenu de la <xref:System.Windows.Interop.HwndHost> effectue <xref:System.Drawing> opérations qui incluent des informations alpha, qui n’est lui-même pas une violation, mais la <xref:System.Windows.Interop.HwndHost> comme ensemble prend uniquement en charge l’opacité = 1.0 (100 %).</span><span class="sxs-lookup"><span data-stu-id="991a4-211">If content inside the <xref:System.Windows.Interop.HwndHost> performs <xref:System.Drawing> operations that include alpha information, that is itself not a violation, but the <xref:System.Windows.Interop.HwndHost> as a whole only supports Opacity = 1.0 (100%).</span></span>  
  
-   <span data-ttu-id="991a4-212"><xref:System.Windows.Interop.HwndHost>s’affiche sur les autres [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] éléments dans la même fenêtre de niveau supérieur.</span><span class="sxs-lookup"><span data-stu-id="991a4-212"><xref:System.Windows.Interop.HwndHost> will appear on top of other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements in the same top-level window.</span></span> <span data-ttu-id="991a4-213">Toutefois, un <xref:System.Windows.Controls.ToolTip> ou <xref:System.Windows.Controls.ContextMenu> menu généré est une fenêtre de niveau supérieur distincte et il se comporte correctement avec <xref:System.Windows.Interop.HwndHost>.</span><span class="sxs-lookup"><span data-stu-id="991a4-213">However, a <xref:System.Windows.Controls.ToolTip> or <xref:System.Windows.Controls.ContextMenu> generated menu is a separate top-level window, and so will behave correctly with <xref:System.Windows.Interop.HwndHost>.</span></span>  
  
-   <span data-ttu-id="991a4-214"><xref:System.Windows.Interop.HwndHost>ne respecte pas la zone de découpage de son parent <xref:System.Windows.UIElement>.</span><span class="sxs-lookup"><span data-stu-id="991a4-214"><xref:System.Windows.Interop.HwndHost> does not respect the clipping region of its parent <xref:System.Windows.UIElement>.</span></span> <span data-ttu-id="991a4-215">Cela peut poser problème si vous tentez de placer un <xref:System.Windows.Interop.HwndHost> classe à l’intérieur d’une zone de défilement ou <xref:System.Windows.Controls.Canvas>.</span><span class="sxs-lookup"><span data-stu-id="991a4-215">This is potentially an issue if you attempt to put an <xref:System.Windows.Interop.HwndHost> class inside a scrolling region or <xref:System.Windows.Controls.Canvas>.</span></span>  
  
#### <a name="notable-differences-in-input-behavior"></a><span data-ttu-id="991a4-216">Principales différences dans le comportement d’entrée</span><span class="sxs-lookup"><span data-stu-id="991a4-216">Notable Differences in Input Behavior</span></span>  
  
-   <span data-ttu-id="991a4-217">En général, tandis que les périphériques d’entrée sont limitées dans le <xref:System.Windows.Interop.HwndHost> hébergé [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] région, les événements d’entrée accéder directement à [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="991a4-217">In general, while input devices are scoped within the <xref:System.Windows.Interop.HwndHost> hosted [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] region, input events go directly to [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span></span>  
  
-   <span data-ttu-id="991a4-218">Alors que la souris est sur le <xref:System.Windows.Interop.HwndHost>, votre application ne reçoit pas [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] les événements de souris et la valeur de la [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] propriété <xref:System.Windows.UIElement.IsMouseOver%2A> sera `false`.</span><span class="sxs-lookup"><span data-stu-id="991a4-218">While the mouse is over the <xref:System.Windows.Interop.HwndHost>, your application does not receive [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] mouse events, and the value of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property <xref:System.Windows.UIElement.IsMouseOver%2A> will be `false`.</span></span>  
  
-   <span data-ttu-id="991a4-219">Alors que le <xref:System.Windows.Interop.HwndHost> a le focus clavier, votre application ne reçoit pas [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] événements de clavier et la valeur de la [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] propriété <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> sera `false`.</span><span class="sxs-lookup"><span data-stu-id="991a4-219">While the <xref:System.Windows.Interop.HwndHost> has keyboard focus, your application will not receive [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] keyboard events and the value of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> will be `false`.</span></span>  
  
-   <span data-ttu-id="991a4-220">Lorsque le focus se trouve dans le <xref:System.Windows.Interop.HwndHost> et modifications apportées à un autre contrôle à l’intérieur de la <xref:System.Windows.Interop.HwndHost>, votre application ne reçoit pas les [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] événements <xref:System.Windows.UIElement.GotFocus> ou <xref:System.Windows.UIElement.LostFocus>.</span><span class="sxs-lookup"><span data-stu-id="991a4-220">When focus is within the <xref:System.Windows.Interop.HwndHost> and changes to another control inside the <xref:System.Windows.Interop.HwndHost>, your application will not receive the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events <xref:System.Windows.UIElement.GotFocus> or <xref:System.Windows.UIElement.LostFocus>.</span></span>  
  
-   <span data-ttu-id="991a4-221">Liées sont semblables et ne signalent pas d’informations lorsque le stylet est sur les événements et les propriétés de stylet <xref:System.Windows.Interop.HwndHost>.</span><span class="sxs-lookup"><span data-stu-id="991a4-221">Related stylus properties and events are analogous, and do not report information while the stylus is over <xref:System.Windows.Interop.HwndHost>.</span></span>  
  
<a name="tabbing_mnemonics_accelerators"></a>   
## <a name="tabbing-mnemonics-and-accelerators"></a><span data-ttu-id="991a4-222">Tabulation, mnémoniques et accélérateurs</span><span class="sxs-lookup"><span data-stu-id="991a4-222">Tabbing, Mnemonics, and Accelerators</span></span>  
 <span data-ttu-id="991a4-223">Le <xref:System.Windows.Interop.IKeyboardInputSink> et <xref:System.Windows.Interop.IKeyboardInputSite> les interfaces permettent de créer une expérience de clavier transparente pour mixte [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] et [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications :</span><span class="sxs-lookup"><span data-stu-id="991a4-223">The <xref:System.Windows.Interop.IKeyboardInputSink> and <xref:System.Windows.Interop.IKeyboardInputSite> interfaces allow you to create a seamless keyboard experience for mixed [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications:</span></span>  
  
-   <span data-ttu-id="991a4-224">Tabulation entre des composants [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] et [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="991a4-224">Tabbing between [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] components</span></span>  
  
-   <span data-ttu-id="991a4-225">Mnémoniques et accélérateurs fonctionnant quand le focus est sur un composant Win32 et sur un composant WPF.</span><span class="sxs-lookup"><span data-stu-id="991a4-225">Mnemonics and accelerators that work both when focus is within a Win32 component and when it is within a WPF component.</span></span>  
  
 <span data-ttu-id="991a4-226">Le <xref:System.Windows.Interop.HwndHost> et <xref:System.Windows.Interop.HwndSource> fournissent des implémentations des classes <xref:System.Windows.Interop.IKeyboardInputSink>, mais ils ne peuvent pas gérer tous les messages d’entrée souhaitée pour des scénarios plus avancés.</span><span class="sxs-lookup"><span data-stu-id="991a4-226">The <xref:System.Windows.Interop.HwndHost> and <xref:System.Windows.Interop.HwndSource> classes both provide implementations of <xref:System.Windows.Interop.IKeyboardInputSink>, but they may not handle all the input messages that you want for more advanced scenarios.</span></span> <span data-ttu-id="991a4-227">Dans ce cas, substituez les méthodes appropriées pour obtenir le comportement de clavier souhaité.</span><span class="sxs-lookup"><span data-stu-id="991a4-227">Override the appropriate methods to get the keyboard behavior you want.</span></span>  
  
 <span data-ttu-id="991a4-228">Les interfaces assurent uniquement la prise en charge des événements qui ont lieu lors de la transition entre les zones [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] et [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="991a4-228">The interfaces only provide support for what happens on the transition between the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] regions.</span></span> <span data-ttu-id="991a4-229">Dans la zone [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], le comportement de tabulation est entièrement déterminé par la logique [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] implémentée pour la tabulation, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="991a4-229">Within the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] region, tabbing behavior is entirely controlled by the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] implemented logic for tabbing, if any.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="991a4-230">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="991a4-230">See Also</span></span>  
 <xref:System.Windows.Interop.HwndHost>  
 <xref:System.Windows.Interop.HwndSource>  
 <xref:System.Windows.Interop>  
 [<span data-ttu-id="991a4-231">Procédure pas à pas : hébergement d'un contrôle Win32 dans WPF</span><span class="sxs-lookup"><span data-stu-id="991a4-231">Walkthrough: Hosting a Win32 Control in WPF</span></span>](../../../../docs/framework/wpf/advanced/walkthrough-hosting-a-win32-control-in-wpf.md)  
 [<span data-ttu-id="991a4-232">Procédure pas à pas : hébergement de contenu WPF dans Win32</span><span class="sxs-lookup"><span data-stu-id="991a4-232">Walkthrough: Hosting WPF Content in Win32</span></span>](../../../../docs/framework/wpf/advanced/walkthrough-hosting-wpf-content-in-win32.md)
