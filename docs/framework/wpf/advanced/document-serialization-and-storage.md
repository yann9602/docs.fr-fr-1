---
title: "Sérialisation et stockage de documents"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- 'serialization of documents [WPF], , '
- documents [WPF], storage
- documents [WPF], serialization
ms.assetid: 4839cd87-e206-4571-803f-0200098ad37b
caps.latest.revision: "24"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 9a232e1e2557bf1ecc6bb5f27f941e03a204aec6
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/22/2017
---
# <a name="document-serialization-and-storage"></a><span data-ttu-id="dfb85-102">Sérialisation et stockage de documents</span><span class="sxs-lookup"><span data-stu-id="dfb85-102">Document Serialization and Storage</span></span>
[!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)]<span data-ttu-id="dfb85-103"> fournit un environnement performant pour créer et afficher des documents de haute qualité.</span><span class="sxs-lookup"><span data-stu-id="dfb85-103"> provides a powerful environment for creating and displaying high quality documents.</span></span>  <span data-ttu-id="dfb85-104">Grâce à des fonctionnalités améliorées prenant en charge des documents fixes et dynamiques, des contrôles d’affichage avancés et des fonctions graphiques 2D et 3D puissantes, les applications [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] offrent un niveau de qualité et une expérience utilisateur inégalés.</span><span class="sxs-lookup"><span data-stu-id="dfb85-104">Enhanced features that support both fixed-documents and flow-documents, advanced viewing controls, combined with powerful 2D and 3D graphic capabilities take [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] applications to a new level of quality and user experience.</span></span>  <span data-ttu-id="dfb85-105">Avec le [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)], vous bénéficiez d’une fonctionnalité clé qui vous permet de gérer la représentation en mémoire d’un document avec souplesse. Vous pouvez aussi enregistrer et charger efficacement des documents d’un magasin de données, ce qui est indispensable pour presque toutes les applications.</span><span class="sxs-lookup"><span data-stu-id="dfb85-105">Being able to flexibly manage an in-memory representation of a document is a key feature of [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)], and being able to efficiently save and load documents from a data store is a need of almost every application.</span></span>  <span data-ttu-id="dfb85-106">Le processus de conversion d’un document d’une représentation en mémoire interne en magasin de données externe est appelé sérialisation.</span><span class="sxs-lookup"><span data-stu-id="dfb85-106">The process of converting a document from an internal in-memory representation to an external data store is termed serialization.</span></span>  <span data-ttu-id="dfb85-107">Le processus inverse consistant à lire un magasin de données et à recréer l’instance en mémoire d’origine est appelé désérialisation.</span><span class="sxs-lookup"><span data-stu-id="dfb85-107">The reverse process of reading a data store and recreating the original in-memory instance is termed deserialization.</span></span>  
  
 
  
<a name="AboutSerialization"></a>   
## <a name="about-document-serialization"></a><span data-ttu-id="dfb85-108">À propos de la sérialisation de documents</span><span class="sxs-lookup"><span data-stu-id="dfb85-108">About Document Serialization</span></span>  
 <span data-ttu-id="dfb85-109">Dans l’idéal, les processus de sérialisation et de désérialisation d’un document depuis et vers la mémoire sont transparents pour l’application.</span><span class="sxs-lookup"><span data-stu-id="dfb85-109">Ideally the process of serializing and deserializing a document from and then back into memory is transparent to the application.</span></span>  <span data-ttu-id="dfb85-110">L’application appelle une méthode de sérialiseur « en écriture » pour enregistrer le document, tandis qu’une méthode de désérialiseur « en lecture » accède au magasin de données pour recréer l’instance d’origine en mémoire.</span><span class="sxs-lookup"><span data-stu-id="dfb85-110">The application calls a serializer "write" method to save the document, while a deserializer "read" method accesses the data store and recreates the original instance in memory.</span></span>  <span data-ttu-id="dfb85-111">Le format spécifique de stockage des données ne concerne généralement pas l’application tant que les processus de sérialisation et de désérialisation recréent le document d’origine.</span><span class="sxs-lookup"><span data-stu-id="dfb85-111">The specific format that the data is stored in is generally not a concern of the application as long as the serialize and deserialize process recreates the document back to its original form.</span></span>  
  
 <span data-ttu-id="dfb85-112">Les applications fournissent souvent plusieurs options de sérialisation qui permettent à l’utilisateur d’enregistrer des documents sur différents médias ou dans un format différent.</span><span class="sxs-lookup"><span data-stu-id="dfb85-112">Applications often provide multiple serialization options which allow the user to save documents to different medium or to a different format.</span></span>  <span data-ttu-id="dfb85-113">Par exemple, une application peut proposer des options « Enregistrer sous » pour stocker un document dans un fichier sur disque, une base de données ou un service web.</span><span class="sxs-lookup"><span data-stu-id="dfb85-113">For example, an application might offer "Save As" options to store a document to a disk file, database, or web service.</span></span>  <span data-ttu-id="dfb85-114">De même, différents sérialiseurs peuvent stocker le document sous divers formats, tels que les formats HTML, RTF, XML ou XPS, ou encore un format tiers.</span><span class="sxs-lookup"><span data-stu-id="dfb85-114">Similarly, different serializers could store the document in different formats such as in HTML, RTF, XML, XPS, or alternately to a third-party format.</span></span>  <span data-ttu-id="dfb85-115">Pour l’application, la sérialisation définit une interface qui isole les détails du média de stockage dans l’implémentation de chaque sérialiseur spécifique.</span><span class="sxs-lookup"><span data-stu-id="dfb85-115">To the application, serialization defines an interface that isolates the details of the storage medium within the implementation of each specific serializer.</span></span>  <span data-ttu-id="dfb85-116">Outre les avantages de l’encapsulation des détails sur le stockage, le [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] <xref:System.Windows.Documents.Serialization> [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] fournir d’autres fonctionnalités importantes.</span><span class="sxs-lookup"><span data-stu-id="dfb85-116">In addition to the benefits of encapsulating storage details, the [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] <xref:System.Windows.Documents.Serialization> [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] provide several other important features.</span></span>  
  
### <a name="features-of-net-framework-30-document-serializers"></a><span data-ttu-id="dfb85-117">Fonctionnalités des sérialiseurs de documents .NET Framework 3.0</span><span class="sxs-lookup"><span data-stu-id="dfb85-117">Features of .NET Framework 3.0 Document Serializers</span></span>  
  
-   <span data-ttu-id="dfb85-118">L’accès direct aux objets de document de niveau supérieur (arborescence logique et visuels) permet un stockage efficace de contenu paginé, d’éléments 2D/3D, d’images, de fichiers multimédias, de liens hypertexte, d’annotations et autre contenu de support.</span><span class="sxs-lookup"><span data-stu-id="dfb85-118">Direct access to the high-level document objects (logical tree and visuals) enable efficient storage of paginated content, 2D/3D elements, images, media, hyperlinks, annotations, and other support content.</span></span>  
  
-   <span data-ttu-id="dfb85-119">Fonctionnement synchrone et asynchrone.</span><span class="sxs-lookup"><span data-stu-id="dfb85-119">Synchronous and asynchronous operation.</span></span>  
  
-   <span data-ttu-id="dfb85-120">Prise en charge de sérialiseurs de plug-ins avec fonctionnalités améliorées :</span><span class="sxs-lookup"><span data-stu-id="dfb85-120">Support for plug-in serializers with enhanced capabilities:</span></span>  
  
    -   <span data-ttu-id="dfb85-121">Accès à l’échelle du système pour toutes les applications [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)].</span><span class="sxs-lookup"><span data-stu-id="dfb85-121">System-wide access for use by all [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] applications.</span></span>  
  
    -   <span data-ttu-id="dfb85-122">Découvertibilité de plug-ins d’application simplifiée.</span><span class="sxs-lookup"><span data-stu-id="dfb85-122">Simple application plug-in discoverability.</span></span>  
  
    -   <span data-ttu-id="dfb85-123">Déploiement, installation et mise à jour simples pour les plug-ins tiers personnalisés.</span><span class="sxs-lookup"><span data-stu-id="dfb85-123">Simple deployment, installation, and update for custom third-party plug-ins.</span></span>  
  
    -   <span data-ttu-id="dfb85-124">Prise en charge des paramètres et des options d’exécution personnalisés par l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="dfb85-124">User interface support for custom run-time settings and options.</span></span>  
  
### <a name="xps-print-path"></a><span data-ttu-id="dfb85-125">Chemin d'impression XPS</span><span class="sxs-lookup"><span data-stu-id="dfb85-125">XPS Print Path</span></span>  
 <span data-ttu-id="dfb85-126">Le chemin d’impression [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)] [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] fournit également un mécanisme extensible pour l’écriture de documents par l’intermédiaire de la sortie d’impression.</span><span class="sxs-lookup"><span data-stu-id="dfb85-126">The [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)] [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] print path also provides an extensible mechanism for writing documents through print output.</span></span>  [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]<span data-ttu-id="dfb85-127"> fait office à la fois de format de fichier de document et de spool d’impression natif pour [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)].</span><span class="sxs-lookup"><span data-stu-id="dfb85-127"> serves as both a document file format and is the native print spool format for [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)].</span></span>  <span data-ttu-id="dfb85-128">Les documents [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] peuvent être envoyés directement aux imprimantes compatibles [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] sans nécessiter de conversion dans un format intermédiaire.</span><span class="sxs-lookup"><span data-stu-id="dfb85-128">[!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] documents can be sent directly to [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]-compatible printers without the need for conversion to an intermediate format.</span></span>  <span data-ttu-id="dfb85-129">Consultez la rubrique [Vue d’ensemble de l’impression](../../../../docs/framework/wpf/advanced/printing-overview.md) pour obtenir des informations supplémentaires sur les options et les fonctionnalités de chemin d’impression.</span><span class="sxs-lookup"><span data-stu-id="dfb85-129">See the [Printing Overview](../../../../docs/framework/wpf/advanced/printing-overview.md) for additional information on print path output options and capabilities.</span></span>  
  
<a name="PluginSerializers"></a>   
## <a name="plug-in-serializers"></a><span data-ttu-id="dfb85-130">Sérialiseurs de plug-ins</span><span class="sxs-lookup"><span data-stu-id="dfb85-130">Plug-in Serializers</span></span>  
 <span data-ttu-id="dfb85-131">Le <xref:System.Windows.Documents.Serialization> API prennent en charge pour les sérialiseurs de plug-in et des sérialiseurs liés installés séparément de l’application, liez au moment de l’exécution et sont accessibles à l’aide de la <xref:System.Windows.Documents.Serialization.SerializerProvider> mécanisme de découverte.</span><span class="sxs-lookup"><span data-stu-id="dfb85-131">The <xref:System.Windows.Documents.Serialization> APIs provide support for both plug-in serializers and linked serializers that are installed separately from the application, bind at run time, and are accessed by using the <xref:System.Windows.Documents.Serialization.SerializerProvider> discovery mechanism.</span></span>  <span data-ttu-id="dfb85-132">Les sérialiseurs de plug-ins simplifient grandement les déploiements et les utilisations à l’échelle du système.</span><span class="sxs-lookup"><span data-stu-id="dfb85-132">Plug-in serializers offer enhanced benefits for ease of deployment and system-wide use.</span></span>  <span data-ttu-id="dfb85-133">Les sérialiseurs liés peuvent également être implémentés pour les environnements de confiance partielle tels que les [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] dans lesquelles les sérialiseurs de plug-ins ne sont pas accessibles.</span><span class="sxs-lookup"><span data-stu-id="dfb85-133">Linked serializers can also be implemented for partial trust environments such as [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] where plug-in serializers are not accessible.</span></span>  <span data-ttu-id="dfb85-134">Sérialiseurs liés, qui sont basés sur une implémentation dérivée de la <xref:System.Windows.Documents.Serialization.SerializerWriter> classe, sont compilés et liés directement dans l’application.</span><span class="sxs-lookup"><span data-stu-id="dfb85-134">Linked serializers, which are based on a derived implementation of the <xref:System.Windows.Documents.Serialization.SerializerWriter> class, are compiled and linked directly into the application.</span></span>  <span data-ttu-id="dfb85-135">Les sérialiseurs de plug-ins comme les sérialiseurs liés fonctionnent selon des méthodes et des événements publics identiques qui facilitent leur utilisation séparée ou simultanée dans la même application.</span><span class="sxs-lookup"><span data-stu-id="dfb85-135">Both plug-in serializers and linked serializers operate through identical public methods and events which make it easy to use either or both types of serializers in the same application.</span></span>  
  
 <span data-ttu-id="dfb85-136">Les sérialiseurs de plug-ins aident les développeurs d’applications en fournissant une extensibilité aux nouvelles conceptions de stockage et aux nouveaux formats de fichiers sans nécessiter de codage direct pour chaque format potentiel au moment de la génération.</span><span class="sxs-lookup"><span data-stu-id="dfb85-136">Plug-in serializers aid application developers by providing extensibility to new storage designs and file formats without having to code directly for every potential format at build time.</span></span>  <span data-ttu-id="dfb85-137">Ils représentent également un atout pour les développeurs tiers, qui bénéficient ainsi d’un moyen standardisé pour déployer, installer et mettre à jour les plug-ins système accessibles pour les formats de fichiers personnalisés ou propriétaires.</span><span class="sxs-lookup"><span data-stu-id="dfb85-137">Plug-in serializers also benefit third-party developers by providing a standardized means to deploy, install, and update system accessible plug-ins for custom or proprietary file formats.</span></span>  
  
### <a name="using-a-plug-in-serializer"></a><span data-ttu-id="dfb85-138">Utilisation d’un sérialiseur de plug-ins</span><span class="sxs-lookup"><span data-stu-id="dfb85-138">Using a Plug-in Serializer</span></span>  
 <span data-ttu-id="dfb85-139">Les sérialiseurs de plug-ins sont simples à utiliser.</span><span class="sxs-lookup"><span data-stu-id="dfb85-139">Plug-in serializers are simple to use.</span></span>  <span data-ttu-id="dfb85-140">Le <xref:System.Windows.Documents.Serialization.SerializerProvider> classe énumère un <xref:System.Windows.Documents.Serialization.SerializerDescriptor> pour chaque plug-in d’installé sur le système de l’objet.</span><span class="sxs-lookup"><span data-stu-id="dfb85-140">The <xref:System.Windows.Documents.Serialization.SerializerProvider> class enumerates a <xref:System.Windows.Documents.Serialization.SerializerDescriptor> object for each plug-in installed on the system.</span></span>  <span data-ttu-id="dfb85-141">Le <xref:System.Windows.Documents.Serialization.SerializerDescriptor.IsLoadable%2A> propriété filtre les plug-ins installés en fonction de la configuration actuelle et vérifie que le sérialiseur peut être chargé et utilisé par l’application.</span><span class="sxs-lookup"><span data-stu-id="dfb85-141">The <xref:System.Windows.Documents.Serialization.SerializerDescriptor.IsLoadable%2A> property filters the installed plug-ins based on the current configuration and verifies that the serializer can be loaded and used by the application.</span></span>  <span data-ttu-id="dfb85-142">Le <xref:System.Windows.Documents.Serialization.SerializerDescriptor> fournit également d’autres propriétés, telles que <xref:System.Windows.Documents.Serialization.SerializerDescriptor.DisplayName%2A> et <xref:System.Windows.Documents.Serialization.SerializerDescriptor.DefaultFileExtension%2A>, que l’application peut utiliser pour inviter l’utilisateur à sélectionner un sérialiseur pour un format de sortie disponible.</span><span class="sxs-lookup"><span data-stu-id="dfb85-142">The <xref:System.Windows.Documents.Serialization.SerializerDescriptor> also provides other properties, such as <xref:System.Windows.Documents.Serialization.SerializerDescriptor.DisplayName%2A> and <xref:System.Windows.Documents.Serialization.SerializerDescriptor.DefaultFileExtension%2A>, which the application can use to prompt the user in selecting a serializer for an available output format.</span></span>  <span data-ttu-id="dfb85-143">Un sérialiseur de plug-ins par défaut pour le format [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] est fourni avec le [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] et est toujours énuméré.</span><span class="sxs-lookup"><span data-stu-id="dfb85-143">A default plug-in serializer for [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] is provided with [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] and is always enumerated.</span></span>  <span data-ttu-id="dfb85-144">Une fois que l’utilisateur sélectionne un format de sortie, le <xref:System.Windows.Documents.Serialization.SerializerProvider.CreateSerializerWriter%2A> méthode est utilisée pour créer un <xref:System.Windows.Documents.Serialization.SerializerWriter> pour le format spécifique.</span><span class="sxs-lookup"><span data-stu-id="dfb85-144">After the user selects an output format, the <xref:System.Windows.Documents.Serialization.SerializerProvider.CreateSerializerWriter%2A> method is used to create a <xref:System.Windows.Documents.Serialization.SerializerWriter> for the specific format.</span></span>  <span data-ttu-id="dfb85-145">Le <xref:System.Windows.Documents.Serialization.SerializerWriter>.<xref:System.Windows.Documents.Serialization.SerializerWriter.Write%2A> méthode peut ensuite être appelée pour le flux de document dans le magasin de données de sortie.</span><span class="sxs-lookup"><span data-stu-id="dfb85-145">The <xref:System.Windows.Documents.Serialization.SerializerWriter>.<xref:System.Windows.Documents.Serialization.SerializerWriter.Write%2A> method can then be called to output the document stream to the data store.</span></span>  
  
 <span data-ttu-id="dfb85-146">L’exemple suivant illustre une application qui utilise le <xref:System.Windows.Documents.Serialization.SerializerProvider> méthode dans une propriété « PlugInFileFilter ».</span><span class="sxs-lookup"><span data-stu-id="dfb85-146">The following example illustrates an application that uses the <xref:System.Windows.Documents.Serialization.SerializerProvider> method in a "PlugInFileFilter" property.</span></span>  <span data-ttu-id="dfb85-147">PlugInFileFilter énumère les plug-ins installés et génère une chaîne de filtre avec les options de fichiers disponible pour un <xref:Microsoft.Win32.SaveFileDialog>.</span><span class="sxs-lookup"><span data-stu-id="dfb85-147">PlugInFileFilter enumerates the installed plug-ins and builds a filter string with the available file options for a <xref:Microsoft.Win32.SaveFileDialog>.</span></span>  
  
 [!code-csharp[DocumentSerialize#DocSerializeFileFilter](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DocumentSerialize/CSharp/ThumbViewer.cs#docserializefilefilter)]  
  
 <span data-ttu-id="dfb85-148">Une fois un nom de fichier de sortie a été sélectionné par l’utilisateur, l’exemple suivant illustre l’utilisation de la <xref:System.Windows.Documents.Serialization.SerializerProvider.CreateSerializerWriter%2A> méthode pour stocker un document donné dans un format spécifié.</span><span class="sxs-lookup"><span data-stu-id="dfb85-148">After an output file name has been selected by the user, the following example illustrates use of the <xref:System.Windows.Documents.Serialization.SerializerProvider.CreateSerializerWriter%2A> method to store a given document in a specified format.</span></span>  
  
 [!code-csharp[DocumentSerialize#DocSerializePlugIn](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DocumentSerialize/CSharp/ThumbViewer.cs#docserializeplugin)]  
  
<a name="InstallingPluginSerializers"></a>   
### <a name="installing-plug-in-serializers"></a><span data-ttu-id="dfb85-149">Installation de sérialiseurs de plug-ins</span><span class="sxs-lookup"><span data-stu-id="dfb85-149">Installing Plug-in Serializers</span></span>  
 <span data-ttu-id="dfb85-150">La <xref:System.Windows.Documents.Serialization.SerializerProvider> classe fournit l’interface de l’application de niveau supérieur pour l’accès et la découverte du sérialiseur de plug-in.</span><span class="sxs-lookup"><span data-stu-id="dfb85-150">The <xref:System.Windows.Documents.Serialization.SerializerProvider> class supplies the upper-level application interface for plug-in serializer discovery and access.</span></span>  <span data-ttu-id="dfb85-151"><xref:System.Windows.Documents.Serialization.SerializerProvider>localise et fournit à l’application une liste des sérialiseurs qui sont installés et accessible sur le système.</span><span class="sxs-lookup"><span data-stu-id="dfb85-151"><xref:System.Windows.Documents.Serialization.SerializerProvider> locates and provides the application a list of the serializers that are installed and accessible on the system.</span></span>  <span data-ttu-id="dfb85-152">Les caractéristiques des sérialiseurs installés sont définies à l’aide des paramètres du Registre.</span><span class="sxs-lookup"><span data-stu-id="dfb85-152">The specifics of the installed serializers are defined through registry settings.</span></span>  <span data-ttu-id="dfb85-153">Les sérialiseurs de plug-in peuvent être ajoutés au Registre à l’aide de la <xref:System.Windows.Documents.Serialization.SerializerProvider.RegisterSerializer%2A> méthode ; ou si [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] n’est pas encore installé, les plug-in installé script peuvent être directement de l’ensemble du Registre les valeurs lui-même.</span><span class="sxs-lookup"><span data-stu-id="dfb85-153">Plug-in serializers can be added to the registry by using the <xref:System.Windows.Documents.Serialization.SerializerProvider.RegisterSerializer%2A> method; or if [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] is not yet installed, the plug-in installation script can directly set the registry values itself.</span></span>  <span data-ttu-id="dfb85-154">Le <xref:System.Windows.Documents.Serialization.SerializerProvider.UnregisterSerializer%2A> méthode peut être utilisée pour supprimer un agent plug-in, ou les paramètres du Registre peuvent être réinitialisés même par un script de désinstallation.</span><span class="sxs-lookup"><span data-stu-id="dfb85-154">The <xref:System.Windows.Documents.Serialization.SerializerProvider.UnregisterSerializer%2A> method can be used to remove a previously installed plug-in, or the registry settings can be reset similarly by an uninstall script.</span></span>  
  
### <a name="creating-a-plug-in-serializer"></a><span data-ttu-id="dfb85-155">Création d’un sérialiseur de plug-ins</span><span class="sxs-lookup"><span data-stu-id="dfb85-155">Creating a Plug-in Serializer</span></span>  
 <span data-ttu-id="dfb85-156">Les sérialiseurs de plug-ins et les sérialiseurs liés utilisent les mêmes méthodes et événements publics exposés, et sont conçus pour un fonctionnement synchrone ou asynchrone.</span><span class="sxs-lookup"><span data-stu-id="dfb85-156">Both plug-in serializers and linked serializers use the same exposed public methods and events, and similarly can be designed to operate either synchronously or asynchronously.</span></span>  <span data-ttu-id="dfb85-157">La création d’un sérialiseur de plug-ins se déroule généralement en trois étapes principales :</span><span class="sxs-lookup"><span data-stu-id="dfb85-157">There are three basic steps normally followed to create a plug-in serializer:</span></span>  
  
1.  <span data-ttu-id="dfb85-158">La première étape consiste à implémenter et à déboguer le sérialiseur comme sérialiseur lié.</span><span class="sxs-lookup"><span data-stu-id="dfb85-158">Implement and debug the serializer first as a linked serializer.</span></span>  <span data-ttu-id="dfb85-159">Le fait de créer un sérialiseur compilé et lié directement dans une application de test permet d’accéder aux points d’arrêt et autres services de débogage utiles lors du test.</span><span class="sxs-lookup"><span data-stu-id="dfb85-159">Initially creating the serializer compiled and linked directly in a test application provides full access to breakpoints and other debug services helpful for testing.</span></span>  
  
2.  <span data-ttu-id="dfb85-160">Une fois que le sérialiseur est entièrement testé, un <xref:System.Windows.Documents.Serialization.ISerializerFactory> interface est ajouté pour créer un plug-in.</span><span class="sxs-lookup"><span data-stu-id="dfb85-160">After the serializer is fully tested, an <xref:System.Windows.Documents.Serialization.ISerializerFactory> interface is added to create a plug-in.</span></span>  <span data-ttu-id="dfb85-161">Le <xref:System.Windows.Documents.Serialization.ISerializerFactory> interface permet un accès total à tous les [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] les objets qui inclut l’arborescence logique, <xref:System.Windows.UIElement> objets, <xref:System.Windows.Documents.IDocumentPaginatorSource>, et <xref:System.Windows.Media.Visual> éléments.</span><span class="sxs-lookup"><span data-stu-id="dfb85-161">The <xref:System.Windows.Documents.Serialization.ISerializerFactory> interface permits full access to all [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] objects which includes the logical tree, <xref:System.Windows.UIElement> objects, <xref:System.Windows.Documents.IDocumentPaginatorSource>, and <xref:System.Windows.Media.Visual> elements.</span></span>  <span data-ttu-id="dfb85-162">En outre <xref:System.Windows.Documents.Serialization.ISerializerFactory> fournit les mêmes méthodes synchrones et asynchrones et les événements utilisés par les sérialiseurs liés.</span><span class="sxs-lookup"><span data-stu-id="dfb85-162">Additionally <xref:System.Windows.Documents.Serialization.ISerializerFactory> provides the same synchronous and asynchronous methods and events used by linked serializers.</span></span>  <span data-ttu-id="dfb85-163">La sortie des documents volumineux pouvant prendre un certain temps, un fonctionnement asynchrone est recommandé de sorte à maintenir la réactivité de l’intervention de l’utilisateur tout en offrant une option « Annuler » en cas de problème avec le magasin de données.</span><span class="sxs-lookup"><span data-stu-id="dfb85-163">Since large documents can take time to output, asynchronous operations are recommended to maintain responsive user interaction and offer a "Cancel" option if some problem occurs with the data store.</span></span>  
  
3.  <span data-ttu-id="dfb85-164">Une fois le sérialiseur de plug-ins créé, un script d’installation est implémenté pour distribuer et installer (ou désinstaller) le plug-in (voir la section ci-dessus intitulée "[Installation de sérialiseurs de plug-ins](#InstallingPluginSerializers)).</span><span class="sxs-lookup"><span data-stu-id="dfb85-164">After the plug-in serializer is created, an installation script is implemented for distributing and installing (and uninstalling) the plug-in (see above, "[Installing Plug-in Serializers](#InstallingPluginSerializers)").</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="dfb85-165">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="dfb85-165">See Also</span></span>  
 <xref:System.Windows.Documents.Serialization>  
 <xref:System.Windows.Xps.XpsDocumentWriter>  
 <xref:System.Windows.Xps.Packaging.XpsDocument>  
 [<span data-ttu-id="dfb85-166">Documents dans WPF</span><span class="sxs-lookup"><span data-stu-id="dfb85-166">Documents in WPF</span></span>](../../../../docs/framework/wpf/advanced/documents-in-wpf.md)  
 [<span data-ttu-id="dfb85-167">Vue d’ensemble de l’impression</span><span class="sxs-lookup"><span data-stu-id="dfb85-167">Printing Overview</span></span>](../../../../docs/framework/wpf/advanced/printing-overview.md)  
 [<span data-ttu-id="dfb85-168">XPS (XML Paper Specification) : Vue d’ensemble</span><span class="sxs-lookup"><span data-stu-id="dfb85-168">XML Paper Specification: Overview</span></span>](http://go.microsoft.com/fwlink?LinkID=106246)
