---
title: "Procédure pas à pas : hébergement de contenu WPF dans Win32"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
dev_langs: cpp
helpviewer_keywords: hosting WPF content in Win32 window [WPF]
ms.assetid: 38ce284a-4303-46dd-b699-c9365b22a7dc
caps.latest.revision: "24"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: fce70ab1571602fb046d3ccde9e7c014834ae6a0
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/21/2017
---
# <a name="walkthrough-hosting-wpf-content-in-win32"></a><span data-ttu-id="7ddd2-102">Procédure pas à pas : hébergement de contenu WPF dans Win32</span><span class="sxs-lookup"><span data-stu-id="7ddd2-102">Walkthrough: Hosting WPF Content in Win32</span></span>
[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]<span data-ttu-id="7ddd2-103"> propose un environnement de création d'applications élaboré.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-103"> provides a rich environment for creating applications.</span></span> <span data-ttu-id="7ddd2-104">Cependant, si vous avez écrit une bonne partie du code [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)], il est peut-être plus judicieux d'ajouter la fonctionnalité [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] à votre application plutôt que de réécrire le code d'origine.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-104">However, when you have a substantial investment in [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] code, it might be more effective to add [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] functionality to your application rather than rewriting your original code.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="7ddd2-105">fournit un mécanisme simple pour l’hébergement [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu dans un [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] fenêtre.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-105"> provides a straightforward mechanism for hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span>  
  
 <span data-ttu-id="7ddd2-106">Ce didacticiel décrit comment écrire un exemple d’application, [hébergement du contenu dans une fenêtre Win32, exemple](http://go.microsoft.com/fwlink/?LinkID=160004), qui héberge [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu dans un [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] fenêtre.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-106">This tutorial describes how to write a sample application, [Hosting WPF Content in a Win32 Window Sample](http://go.microsoft.com/fwlink/?LinkID=160004), that hosts [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="7ddd2-107">Vous pouvez étendre cet exemple pour héberger n'importe quelle fenêtre [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7ddd2-107">You can extend this sample to host any [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="7ddd2-108">Compte tenu de la présence de code managé et non managé dans l'application, celle-ci est écrite en [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7ddd2-108">Because it involves mixing managed and unmanaged code, the application is written in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span>  
  
 
  
<a name="requirements"></a>   
## <a name="requirements"></a><span data-ttu-id="7ddd2-109">Spécifications</span><span class="sxs-lookup"><span data-stu-id="7ddd2-109">Requirements</span></span>  
 <span data-ttu-id="7ddd2-110">Ce didacticiel suppose que vous avez des connaissances de base en matière de programmation [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] et [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7ddd2-110">This tutorial assumes a basic familiarity with both [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming.</span></span> <span data-ttu-id="7ddd2-111">Pour une introduction à [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] de programmation, consultez [mise en route](../../../../docs/framework/wpf/getting-started/index.md).</span><span class="sxs-lookup"><span data-stu-id="7ddd2-111">For a basic introduction to [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming, see [Getting Started](../../../../docs/framework/wpf/getting-started/index.md).</span></span> <span data-ttu-id="7ddd2-112">Pour obtenir une présentation [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] de programmation, vous devez référencer un des nombreux livres sur l’objet, en particulier *programmation Windows* de Charles Petzold.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-112">For an introduction to [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming, you should reference any of the numerous books on the subject, in particular *Programming Windows* by Charles Petzold.</span></span>  
  
 <span data-ttu-id="7ddd2-113">Étant donné que l’exemple qui accompagne ce didacticiel est implémenté dans [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], ce didacticiel suppose que vous êtes familiarisé avec l’utilisation de [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] au programme le [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] et que vous comprenez de programmation du code managé.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-113">Because the sample that accompanies this tutorial is implemented in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], this tutorial assumes familiarity with the use of [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] to program the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)][!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] plus an understanding of managed code programming.</span></span> <span data-ttu-id="7ddd2-114">Il est également souhaitable de connaître [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], même si cela n'est pas indispensable.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-114">Familiarity with [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] is helpful but not essential.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7ddd2-115">Ce didacticiel comprend plusieurs exemples de code tirés de l'exemple associé.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-115">This tutorial includes a number of code examples from the associated sample.</span></span> <span data-ttu-id="7ddd2-116">Cependant, pour une meilleure lecture, il n'inclut pas la totalité de l'exemple de code.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-116">However, for readability, it does not include the complete sample code.</span></span> <span data-ttu-id="7ddd2-117">Pour l’exemple de code complet, consultez [hébergement du contenu dans une fenêtre Win32, exemple](http://go.microsoft.com/fwlink/?LinkID=160004).</span><span class="sxs-lookup"><span data-stu-id="7ddd2-117">For the complete sample code, see [Hosting WPF Content in a Win32 Window Sample](http://go.microsoft.com/fwlink/?LinkID=160004).</span></span>  
  
<a name="basic_procedure"></a>   
## <a name="the-basic-procedure"></a><span data-ttu-id="7ddd2-118">Procédure de base</span><span class="sxs-lookup"><span data-stu-id="7ddd2-118">The Basic Procedure</span></span>  
 <span data-ttu-id="7ddd2-119">Cette section décrit la procédure de base que vous utilisez pour hôte [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu dans un [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] fenêtre.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-119">This section outlines the basic procedure you use to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="7ddd2-120">Les sections restantes décrivent chaque étape dans les détails.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-120">The remaining sections explain the details of each step.</span></span>  
  
 <span data-ttu-id="7ddd2-121">La clé d’hébergement [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] de contenu sur un [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] fenêtre est la <xref:System.Windows.Interop.HwndSource> classe.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-121">The key to hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content on a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is the <xref:System.Windows.Interop.HwndSource> class.</span></span> <span data-ttu-id="7ddd2-122">Cette classe encapsule le [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu dans un [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] fenêtre, ce qui lui permet d’être incorporées dans votre [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] comme une fenêtre enfant.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-122">This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, allowing it to be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window.</span></span> <span data-ttu-id="7ddd2-123">L'approche suivante combine [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] et [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dans une même application.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-123">The following approach combines the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application.</span></span>  
  
1.  <span data-ttu-id="7ddd2-124">Implémentez votre [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu comme une classe managée.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-124">Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a managed class.</span></span>  
  
2.  <span data-ttu-id="7ddd2-125">Implémentez une application [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] avec [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7ddd2-125">Implement a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application with [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span> <span data-ttu-id="7ddd2-126">Si vous partez d'une application existante et de code [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] non managé, vous pouvez généralement faire en sorte qu'il puisse appeler du code managé en modifiant les paramètres de votre projet de manière à inclure l'indicateur du compilateur `/clr`.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-126">If you are starting with an existing application and unmanaged [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] code, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag.</span></span>  
  
3.  <span data-ttu-id="7ddd2-127">Affectez au modèle de thread un thread unique cloisonné (STA, Single-Threaded Apartment).</span><span class="sxs-lookup"><span data-stu-id="7ddd2-127">Set the threading model to single-threaded apartment (STA).</span></span>  
  
4.  <span data-ttu-id="7ddd2-128">Gérer les [WM_CREATE](http://msdn.microsoft.com/library/ms632619.aspx)notification dans votre procédure de fenêtre, puis effectuez ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="7ddd2-128">Handle the [WM_CREATE](http://msdn.microsoft.com/library/ms632619.aspx)notification in your window procedure and do the following:</span></span>  
  
    1.  <span data-ttu-id="7ddd2-129">Créez un objet <xref:System.Windows.Interop.HwndSource> en faisant de la fenêtre parente son paramètre `parent`.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-129">Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window as its `parent` parameter.</span></span>  
  
    2.  <span data-ttu-id="7ddd2-130">Créez une instance de la classe de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7ddd2-130">Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class.</span></span>  
  
    3.  <span data-ttu-id="7ddd2-131">Assigner une référence à la [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] objet de contenu pour le <xref:System.Windows.Interop.HwndSource.RootVisual%2A> propriété de la <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-131">Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>  
  
    4.  <span data-ttu-id="7ddd2-132">Obtenez le HWND pour le contenu.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-132">Get the HWND for the content.</span></span> <span data-ttu-id="7ddd2-133">La propriété <xref:System.Windows.Interop.HwndSource.Handle%2A> de l'objet <xref:System.Windows.Interop.HwndSource> contient le handle de fenêtre (HWND).</span><span class="sxs-lookup"><span data-stu-id="7ddd2-133">The <xref:System.Windows.Interop.HwndSource.Handle%2A> property of the <xref:System.Windows.Interop.HwndSource> object contains the window handle (HWND).</span></span> <span data-ttu-id="7ddd2-134">Pour obtenir un HWND que vous pouvez utiliser dans la partie non managée de l'application, effectuez un cast de `Handle.ToPointer()` en HWND.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-134">To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND.</span></span>  
  
5.  <span data-ttu-id="7ddd2-135">Implémentez une classe managée qui contient un champ statique pour contenir une référence à votre contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7ddd2-135">Implement a managed class that contains a static field to hold a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="7ddd2-136">Cette classe vous permet d'obtenir une référence au contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] à partir de votre code [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7ddd2-136">This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.</span></span>  
  
6.  <span data-ttu-id="7ddd2-137">Assignez le contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] au champ statique.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-137">Assign the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the static field.</span></span>  
  
7.  <span data-ttu-id="7ddd2-138">Recevoir des notifications à partir de la [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu en attachant un gestionnaire à un ou plusieurs de la [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] événements.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-138">Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events.</span></span>  
  
8.  <span data-ttu-id="7ddd2-139">Communiquez avec le contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] en utilisant la référence que vous avez stockée dans le champ statique pour définir les propriétés, etc.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-139">Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by using the reference that you stored in the static field to set properties, and so on.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7ddd2-140">Vous pouvez également utiliser [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] pour implémenter votre [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-140">You can also use [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] to implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="7ddd2-141">Toutefois, vous devrez le compiler séparément comme une [!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)] et référencer cette [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] à partir de votre application [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7ddd2-141">However, you will have to compile it separately as a [!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)] and reference that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span></span> <span data-ttu-id="7ddd2-142">Le reste de la procédure est similaire à celle présentée ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-142">The remainder of the procedure is similar to that outlined above.</span></span>  
  
<a name="implementing_the_application"></a>   
## <a name="implementing-the-host-application"></a><span data-ttu-id="7ddd2-143">Implémentation de l'application hôte.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-143">Implementing the Host Application</span></span>  
 <span data-ttu-id="7ddd2-144">Cette section décrit comment héberger [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu dans un basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-144">This section describes how to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span></span> <span data-ttu-id="7ddd2-145">Le contenu proprement dit est implémenté dans [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] en tant que classe managée.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-145">The content itself is implemented in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] as a managed class.</span></span> <span data-ttu-id="7ddd2-146">Pour l'essentiel, il s'agit d'une programmation [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] simple.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-146">For the most part, it is straightforward [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming.</span></span> <span data-ttu-id="7ddd2-147">Les principaux aspects de l’implémentation de contenu sont décrits dans [implémentation du contenu WPF](#implementing_the_wpf_page).</span><span class="sxs-lookup"><span data-stu-id="7ddd2-147">The key aspects of the content implementation are discussed in [Implementing the WPF Content](#implementing_the_wpf_page).</span></span>  
  
<a name="autoNestedSectionsOUTLINE1"></a>   
-   [<span data-ttu-id="7ddd2-148">Application de base</span><span class="sxs-lookup"><span data-stu-id="7ddd2-148">The Basic Application</span></span>](#the_basic_application)  
  
-   [<span data-ttu-id="7ddd2-149">Hébergement du contenu WPF</span><span class="sxs-lookup"><span data-stu-id="7ddd2-149">Hosting the WPF Content</span></span>](#hosting_the_wpf_page)  
  
-   [<span data-ttu-id="7ddd2-150">Stockage d’une référence au contenu WPF</span><span class="sxs-lookup"><span data-stu-id="7ddd2-150">Holding a Reference to the WPF Content</span></span>](#holding_a_reference)  
  
-   [<span data-ttu-id="7ddd2-151">Communication avec le contenu WPF</span><span class="sxs-lookup"><span data-stu-id="7ddd2-151">Communicating with the WPF Content</span></span>](#communicating_with_the_page)  
  
<a name="the_basic_application"></a>   
### <a name="the-basic-application"></a><span data-ttu-id="7ddd2-152">Application de base</span><span class="sxs-lookup"><span data-stu-id="7ddd2-152">The Basic Application</span></span>  
 <span data-ttu-id="7ddd2-153">Le point de départ pour l'application hôte est la création d'un modèle [!INCLUDE[TLA#tla_visualstu2005](../../../../includes/tlasharptla-visualstu2005-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7ddd2-153">The starting point for the host application was to create a [!INCLUDE[TLA#tla_visualstu2005](../../../../includes/tlasharptla-visualstu2005-md.md)] template.</span></span>  
  
1.  <span data-ttu-id="7ddd2-154">Ouvrez [!INCLUDE[TLA2#tla_visualstu2005](../../../../includes/tla2sharptla-visualstu2005-md.md)], puis sélectionnez **nouveau projet** à partir de la **fichier** menu.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-154">Open [!INCLUDE[TLA2#tla_visualstu2005](../../../../includes/tla2sharptla-visualstu2005-md.md)], and select **New Project** from the **File** menu.</span></span>  
  
2.  <span data-ttu-id="7ddd2-155">Sélectionnez **Win32** dans la liste des [!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] types de projet.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-155">Select **Win32** from the list of [!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] project types.</span></span> <span data-ttu-id="7ddd2-156">Si votre langue par défaut n’est pas [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)], vous trouverez ces types de projet sous **autres langages**.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-156">If your default language is not [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)], you will find these project types under **Other Languages**.</span></span>  
  
3.  <span data-ttu-id="7ddd2-157">Sélectionnez un **projet Win32** attribuez un nom au projet de modèle, puis cliquez sur **OK** pour lancer le **Assistant Application Win32**.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-157">Select a **Win32 Project** template, assign a name to the project and click **OK** to launch the **Win32 Application Wizard**.</span></span>  
  
4.  <span data-ttu-id="7ddd2-158">Acceptez les paramètres par défaut de l’Assistant, cliquez sur **Terminer** pour démarrer le projet.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-158">Accept the wizard's default settings and click **Finish** to start the project.</span></span>  
  
 <span data-ttu-id="7ddd2-159">Le modèle crée une application [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] de base avec les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="7ddd2-159">The template creates a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application, including:</span></span>  
  
-   <span data-ttu-id="7ddd2-160">un point d'entrée pour l'application ;</span><span class="sxs-lookup"><span data-stu-id="7ddd2-160">An entry point for the application.</span></span>  
  
-   <span data-ttu-id="7ddd2-161">Une fenêtre avec une procédure de fenêtre associée (WndProc)</span><span class="sxs-lookup"><span data-stu-id="7ddd2-161">A window, with an associated window procedure (WndProc).</span></span>  
  
-   <span data-ttu-id="7ddd2-162">Un menu avec **fichier** et **aide** des en-têtes.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-162">A menu with **File** and **Help** headings.</span></span> <span data-ttu-id="7ddd2-163">Le **fichier** menu a un **Exit** élément qui ferme l’application.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-163">The **File** menu has an **Exit** item that closes the application.</span></span> <span data-ttu-id="7ddd2-164">Le **aide** menu a un **sur** élément qui ouvre une boîte de dialogue simple.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-164">The **Help** menu has an **About** item that launches a simple dialog box.</span></span>  
  
 <span data-ttu-id="7ddd2-165">Avant de commencer l’écriture de code pour héberger le [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu, vous devez effectuer deux modifications au modèle de base.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-165">Before you start writing code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, you need to make two modifications to the basic template.</span></span>  
  
 <span data-ttu-id="7ddd2-166">La première consiste à compiler le projet sous forme de code managé.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-166">The first is to compile the project as managed code.</span></span> <span data-ttu-id="7ddd2-167">Par défaut, le projet se compile sous forme de code non managé.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-167">By default, the project compiles as unmanaged code.</span></span> <span data-ttu-id="7ddd2-168">Cependant, comme [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] est implémenté en code managé, le projet doit être compilé en conséquence.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-168">However, because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is implemented in managed code, the project must be compiled accordingly.</span></span>  
  
1.  <span data-ttu-id="7ddd2-169">Cliquez sur le nom du projet dans **l’Explorateur de solutions** et sélectionnez **propriétés** dans le menu contextuel pour lancer le **Pages de propriétés** boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-169">Right-click the project name in **Solution Explorer** and select **Properties** from the context menu to launch the **Property Pages** dialog box.</span></span>  
  
2.  <span data-ttu-id="7ddd2-170">Sélectionnez **propriétés de Configuration** à partir de l’arborescence dans le volet gauche.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-170">Select **Configuration Properties** from the tree view in the left pane.</span></span>  
  
3.  <span data-ttu-id="7ddd2-171">Sélectionnez **Common Language Runtime** prennent en charge à partir de la **projet par défaut est** liste dans le volet droit.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-171">Select **Common Language Runtime** support from the **Project Defaults** list in the right pane.</span></span>  
  
4.  <span data-ttu-id="7ddd2-172">Sélectionnez **prise en charge du Common Language Runtime (/ clr)** dans la zone de liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-172">Select **Common Language Runtime Support (/clr)** from the drop-down list box.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7ddd2-173">L'indicateur de ce compilateur vous permet d'utiliser du code managé dans votre application, mais la compilation de votre code non managé se fera toujours comme avant.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-173">This compiler flag allows you to use managed code in your application, but your unmanaged code will still compile as before.</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="7ddd2-174"> utilise le modèle de thread unique cloisonné (STA).</span><span class="sxs-lookup"><span data-stu-id="7ddd2-174"> uses the single-threaded apartment (STA) threading model.</span></span> <span data-ttu-id="7ddd2-175">Pour pouvoir fonctionner correctement avec le [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] code contenu, vous devez définir les modèle de thread de l’application sur STA en appliquant un attribut au point d’entrée.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-175">In order to work properly with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content code, you must set the application's threading model to STA by applying an attribute to the entry point.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WinMain](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#winmain)]  
  
<a name="hosting_the_wpf_page"></a>   
### <a name="hosting-the-wpf-content"></a><span data-ttu-id="7ddd2-176">Hébergement du contenu WPF</span><span class="sxs-lookup"><span data-stu-id="7ddd2-176">Hosting the WPF Content</span></span>  
 <span data-ttu-id="7ddd2-177">Le [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu est une application d’entrée d’adresse simple.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-177">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is a simple address entry application.</span></span> <span data-ttu-id="7ddd2-178">Elle est constituée de plusieurs contrôles <xref:System.Windows.Controls.TextBox> destinés à recevoir le nom d'utilisateur, l'adresse et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-178">It consists of several <xref:System.Windows.Controls.TextBox> controls to take user name, address, and so on.</span></span> <span data-ttu-id="7ddd2-179">Il existe également deux <xref:System.Windows.Controls.Button> contrôles, **OK** et **Annuler**.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-179">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**.</span></span> <span data-ttu-id="7ddd2-180">Lorsque l’utilisateur clique sur **OK**, du bouton <xref:System.Windows.Controls.Primitives.ButtonBase.Click> Gestionnaire d’événements collecte les données à partir de la <xref:System.Windows.Controls.TextBox> contrôle, il affecte aux propriétés correspondantes et déclenche un événement personnalisé, `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-180">When the user clicks **OK**, the button's <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler collects the data from the <xref:System.Windows.Controls.TextBox> controls, assigns it to corresponding properties, and raises a custom event, `OnButtonClicked`.</span></span> <span data-ttu-id="7ddd2-181">Lorsque l’utilisateur clique sur **Annuler**, le gestionnaire déclenche simplement `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-181">When the user clicks **Cancel**, the handler simply raises `OnButtonClicked`.</span></span> <span data-ttu-id="7ddd2-182">L'objet d'argument d'événement pour `OnButtonClicked` contient un champ booléen qui indique le bouton sur lequel l'utilisateur a cliqué.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-182">The event argument object for `OnButtonClicked` contains a Boolean field that indicates which button was clicked.</span></span>  
  
 <span data-ttu-id="7ddd2-183">Le code pour héberger le [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu est implémenté dans un gestionnaire pour le [WM_CREATE](http://msdn.microsoft.com/library/ms632619.aspx) notification sur la fenêtre hôte.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-183">The code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in a handler for the [WM_CREATE](http://msdn.microsoft.com/library/ms632619.aspx) notification on the host window.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WMCreate](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcreate)]  
  
 <span data-ttu-id="7ddd2-184">Le `GetHwnd` méthode accepte les informations de taille et position ainsi que le parent de handle de fenêtre et retourne le handle de fenêtre de hébergé [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-184">The `GetHwnd` method takes size and position information plus the parent window handle and returns the window handle of the hosted [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7ddd2-185">Vous ne pouvez pas utiliser de directive `#using` pour l'espace de noms `System::Windows::Interop`.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-185">You cannot use a `#using` directive for the `System::Windows::Interop` namespace.</span></span> <span data-ttu-id="7ddd2-186">Cela entraîne une collision de noms entre la structure <xref:System.Windows.Interop.MSG> de cet espace de noms et la structure MSG déclarée dans winuser.h.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-186">Doing so creates a name collision between the <xref:System.Windows.Interop.MSG> structure in that namespace and the MSG structure declared in winuser.h.</span></span> <span data-ttu-id="7ddd2-187">Vous devez à la place utiliser des noms qualifiés complets pour accéder au contenu de cet espace de noms.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-187">You must instead use fully-qualified names to access the contents of that namespace.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#GetHwnd](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#gethwnd)]  
  
 <span data-ttu-id="7ddd2-188">Vous ne pouvez pas héberger les [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu directement dans votre fenêtre d’application.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-188">You cannot host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content directly in your application window.</span></span> <span data-ttu-id="7ddd2-189">Vous devez plutôt commencer par créer un objet <xref:System.Windows.Interop.HwndSource> pour inclure le contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dans un wrapper.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-189">Instead, you first create an <xref:System.Windows.Interop.HwndSource> object to wrap the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="7ddd2-190">Cet objet est essentiellement une fenêtre conçue pour héberger un [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-190">This object is basically a window that is designed to host a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="7ddd2-191">Vous hébergez le <xref:System.Windows.Interop.HwndSource> objet dans la fenêtre parente par sa création en tant qu’enfant d’un [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] fenêtre qui fait partie de votre application.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-191">You host the <xref:System.Windows.Interop.HwndSource> object in the parent window by creating it as a child of a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window that is part of your application.</span></span> <span data-ttu-id="7ddd2-192">Les paramètres de constructeur <xref:System.Windows.Interop.HwndSource> contiennent quasiment les mêmes informations que vous transmettriez à CreateWindow au moment de créer une fenêtre enfant [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7ddd2-192">The <xref:System.Windows.Interop.HwndSource> constructor parameters contain much the same information that you would pass to CreateWindow when you create a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] child window.</span></span>  
  
 <span data-ttu-id="7ddd2-193">Vous créez ensuite une instance de la [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] objet de contenu.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-193">You next create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object.</span></span> <span data-ttu-id="7ddd2-194">Dans ce cas, le contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] est implémenté en tant que classe distincte, `WPFPage`, à l'aide de [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7ddd2-194">In this case, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented as a separate class, `WPFPage`, using [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span> <span data-ttu-id="7ddd2-195">Vous pouvez aussi implémenter le contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] avec [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7ddd2-195">You could also implement the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content with [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="7ddd2-196">Toutefois, pour cela vous devez configurer un projet distinct et générer le [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu comme un [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7ddd2-196">However, to do so you need to set up a separate project and build the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)].</span></span> <span data-ttu-id="7ddd2-197">Vous pouvez ajouter une référence à cette [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] à votre projet et utiliser cette référence pour créer une instance du contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7ddd2-197">You can add a reference to that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] to your project, and use that reference to create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>  
  
 <span data-ttu-id="7ddd2-198">Vous affichez la [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu dans votre fenêtre enfant en assignant une référence à la [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu pour le <xref:System.Windows.Interop.HwndSource.RootVisual%2A> propriété de la <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-198">You display the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in your child window by assigning a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>  
  
 <span data-ttu-id="7ddd2-199">La ligne de code suivante attache un gestionnaire d'événements, `WPFButtonClicked`, à l'événement [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] du contenu `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-199">The next line of code attaches an event handler, `WPFButtonClicked`, to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content `OnButtonClicked` event.</span></span> <span data-ttu-id="7ddd2-200">Ce gestionnaire est appelé lorsque l’utilisateur clique sur le **OK** ou **Annuler** bouton.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-200">This handler is called when the user clicks the **OK** or **Cancel** button.</span></span> <span data-ttu-id="7ddd2-201">Consultez [communicating_with_the_WPF content](#communicating_with_the_page) pour plus d’informations sur ce gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-201">See [communicating_with_the_WPF content](#communicating_with_the_page) for further discussion of this event handler.</span></span>  
  
 <span data-ttu-id="7ddd2-202">La dernière ligne de code présentée retourne le handle de fenêtre (HWND) associé à l'objet <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-202">The final line of code shown returns the window handle (HWND) that is associated with the <xref:System.Windows.Interop.HwndSource> object.</span></span> <span data-ttu-id="7ddd2-203">Vous pouvez utiliser ce handle à partir de votre code [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] pour envoyer des messages à la fenêtre hébergée, même si l'exemple ne le fait pas.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-203">You can use this handle from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code to send messages to the hosted window, although the sample does not do so.</span></span> <span data-ttu-id="7ddd2-204">L'objet <xref:System.Windows.Interop.HwndSource> déclenche un événement chaque fois qu'il reçoit un message.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-204">The <xref:System.Windows.Interop.HwndSource> object raises an event every time it receives a message.</span></span> <span data-ttu-id="7ddd2-205">Pour traiter les messages, appelez la méthode <xref:System.Windows.Interop.HwndSource.AddHook%2A> pour attacher un gestionnaire de messages et traiter ensuite les messages dans ce gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-205">To process the messages, call the <xref:System.Windows.Interop.HwndSource.AddHook%2A> method to attach a message handler and then process the messages in that handler.</span></span>  
  
<a name="holding_a_reference"></a>   
### <a name="holding-a-reference-to-the-wpf-content"></a><span data-ttu-id="7ddd2-206">Stockage d'une référence au contenu WPF</span><span class="sxs-lookup"><span data-stu-id="7ddd2-206">Holding a Reference to the WPF Content</span></span>  
 <span data-ttu-id="7ddd2-207">Pour de nombreuses applications, vous souhaiterez communiquer ultérieurement avec le contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7ddd2-207">For many applications, you will want to communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content later.</span></span> <span data-ttu-id="7ddd2-208">Par exemple, vous pouvez souhaiter modifier les propriétés du contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] ou éventuellement faire en sorte que l'objet <xref:System.Windows.Interop.HwndSource> héberge un contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] différent.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-208">For example, you might want to modify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, or perhaps have the <xref:System.Windows.Interop.HwndSource> object host different [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="7ddd2-209">Pour ce faire, vous avez besoin d'une référence à l'objet <xref:System.Windows.Interop.HwndSource> ou au contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7ddd2-209">To do this, you need a reference to the <xref:System.Windows.Interop.HwndSource> object or the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="7ddd2-210">L'objet <xref:System.Windows.Interop.HwndSource> et son contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] associé restent en mémoire jusqu'à la destruction du handle de fenêtre.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-210">The <xref:System.Windows.Interop.HwndSource> object and its associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content remain in memory until you destroy the window handle.</span></span> <span data-ttu-id="7ddd2-211">Cependant, la variable que vous assignez à l'objet <xref:System.Windows.Interop.HwndSource> sera hors de portée dès que vous retournerez de la procédure de fenêtre.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-211">However, the variable you assign to the <xref:System.Windows.Interop.HwndSource> object will go out of scope as soon as you return from the window procedure.</span></span> <span data-ttu-id="7ddd2-212">La méthode courante employée pour gérer ce problème avec les applications [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] consiste à utiliser une variable statique ou globale.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-212">The customary way to handle this issue with [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications is to use a static or global variable.</span></span> <span data-ttu-id="7ddd2-213">Malheureusement, vous ne pouvez pas assigner un objet managé à ces types de variable.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-213">Unfortunately, you cannot assign a managed object to those types of variables.</span></span> <span data-ttu-id="7ddd2-214">Vous pouvez assigner le handle de fenêtre associé à l'objet <xref:System.Windows.Interop.HwndSource> à une variable globale ou statique, mais cela ne permet pas d'accéder à l'objet proprement dit.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-214">You can assign the window handle associated with <xref:System.Windows.Interop.HwndSource> object to a global or static variable, but that doe not provide access to the object itself.</span></span>  
  
 <span data-ttu-id="7ddd2-215">La solution la plus simple à ce problème consiste à implémenter une classe managée qui contient un jeu de champs statiques pour stocker les références à tous les objets managés auxquels vous devez accéder.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-215">The simplest solution to this issue is to implement a managed class that contains a set of static fields to hold references to any managed objects that you need access to.</span></span> <span data-ttu-id="7ddd2-216">L'exemple utilise la classe `WPFPageHost` pour stocker une référence au contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], plus les valeurs initiales de plusieurs de ses propriétés qui peuvent être modifiées ultérieurement par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-216">The sample uses the `WPFPageHost` class to hold a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, plus the initial values of a number of its properties that might be changed later by the user.</span></span> <span data-ttu-id="7ddd2-217">Cette option est définie dans l'en-tête.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-217">This is defined in the header.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageHost](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.h#wpfpagehost)]  
  
 <span data-ttu-id="7ddd2-218">La dernière partie de la fonction `GetHwnd` assigne des valeurs à ces champs en vue d'une utilisation ultérieure pendant que `myPage` se trouve toujours dans la portée.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-218">The latter part of the `GetHwnd` function assigns values to those fields for later use while `myPage` is still in scope.</span></span>  
  
<a name="communicating_with_the_page"></a>   
### <a name="communicating-with-the-wpf-content"></a><span data-ttu-id="7ddd2-219">Communication avec le contenu WPF</span><span class="sxs-lookup"><span data-stu-id="7ddd2-219">Communicating with the WPF Content</span></span>  
 <span data-ttu-id="7ddd2-220">Il existe deux types de communication avec le contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7ddd2-220">There are two types of communication with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="7ddd2-221">L’application reçoit des informations à partir de la [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] de contenu lorsque l’utilisateur clique sur le **OK** ou **Annuler** boutons.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-221">The application receives information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content when the user clicks the **OK** or **Cancel** buttons.</span></span> <span data-ttu-id="7ddd2-222">L'application possède aussi une [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] qui permet à l'utilisateur de modifier différentes propriétés du contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], telles que la couleur d'arrière-plan ou la taille de police par défaut.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-222">The application also has a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that allows the user to change various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, such as the background color or default font size.</span></span>  
  
 <span data-ttu-id="7ddd2-223">Comme indiqué précédemment, quand l'utilisateur clique sur l'un des boutons, le contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] déclenche un événement `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-223">As mentioned above, when the user clicks either button the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content raises an `OnButtonClicked` event.</span></span> <span data-ttu-id="7ddd2-224">L'application attache un gestionnaire à cet événement pour recevoir ces notifications.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-224">The application attaches a handler to this event to receive these notifications.</span></span> <span data-ttu-id="7ddd2-225">Si le **OK** bouton, le gestionnaire obtient les informations utilisateur de la [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] de contenu et l’affiche dans un jeu de contrôles statiques.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-225">If the **OK** button was clicked, the handler gets the user information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content and displays it in a set of static controls.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFButtonClicked](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wpfbuttonclicked)]  
  
 <span data-ttu-id="7ddd2-226">Le gestionnaire reçoit un objet d'argument d'événement personnalisé du contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], `MyPageEventArgs`.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-226">The handler receives a custom event argument object from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, `MyPageEventArgs`.</span></span> <span data-ttu-id="7ddd2-227">L’objet `IsOK` est définie sur `true` si le **OK** bouton a été activé, et `false` si le **Annuler** bouton a été utilisé.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-227">The object's `IsOK` property is set to `true` if the **OK** button was clicked, and `false` if the **Cancel** button was clicked.</span></span>  
  
 <span data-ttu-id="7ddd2-228">Si le **OK** bouton, le gestionnaire obtient une référence à la [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu à partir de la classe de conteneur.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-228">If the **OK** button was clicked, the handler gets a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from the container class.</span></span> <span data-ttu-id="7ddd2-229">Il recueille ensuite les informations utilisateur détenues par les propriété de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] associées et utilise les contrôles statiques pour afficher les informations dans la fenêtre parente.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-229">It then collects the user information that is held by the associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties and uses the static controls to display the information on the parent window.</span></span> <span data-ttu-id="7ddd2-230">Étant donné que les données de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] se présentent sous la forme d'une chaîne managée, elles doivent être marshalées pour être utilisées par un contrôle [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7ddd2-230">Because the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content data is in the form of a managed string, it has to be marshaled for use by a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] control.</span></span> <span data-ttu-id="7ddd2-231">Si le **Annuler** bouton, le gestionnaire efface les données dans les contrôles statiques.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-231">If the **Cancel** button was clicked, the handler clears the data from the static controls.</span></span>  
  
 <span data-ttu-id="7ddd2-232">L'application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] fournit un ensemble de cases d'option qui permettent à l'utilisateur de modifier la couleur d'arrière-plan du contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], ainsi que plusieurs propriétés liées aux polices.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-232">The application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] provides a set of radio buttons that allow the user to modify the background color of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and several font-related properties.</span></span> <span data-ttu-id="7ddd2-233">L'exemple suivant est un extrait de la procédure de fenêtre (WndProc) de l'application et de son traitement des messages qui définit différentes propriétés sur différents messages, notamment la couleur d'arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-233">The following example is an excerpt from the application's window procedure (WndProc) and its message handling that sets various properties on different messages, including the background color.</span></span> <span data-ttu-id="7ddd2-234">Les autres sont similaires et ne sont pas illustrées.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-234">The others are similar, and are not shown.</span></span> <span data-ttu-id="7ddd2-235">Consultez l'exemple complet pour plus de détails et pour connaître le contexte.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-235">See the complete sample for details and context.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WMCommandToBG](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcommandtobg)]  
  
 <span data-ttu-id="7ddd2-236">Pour définir la couleur d'arrière-plan, obtenez une référence au contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] (`hostedPage`) à partir de `WPFPageHost` et affectez à la propriété de couleur d'arrière-plan la valeur appropriée.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-236">To set the background color, get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (`hostedPage`) from `WPFPageHost` and set the background color property to the appropriate color.</span></span> <span data-ttu-id="7ddd2-237">L'exemple utilise trois options de couleur : la couleur d'origine, du vert clair ou du saumon clair.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-237">The sample uses three color options: the original color, light green, or light salmon.</span></span> <span data-ttu-id="7ddd2-238">La couleur d'arrière-plan d'origine est stockée en tant que champ statique dans la classe `WPFPageHost`.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-238">The original background color is stored as a static field in the `WPFPageHost` class.</span></span> <span data-ttu-id="7ddd2-239">Pour définir les deux autres couleurs, vous devez créer un objet <xref:System.Windows.Media.SolidColorBrush> et transmettre au constructeur une valeur de couleur statique à partir de l'objet <xref:System.Windows.Media.Colors>.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-239">To set the other two, you create a new <xref:System.Windows.Media.SolidColorBrush> object and pass the constructor a static colors value from the <xref:System.Windows.Media.Colors> object.</span></span>  
  
<a name="implementing_the_wpf_page"></a>   
## <a name="implementing-the-wpf-page"></a><span data-ttu-id="7ddd2-240">Implémentation de la page WPF</span><span class="sxs-lookup"><span data-stu-id="7ddd2-240">Implementing the WPF Page</span></span>  
 <span data-ttu-id="7ddd2-241">Vous pouvez héberger et utiliser le [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu sans connaissance de l’implémentation réelle.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-241">You can host and use the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content without any knowledge of the actual implementation.</span></span> <span data-ttu-id="7ddd2-242">Si le [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu avait été conditionné dans une fonction [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)], il aurait pu être construit dans une [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] language.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-242">If the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content had been packaged in a separate [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)], it could have been built in any [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] language.</span></span> <span data-ttu-id="7ddd2-243">Voici une brève procédure pas à pas de l'implémentation [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] utilisée dans l'exemple.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-243">Following is a brief walkthrough of the [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] implementation that is used in the sample.</span></span> <span data-ttu-id="7ddd2-244">Cette section comprend les sous-sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-244">This section contains the following subsections.</span></span>  
  
<a name="autoNestedSectionsOUTLINE2"></a>   
-   [<span data-ttu-id="7ddd2-245">Disposition</span><span class="sxs-lookup"><span data-stu-id="7ddd2-245">Layout</span></span>](#page_layout)  
  
-   [<span data-ttu-id="7ddd2-246">Retour des données à la fenêtre hôte</span><span class="sxs-lookup"><span data-stu-id="7ddd2-246">Returning the Data to the Host Window</span></span>](#returning_data_to_window)  
  
-   [<span data-ttu-id="7ddd2-247">Définition des propriétés WPF</span><span class="sxs-lookup"><span data-stu-id="7ddd2-247">Setting the WPF Properties</span></span>](#set_page_properties)  
  
<a name="page_layout"></a>   
### <a name="layout"></a><span data-ttu-id="7ddd2-248">Disposition</span><span class="sxs-lookup"><span data-stu-id="7ddd2-248">Layout</span></span>  
 <span data-ttu-id="7ddd2-249">Le [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] éléments dans le [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu se composent de cinq <xref:System.Windows.Controls.TextBox> contrôle, associé <xref:System.Windows.Controls.Label> contrôles : nom, adresse, ville, état et Zip.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-249">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content consist of five <xref:System.Windows.Controls.TextBox> controls, with associated <xref:System.Windows.Controls.Label> controls: Name, Address, City, State, and Zip.</span></span> <span data-ttu-id="7ddd2-250">Il existe également deux <xref:System.Windows.Controls.Button> contrôles, **OK** et **Annuler**</span><span class="sxs-lookup"><span data-stu-id="7ddd2-250">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**</span></span>  
  
 <span data-ttu-id="7ddd2-251">Le contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] est implémenté dans la classe `WPFPage`.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-251">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in the `WPFPage` class.</span></span> <span data-ttu-id="7ddd2-252">La disposition est gérée avec un élément de disposition <xref:System.Windows.Controls.Grid>.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-252">Layout is handled with a <xref:System.Windows.Controls.Grid> layout element.</span></span> <span data-ttu-id="7ddd2-253">La classe hérite de <xref:System.Windows.Controls.Grid>, qui en fait effectivement l'élément racine du contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7ddd2-253">The class inherits from <xref:System.Windows.Controls.Grid>, which effectively makes it the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content root element.</span></span>  
  
 <span data-ttu-id="7ddd2-254">Le [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] constructeur contenu prend requis tailles et la hauteur et la largeur de la <xref:System.Windows.Controls.Grid> en conséquence.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-254">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content constructor takes the required width and height, and sizes the <xref:System.Windows.Controls.Grid> accordingly.</span></span> <span data-ttu-id="7ddd2-255">Il définit ensuite la disposition de base en créant un ensemble de <xref:System.Windows.Controls.ColumnDefinition> et <xref:System.Windows.Controls.RowDefinition> objets et en les ajoutant à la <xref:System.Windows.Controls.Grid> objet base <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> et <xref:System.Windows.Controls.Grid.RowDefinitions%2A> collections, respectivement.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-255">It then defines the basic layout by creating a set of <xref:System.Windows.Controls.ColumnDefinition> and <xref:System.Windows.Controls.RowDefinition> objects and adding them to the <xref:System.Windows.Controls.Grid> object base <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> and <xref:System.Windows.Controls.Grid.RowDefinitions%2A> collections, respectively.</span></span> <span data-ttu-id="7ddd2-256">Une grille contenant cinq lignes et sept colonnes est ainsi définie et ses dimensions sont déterminées par le contenu des cellules.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-256">This defines a grid of five rows and seven columns, with the dimensions determined by the contents of the cells.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorToGridDef](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortogriddef)]  
  
 <span data-ttu-id="7ddd2-257">Ensuite, le constructeur ajoute les éléments [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] au <xref:System.Windows.Controls.Grid>.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-257">Next, the constructor adds the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements to the <xref:System.Windows.Controls.Grid>.</span></span> <span data-ttu-id="7ddd2-258">Le premier élément est le texte du titre, qui est un contrôle <xref:System.Windows.Controls.Label> centré dans la première ligne de la grille.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-258">The first element is the title text, which is a <xref:System.Windows.Controls.Label> control that is centered in the first row of the grid.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorTitle](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortitle)]  
  
 <span data-ttu-id="7ddd2-259">La ligne suivante contient le contrôle <xref:System.Windows.Controls.Label> Name (nom) et le contrôle <xref:System.Windows.Controls.TextBox> qui lui est associé.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-259">The next row contains the Name <xref:System.Windows.Controls.Label> control and its associated <xref:System.Windows.Controls.TextBox> control.</span></span> <span data-ttu-id="7ddd2-260">Comme le même code est utilisé pour chaque paire label/textbox, il est placé dans une paire de méthodes privées et est utilisé pour les cinq paires label/textbox.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-260">Because the same code is used for each label/textbox pair, it is placed in a pair of private methods and used for all five label/textbox pairs.</span></span> <span data-ttu-id="7ddd2-261">Les méthodes créent le contrôle approprié et appellent les méthodes statiques <xref:System.Windows.Controls.Grid> et <xref:System.Windows.Controls.Grid.SetColumn%2A> de la classe <xref:System.Windows.Controls.Grid.SetRow%2A> pour placer les contrôles dans la bonne cellule.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-261">The methods create the appropriate control, and call the <xref:System.Windows.Controls.Grid> class static <xref:System.Windows.Controls.Grid.SetColumn%2A> and <xref:System.Windows.Controls.Grid.SetRow%2A> methods to place the controls in the appropriate cell.</span></span> <span data-ttu-id="7ddd2-262">Une fois le contrôle créé, l'exemple appelle la méthode <xref:System.Windows.Controls.UIElementCollection.Add%2A> sur la propriété <xref:System.Windows.Controls.Panel.Children%2A> du <xref:System.Windows.Controls.Grid> pour ajouter le contrôle à la grille.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-262">After the control is created, the sample calls the <xref:System.Windows.Controls.UIElementCollection.Add%2A> method on the <xref:System.Windows.Controls.Panel.Children%2A> property of the <xref:System.Windows.Controls.Grid> to add the control to the grid.</span></span> <span data-ttu-id="7ddd2-263">Le code permettant d'ajouter les paires label/texbox restantes est similaire.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-263">The code to add the remaining label/textbox pairs is similar.</span></span> <span data-ttu-id="7ddd2-264">Consultez l'exemple de code pour plus d'informations.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-264">See the sample code for details.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorName](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorname)]  
  
 <span data-ttu-id="7ddd2-265">Les deux méthodes sont implémentées comme suit :</span><span class="sxs-lookup"><span data-stu-id="7ddd2-265">The implementation of the two methods is as follows:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCreateHelpers](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagecreatehelpers)]  
  
 <span data-ttu-id="7ddd2-266">Enfin, l’exemple ajoute le **OK** et **Annuler** boutons et attache un gestionnaire d’événements pour leurs <xref:System.Windows.Controls.Primitives.ButtonBase.Click> événements.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-266">Finally, the sample adds the **OK** and **Cancel** buttons and attaches an event handler to their <xref:System.Windows.Controls.Primitives.ButtonBase.Click> events.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorButtonsEvents](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorbuttonsevents)]  
  
<a name="returning_data_to_window"></a>   
### <a name="returning-the-data-to-the-host-window"></a><span data-ttu-id="7ddd2-267">Retour des données à la fenêtre hôte</span><span class="sxs-lookup"><span data-stu-id="7ddd2-267">Returning the Data to the Host Window</span></span>  
 <span data-ttu-id="7ddd2-268">Quand l'utilisateur clique sur l'un de ces boutons, l'événement <xref:System.Windows.Controls.Primitives.ButtonBase.Click> correspondant est déclenché.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-268">When either button is clicked, its <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event is raised.</span></span> <span data-ttu-id="7ddd2-269">La fenêtre hôte peut attacher simplement des gestionnaires à ces événements et obtenir directement les données des contrôles <xref:System.Windows.Controls.TextBox>.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-269">The host window could simply attach handlers to these events and get the data directly from the <xref:System.Windows.Controls.TextBox> controls.</span></span> <span data-ttu-id="7ddd2-270">L'exemple utilise une approche un peu moins directe.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-270">The sample uses a somewhat less direct approach.</span></span> <span data-ttu-id="7ddd2-271">Il gère la <xref:System.Windows.Controls.Primitives.ButtonBase.Click> au sein de la [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] de contenu, puis déclenche un événement personnalisé `OnButtonClicked`, pour informer le [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-271">It handles the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> within the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and then raises a custom event `OnButtonClicked`, to notify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="7ddd2-272">Cela permet le [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu pour effectuer une validation des paramètres avant de notifier l’hôte.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-272">This allows the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to do some parameter validation before notifying the host.</span></span> <span data-ttu-id="7ddd2-273">Le gestionnaire obtient le texte des contrôles <xref:System.Windows.Controls.TextBox> et l'assigne aux propriétés publiques, à partir desquelles l'hôte peut extraire les informations.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-273">The handler gets the text from the <xref:System.Windows.Controls.TextBox> controls and assigns it to public properties, from which the host can retrieve the information.</span></span>  
  
 <span data-ttu-id="7ddd2-274">La déclaration event dans WPFPage.h :</span><span class="sxs-lookup"><span data-stu-id="7ddd2-274">The event declaration, in WPFPage.h:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageEventDecl](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpageeventdecl)]  
  
 <span data-ttu-id="7ddd2-275">Le gestionnaire d'événements <xref:System.Windows.Controls.Primitives.ButtonBase.Click> dans WPFPage.cpp :</span><span class="sxs-lookup"><span data-stu-id="7ddd2-275">The <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler, in WPFPage.cpp:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageButtonClicked](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagebuttonclicked)]  
  
<a name="set_page_properties"></a>   
### <a name="setting-the-wpf-properties"></a><span data-ttu-id="7ddd2-276">Définition des propriétés WPF</span><span class="sxs-lookup"><span data-stu-id="7ddd2-276">Setting the WPF Properties</span></span>  
 <span data-ttu-id="7ddd2-277">Le [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] hôte permet à l’utilisateur de modifier plusieurs [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] propriétés du contenu.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-277">The [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] host allows the user to change several [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties.</span></span> <span data-ttu-id="7ddd2-278">Du côté de [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], il suffit de modifier des propriétés.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-278">From the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] side, it is simply a matter of changing the properties.</span></span> <span data-ttu-id="7ddd2-279">L'implémentation dans la classe de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] est plus complexe, car il n'existe aucune propriété globale unique qui contrôle les polices pour tous les contrôles.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-279">The implementation in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class is somewhat more complicated, because there is no single global property that controls the fonts for all controls.</span></span> <span data-ttu-id="7ddd2-280">Au lieu de cela, la propriété appropriée de chaque contrôle est modifiée dans les accesseurs set des propriétés.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-280">Instead, the appropriate property for each control is changed in the properties' set accessors.</span></span> <span data-ttu-id="7ddd2-281">L’exemple suivant montre le code pour le `DefaultFontFamily` propriété.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-281">The following example shows the code for the `DefaultFontFamily` property.</span></span> <span data-ttu-id="7ddd2-282">La définition de la propriété appelle une méthode privée qui, à son tour, définit les propriétés <xref:System.Windows.Controls.Control.FontFamily%2A> de plusieurs contrôles.</span><span class="sxs-lookup"><span data-stu-id="7ddd2-282">Setting the property calls a private method that in turn sets the <xref:System.Windows.Controls.Control.FontFamily%2A> properties for the various controls.</span></span>  
  
 <span data-ttu-id="7ddd2-283">À partir de WPFPage.h :</span><span class="sxs-lookup"><span data-stu-id="7ddd2-283">From WPFPage.h:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageFontFamilyProperty](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpagefontfamilyproperty)]  
  
 <span data-ttu-id="7ddd2-284">À partir de WPFPage.ccp :</span><span class="sxs-lookup"><span data-stu-id="7ddd2-284">From WPFPage.cpp:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageSetFontFamily](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagesetfontfamily)]  
  
## <a name="see-also"></a><span data-ttu-id="7ddd2-285">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="7ddd2-285">See Also</span></span>  
 <xref:System.Windows.Interop.HwndSource>  
 [<span data-ttu-id="7ddd2-286">Interopérabilité WPF et Win32</span><span class="sxs-lookup"><span data-stu-id="7ddd2-286">WPF and Win32 Interoperation</span></span>](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md)
