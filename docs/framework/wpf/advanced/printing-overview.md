---
title: Vue d'ensemble de l'impression
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- print path [WPF], XPS
- printers [WPF], XPSDrv-based
- printing [WPF]
- PrintQueue class PrintServer class [WPF]
- XML Paper Specification (XPS) file format
- XPS (XML Paper Specification) file format
- XPSDrv-based printers
- GDI print path [WPF]
ms.assetid: 0de8ac41-9aa6-413d-a121-7aa6f41539b1
caps.latest.revision: "35"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 91ccf1f98d9e1e2f5784246cf30995b689a0b94b
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/22/2017
---
# <a name="printing-overview"></a><span data-ttu-id="85273-102">Vue d'ensemble de l'impression</span><span class="sxs-lookup"><span data-stu-id="85273-102">Printing Overview</span></span>
<span data-ttu-id="85273-103">Avec [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)], les développeurs d'applications utilisant [!INCLUDE[TLA#tla_wpf](../../../../includes/tlasharptla-wpf-md.md)] disposent d'un nouvel ensemble étoffé d'[!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] d'impression et de gestion du système d'impression.</span><span class="sxs-lookup"><span data-stu-id="85273-103">With [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)], application developers using [!INCLUDE[TLA#tla_wpf](../../../../includes/tlasharptla-wpf-md.md)] have a rich new set of printing and print system management [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)].</span></span> <span data-ttu-id="85273-104">Avec [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)], certaines de ces améliorations du système d'impression sont aussi accessibles aux développeurs créant des applications [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] et à ceux utilisant du code non managé.</span><span class="sxs-lookup"><span data-stu-id="85273-104">With [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)], some of these print system enhancements are also available to developers creating [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] applications and developers using unmanaged code.</span></span> <span data-ttu-id="85273-105">Le nouveau format de fichier [!INCLUDE[TLA#tla_xps](../../../../includes/tlasharptla-xps-md.md)] et le chemin d'impression [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] sont au cœur de cette nouvelle fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="85273-105">At the core of this new functionality is the new [!INCLUDE[TLA#tla_xps](../../../../includes/tlasharptla-xps-md.md)] file format and the [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] print path.</span></span>  
  
 <span data-ttu-id="85273-106">Cette rubrique contient les sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="85273-106">This topic contains the following sections.</span></span>  
  
<a name="introduction_to_XPS"></a>   
## <a name="about-xps"></a><span data-ttu-id="85273-107">À propos de XPS</span><span class="sxs-lookup"><span data-stu-id="85273-107">About XPS</span></span>  
 [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]<span data-ttu-id="85273-108"> est un format de document électronique, un format de fichier de mise en file d'attente (spool) et un langage de description de page.</span><span class="sxs-lookup"><span data-stu-id="85273-108"> is an electronic document format, a spool file format and a page description language.</span></span> <span data-ttu-id="85273-109">Il s'agit d'un format de document ouvert qui utilise [!INCLUDE[TLA#tla_xml](../../../../includes/tlasharptla-xml-md.md)], [!INCLUDE[TLA#tla_opc](../../../../includes/tlasharptla-opc-md.md)] et d'autres normes du secteur pour créer des documents multiplateformes.</span><span class="sxs-lookup"><span data-stu-id="85273-109">It is an open document format that uses [!INCLUDE[TLA#tla_xml](../../../../includes/tlasharptla-xml-md.md)], [!INCLUDE[TLA#tla_opc](../../../../includes/tlasharptla-opc-md.md)], and other industry standards to create cross-platform documents.</span></span> [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]<span data-ttu-id="85273-110"> simplifie le processus par lequel documents numériques sont créés, partagés, imprimés, affichés et archivés.</span><span class="sxs-lookup"><span data-stu-id="85273-110"> simplifies the process by which digital documents are created, shared, printed, viewed, and archived.</span></span> <span data-ttu-id="85273-111">Pour plus d'informations sur [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)], consultez le [site web XPS](http://www.microsoft.com/xps).</span><span class="sxs-lookup"><span data-stu-id="85273-111">For additional information on [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)], see the [XPS Web Site](http://www.microsoft.com/xps).</span></span>  
  
 <span data-ttu-id="85273-112">Plusieurs techniques permettant d'imprimer du contenu [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] en utilisant [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] sont décrites dans [Imprimer par programmation des fichiers XPS](../../../../docs/framework/wpf/advanced/how-to-programmatically-print-xps-files.md).</span><span class="sxs-lookup"><span data-stu-id="85273-112">Several techniques for printing [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] based content using [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] are demonstrated in [Programmatically Print XPS Files](../../../../docs/framework/wpf/advanced/how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="85273-113">Il peut vous être utile de vous reporter à ces exemples pendant l'examen du contenu de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="85273-113">You may find it useful to reference these samples during review of content contained in this topic.</span></span> <span data-ttu-id="85273-114">(Les développeurs de code non managé doivent consultez la documentation relative à la [(fonction) MXDC_ESCAPE](https://msdn.microsoft.com/library/windows/desktop/dd162739.aspx).</span><span class="sxs-lookup"><span data-stu-id="85273-114">(Unmanaged code developers should see documentation for the [MXDC_ESCAPE function](https://msdn.microsoft.com/library/windows/desktop/dd162739.aspx).</span></span> <span data-ttu-id="85273-115">Les développeurs [!INCLUDE[TLA2#tla_winforms#initcap](../../../../includes/tla2sharptla-winformssharpinitcap-md.md)] doivent utiliser l'[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] de l'espace de noms <xref:System.Drawing.Printing> qui ne prend pas en charge le chemin d'impression [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] complet, mais prend en charge un chemin d'impression hybride de GDI vers XPS.</span><span class="sxs-lookup"><span data-stu-id="85273-115">[!INCLUDE[TLA2#tla_winforms#initcap](../../../../includes/tla2sharptla-winformssharpinitcap-md.md)] developers must use the [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] in the <xref:System.Drawing.Printing> namespace which does not support the full [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] print path, but does support a hybrid GDI-to-XPS print path.</span></span> <span data-ttu-id="85273-116">Consultez **Architecture du chemin d'impression** ci-dessous.)</span><span class="sxs-lookup"><span data-stu-id="85273-116">See **Print Path Architecture** below.)</span></span>  
  
<a name="XPS_print_path_intro"></a>   
## <a name="xps-print-path"></a><span data-ttu-id="85273-117">Chemin d'impression XPS</span><span class="sxs-lookup"><span data-stu-id="85273-117">XPS Print Path</span></span>  
 <span data-ttu-id="85273-118">Le chemin d'impression [!INCLUDE[TLA#tla_metro](../../../../includes/tlasharptla-metro-md.md)] est une nouvelle fonctionnalité [!INCLUDE[TLA#tla_mswin](../../../../includes/tlasharptla-mswin-md.md)] qui redéfinit la façon dont l'impression est gérée dans les applications [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85273-118">The [!INCLUDE[TLA#tla_metro](../../../../includes/tlasharptla-metro-md.md)] print path is a new [!INCLUDE[TLA#tla_mswin](../../../../includes/tlasharptla-mswin-md.md)] feature that redefines how printing is handled in [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)] applications.</span></span> <span data-ttu-id="85273-119">Comme [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] peut remplacer un langage de présentation de document (comme RTF), un format de spouleur d'impression (comme WMF) et un langage de description de page (comme PCL ou Postscript), le nouveau chemin d'impression conserve le format [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] de la publication de l'application jusqu'au traitement final dans le pilote ou le périphérique d'impression.</span><span class="sxs-lookup"><span data-stu-id="85273-119">Because [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] can replace a document presentation language (such as RTF), a print spooler format (such as WMF), and a page description language (such as PCL or Postscript); the new print path maintains the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] format from application publication to the final processing in the print driver or device.</span></span>  
  
 <span data-ttu-id="85273-120">Le chemin d'impression [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] repose sur le modèle de pilote d'imprimante [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] (XPSDrv), qui offre aux développeurs plusieurs avantages tels que l'impression [!INCLUDE[TLA#tla_wys](../../../../includes/tlasharptla-wys-md.md)], une meilleure prise en charge de la couleur et des performances d'impression nettement améliorées.</span><span class="sxs-lookup"><span data-stu-id="85273-120">The [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path is built upon the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver model (XPSDrv), which provides several benefits for developers such as [!INCLUDE[TLA#tla_wys](../../../../includes/tlasharptla-wys-md.md)] printing, improved color support, and significantly improved print performance.</span></span> <span data-ttu-id="85273-121">(Pour plus d’informations sur XPSDrv, consultez [Windows Driver Kit (WDK)](https://msdn.microsoft.com/library/windows/hardware/ff557573.aspx).)</span><span class="sxs-lookup"><span data-stu-id="85273-121">(For more on XPSDrv, see the [Windows Driver Development Kit](https://msdn.microsoft.com/library/windows/hardware/ff557573.aspx).)</span></span>  
  
 <span data-ttu-id="85273-122">Le fonctionnement du spouleur d'impression pour les documents [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] est pour l'essentiel le même que dans les versions précédentes de [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85273-122">The operation of the print spooler for [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] documents is essentially the same as in previous versions of [!INCLUDE[TLA2#tla_mswin](../../../../includes/tla2sharptla-mswin-md.md)].</span></span> <span data-ttu-id="85273-123">Cependant, il a été amélioré pour prendre en charge le chemin d'impression [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)], en plus du chemin d'impression existante [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85273-123">However, it has been enhanced to support the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path in addition to the existing [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] print path.</span></span> <span data-ttu-id="85273-124">Le nouveau chemin d'impression utilise un fichier spool [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] en mode natif.</span><span class="sxs-lookup"><span data-stu-id="85273-124">The new print path natively consumes an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] spool file.</span></span> <span data-ttu-id="85273-125">Bien que les pilotes d'imprimantes en mode utilisateur écrits pour les versions antérieures de [!INCLUDE[TLA#tla_mswin](../../../../includes/tlasharptla-mswin-md.md)] continuent de fonctionner, un pilote d'imprimante [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] (XPSDrv) est nécessaire pour pouvoir utiliser le chemin d'impression [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85273-125">While user-mode printer drivers written for previous versions of [!INCLUDE[TLA#tla_mswin](../../../../includes/tlasharptla-mswin-md.md)] will continue to work, an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver (XPSDrv) is required in order to use the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path.</span></span>  
  
 <span data-ttu-id="85273-126">Le chemin d'impression [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] présente des avantages significatifs, à savoir :</span><span class="sxs-lookup"><span data-stu-id="85273-126">The benefits of the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path are significant, and include:</span></span>  
  
-   <span data-ttu-id="85273-127">prise en charge de l'impression [!INCLUDE[TLA2#tla_wys](../../../../includes/tla2sharptla-wys-md.md)] ;</span><span class="sxs-lookup"><span data-stu-id="85273-127">[!INCLUDE[TLA2#tla_wys](../../../../includes/tla2sharptla-wys-md.md)] print support</span></span>  
  
-   <span data-ttu-id="85273-128">prise en charge native de profils de couleurs avancés, qui incluent 32 bits par canal (bpc), CMJN, les couleurs nommées, les encres n et prise en charge native de la transparence et des dégradés ;</span><span class="sxs-lookup"><span data-stu-id="85273-128">Native support of advanced color profiles, which include 32 bits per channel (bpc), CMYK, named-colors, n-inks, and native support of transparency and gradients.</span></span>  
  
-   <span data-ttu-id="85273-129">performances d'impression améliorées pour les applications [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] et [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] ;</span><span class="sxs-lookup"><span data-stu-id="85273-129">Improved print performance for both [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] and [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] based applications.</span></span>  
  
-   <span data-ttu-id="85273-130">format [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] conforme aux normes du secteur.</span><span class="sxs-lookup"><span data-stu-id="85273-130">Industry standard [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] format.</span></span>  
  
 <span data-ttu-id="85273-131">Pour les scénarios d'impression de base, une [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] simple et intuitive est disponible avec un point d'entrée unique pour l'interface utilisateur, la configuration et la soumission de travaux.</span><span class="sxs-lookup"><span data-stu-id="85273-131">For basic print scenarios, a simple and intuitive [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] is available with a single entry point for user interface, configuration and job submission.</span></span> <span data-ttu-id="85273-132">Pour les scénarios avancés, une prise en charge supplémentaire est ajoutée pour la personnalisation de l'[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] (ou pas d'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] du tout), l'impression synchrone ou asynchrone et les fonctions d'impression par lots.</span><span class="sxs-lookup"><span data-stu-id="85273-132">For advanced scenarios, an additional support is added for [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] customization (or no [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] at all), synchronous or asynchronous printing, and batch printing capabilities.</span></span> <span data-ttu-id="85273-133">Les deux options assurent une prise en charge de l'impression en mode confiance totale ou partielle.</span><span class="sxs-lookup"><span data-stu-id="85273-133">Both options provide print support in full or partial trust mode.</span></span>  
  
 [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]<span data-ttu-id="85273-134"> a été conçu dans l'optique d'offrir une extensibilité.</span><span class="sxs-lookup"><span data-stu-id="85273-134"> was designed with extensibility in mind.</span></span> <span data-ttu-id="85273-135">Grâce au framework d’extensibilité, il est possible d’ajouter des fonctionnalités et des fonctions à [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] de façon modulaire.</span><span class="sxs-lookup"><span data-stu-id="85273-135">By using the extensibility framework, features and capabilities can be added to [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] in a modular manner.</span></span> <span data-ttu-id="85273-136">Les fonctionnalités d'extensibilité sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="85273-136">Extensibility features include:</span></span>  
  
-   <span data-ttu-id="85273-137">Schéma d'impression.</span><span class="sxs-lookup"><span data-stu-id="85273-137">Print Schema.</span></span> <span data-ttu-id="85273-138">Le schéma public est mis à jour régulièrement et permet l’extension rapide des fonctions des appareils.</span><span class="sxs-lookup"><span data-stu-id="85273-138">The public schema is updated regularly and enables rapid extension of device capabilities.</span></span> <span data-ttu-id="85273-139">(Consultez **PrintTicket et PrintCapabilities** ci-dessous.)</span><span class="sxs-lookup"><span data-stu-id="85273-139">(See **PrintTicket and PrintCapabilities** below.)</span></span>  
  
-   <span data-ttu-id="85273-140">Pipeline de filtres extensible.</span><span class="sxs-lookup"><span data-stu-id="85273-140">Extensible Filter Pipeline.</span></span> <span data-ttu-id="85273-141">Le pipeline de filtres du pilote d'imprimante [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] (XPSDrv) a été conçu pour permettre l'impression directe et évolutive de documents [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85273-141">The [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver (XPSDrv) filter pipeline was designed to enable both direct and scalable printing of [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] documents.</span></span> <span data-ttu-id="85273-142">(Recherche « XPSDrv » dans le [Windows Driver Kit](https://msdn.microsoft.com/library/windows/hardware/ff557573.aspx).)</span><span class="sxs-lookup"><span data-stu-id="85273-142">(Lookup "XPSDrv" in the [Windows Driver Kit](https://msdn.microsoft.com/library/windows/hardware/ff557573.aspx).)</span></span>  
  
### <a name="print-path-architecture"></a><span data-ttu-id="85273-143">Architecture du chemin d'impression</span><span class="sxs-lookup"><span data-stu-id="85273-143">Print Path Architecture</span></span>  
 <span data-ttu-id="85273-144">Bien que les applications [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] et [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] prennent en charge [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)], les applications [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] et [!INCLUDE[TLA2#tla_winforms](../../../../includes/tla2sharptla-winforms-md.md)] utilisent une conversion [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] à [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] pour créer du contenu au format [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] pour le pilote d'imprimante [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] (XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="85273-144">While both [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] applications support [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)], [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winforms](../../../../includes/tla2sharptla-winforms-md.md)] applications use a [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] to [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] conversion in order to create [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] formatted content for the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver (XPSDrv).</span></span> <span data-ttu-id="85273-145">Ces applications ne sont pas tenues d'utiliser le chemin d'impression [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] et peuvent continuer d'utiliser l'impression [!INCLUDE[TLA#tla_emf](../../../../includes/tlasharptla-emf-md.md)]</span><span class="sxs-lookup"><span data-stu-id="85273-145">These applications are not required to use the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path, and can continue to use [!INCLUDE[TLA#tla_emf](../../../../includes/tlasharptla-emf-md.md)] based printing.</span></span> <span data-ttu-id="85273-146">Toutefois, la plupart des fonctionnalités et améliorations de [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] sont disponibles uniquement pour les applications qui ciblent le chemin d'impression [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85273-146">However, most [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] features and enhancements are only available to applications that target the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path.</span></span>  
  
 <span data-ttu-id="85273-147">Pour permettre aux applications [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] et [!INCLUDE[TLA2#tla_winforms](../../../../includes/tla2sharptla-winforms-md.md)] d'utiliser des imprimantes XPSDrv, le pilote d'imprimante [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] (XPSDrv) prend en charge la conversion du format [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] au format [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85273-147">To enable the use of XPSDrv-based printers by [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winforms](../../../../includes/tla2sharptla-winforms-md.md)] applications, the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver (XPSDrv) supports conversion of [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] to [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] format.</span></span> <span data-ttu-id="85273-148">Le modèle XPSDrv fournit également un convertisseur du format [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] au format [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] pour permettre aux applications [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] d'imprimer des documents [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85273-148">The XPSDrv model also provides a converter for [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] to [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] format so that [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications can print [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] Documents.</span></span> <span data-ttu-id="85273-149">Pour [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications, la conversion de [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] à [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] format est effectuée automatiquement par le <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> et <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> méthodes de la <xref:System.Windows.Xps.XpsDocumentWriter> chaque fois que la file d’attente d’impression cible de l’opération d’écriture n’a pas de classe un pilote XPSDrv.</span><span class="sxs-lookup"><span data-stu-id="85273-149">For [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications, conversion of [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] to [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] format is done automatically by the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class whenever the target print queue of the write operation does not have an XPSDrv driver.</span></span> <span data-ttu-id="85273-150">(Les applications [!INCLUDE[TLA2#tla_winforms#initcap](../../../../includes/tla2sharptla-winformssharpinitcap-md.md)] ne peuvent pas imprimer de documents [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)].)</span><span class="sxs-lookup"><span data-stu-id="85273-150">([!INCLUDE[TLA2#tla_winforms#initcap](../../../../includes/tla2sharptla-winformssharpinitcap-md.md)] applications cannot print [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] Documents.)</span></span>  
  
 <span data-ttu-id="85273-151">L'illustration suivante représente le sous-système d'impression et définit les parties fournies par [!INCLUDE[TLA#tla_ms](../../../../includes/tlasharptla-ms-md.md)] et celles définies par les fournisseurs de matériel et de logiciels.</span><span class="sxs-lookup"><span data-stu-id="85273-151">The following illustration depicts the print subsystem and defines the portions provided by [!INCLUDE[TLA#tla_ms](../../../../includes/tlasharptla-ms-md.md)], and the portions defined by software and hardware vendors.</span></span>  
  
 <span data-ttu-id="85273-152">![Système d’impression XPS](../../../../docs/framework/wpf/advanced/media/xpsprint.PNG "XPSPrint")</span><span class="sxs-lookup"><span data-stu-id="85273-152">![The XPS Print System](../../../../docs/framework/wpf/advanced/media/xpsprint.PNG "XPSPrint")</span></span>  
  
### <a name="basic-xps-printing"></a><span data-ttu-id="85273-153">Impression XPS de base</span><span class="sxs-lookup"><span data-stu-id="85273-153">Basic XPS Printing</span></span>  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="85273-154"> définit une [!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)] de base et avancée.</span><span class="sxs-lookup"><span data-stu-id="85273-154"> defines both a basic and advanced [!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)].</span></span> <span data-ttu-id="85273-155">Pour les applications qui n'exigent pas une personnalisation étendue de l'impression ou un accès à l'ensemble complet de fonctionnalités [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)], la prise en charge de l'impression de base est disponible.</span><span class="sxs-lookup"><span data-stu-id="85273-155">For those applications that do not require extensive print customization or access to the complete [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] feature set, basic print support is available.</span></span> <span data-ttu-id="85273-156">La prise en charge de l'impression de base est exposé via un contrôle de boîte de dialogue d'impression qui nécessite une configuration minime et présente une [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] familière.</span><span class="sxs-lookup"><span data-stu-id="85273-156">Basic print support is exposed through a print dialog control that requires minimal configuration and features a familiar [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="85273-157">De nombreuses fonctionnalités [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] sont disponibles en utilisant ce modèle d'impression simplifié.</span><span class="sxs-lookup"><span data-stu-id="85273-157">Many [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] features are available using this simplified print model.</span></span>  
  
#### <a name="printdialog"></a><span data-ttu-id="85273-158">PrintDialog</span><span class="sxs-lookup"><span data-stu-id="85273-158">PrintDialog</span></span>  
 <span data-ttu-id="85273-159">Le contrôle <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> offre un point d'entrée unique pour l'[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], la configuration et la soumission de travaux [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85273-159">The <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> control provides a single entry point for [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], configuration, and [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] job submission.</span></span> <span data-ttu-id="85273-160">Pour plus d'informations sur l'instanciation et l'utilisation du contrôle, consultez [Appeler une boîte de dialogue d'impression](../../../../docs/framework/wpf/advanced/how-to-invoke-a-print-dialog.md).</span><span class="sxs-lookup"><span data-stu-id="85273-160">For information about how to instantiate and use the control, see [Invoke a Print Dialog](../../../../docs/framework/wpf/advanced/how-to-invoke-a-print-dialog.md).</span></span>  
  
### <a name="advanced-xps-printing"></a><span data-ttu-id="85273-161">Impression XPS avancée</span><span class="sxs-lookup"><span data-stu-id="85273-161">Advanced XPS Printing</span></span>  
 <span data-ttu-id="85273-162">Pour accéder à l'ensemble complet de fonctionnalités [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)], il convient d'utiliser l'[!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] d'impression avancée.</span><span class="sxs-lookup"><span data-stu-id="85273-162">To access the complete set of [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] features, the advanced print [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] must be used.</span></span> <span data-ttu-id="85273-163">Plusieurs [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] pertinentes sont décrites plus en détail ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="85273-163">Several relevant [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] are described in greater detail below.</span></span> <span data-ttu-id="85273-164">Pour une liste complète des [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] d’impression [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)], consultez la <xref:System.Windows.Xps> et <xref:System.Printing> références de l’espace de noms.</span><span class="sxs-lookup"><span data-stu-id="85273-164">For a complete list of [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)], see the <xref:System.Windows.Xps> and <xref:System.Printing> namespace references.</span></span>  
  
#### <a name="printticket-and-printcapabilities"></a><span data-ttu-id="85273-165">PrintTicket et PrintCapabilities</span><span class="sxs-lookup"><span data-stu-id="85273-165">PrintTicket and PrintCapabilities</span></span>  
 <span data-ttu-id="85273-166">Le <xref:System.Printing.PrintTicket> et <xref:System.Printing.PrintCapabilities> classes sont le fondement d’avancées [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="85273-166">The <xref:System.Printing.PrintTicket> and <xref:System.Printing.PrintCapabilities> classes are the foundation of the advanced [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] features.</span></span> <span data-ttu-id="85273-167">Ces deux types d'objets sont des structures [!INCLUDE[TLA#tla_xml](../../../../includes/tlasharptla-xml-md.md)] de fonctionnalités d'impression telles que le classement, l'impression recto verso, l'agrafage, etc. Ces structures sont définies par le schéma d'impression.</span><span class="sxs-lookup"><span data-stu-id="85273-167">Both types of objects are [!INCLUDE[TLA#tla_xml](../../../../includes/tlasharptla-xml-md.md)] formatted structures of print-oriented features such as collation, two-sided printing, stapling, etc. These structures are defined by the print schema.</span></span> <span data-ttu-id="85273-168"><xref:System.Printing.PrintTicket> indique à une imprimante comment traiter un travail d'impression.</span><span class="sxs-lookup"><span data-stu-id="85273-168">A <xref:System.Printing.PrintTicket> instructs a printer how to process a print job.</span></span> <span data-ttu-id="85273-169">La classe <xref:System.Printing.PrintCapabilities> définit les fonctionnalités d'une imprimante.</span><span class="sxs-lookup"><span data-stu-id="85273-169">The <xref:System.Printing.PrintCapabilities> class defines the capabilities of a printer.</span></span> <span data-ttu-id="85273-170">En interrogeant les fonctionnalités d'une imprimante, un <xref:System.Printing.PrintTicket> peut être créé pour tirer pleinement parti des fonctionnalités prises en charge de l'imprimante.</span><span class="sxs-lookup"><span data-stu-id="85273-170">By querying the capabilities of a printer, a <xref:System.Printing.PrintTicket> can be created that takes full advantage of a printer's supported features.</span></span> <span data-ttu-id="85273-171">De la même manière, les fonctionnalités non prises en charge peuvent être évitées.</span><span class="sxs-lookup"><span data-stu-id="85273-171">Similarly, unsupported features can be avoided.</span></span>  
  
 <span data-ttu-id="85273-172">L'exemple suivant montre comment interroger l'élément <xref:System.Printing.PrintCapabilities> d'une imprimante et créer un <xref:System.Printing.PrintTicket> à l'aide de code.</span><span class="sxs-lookup"><span data-stu-id="85273-172">The following example demonstrates how to query the <xref:System.Printing.PrintCapabilities> of a printer and create a <xref:System.Printing.PrintTicket> using code.</span></span>  
  
 [!code-cpp[xpscreate#PrinterCapabilities](../../../../samples/snippets/cpp/VS_Snippets_Wpf/XpsCreate/CPP/XpsCreate.cpp#printercapabilities)]
 [!code-csharp[xpscreate#PrinterCapabilities](../../../../samples/snippets/csharp/VS_Snippets_Wpf/XpsCreate/CSharp/XpsCreate.cs#printercapabilities)]
 [!code-vb[xpscreate#PrinterCapabilities](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/XpsCreate/visualbasic/xpscreate.vb#printercapabilities)]  
  
#### <a name="printserver-and-printqueue"></a><span data-ttu-id="85273-173">PrintServer et PrintQueue</span><span class="sxs-lookup"><span data-stu-id="85273-173">PrintServer and PrintQueue</span></span>  
 <span data-ttu-id="85273-174">La classe <xref:System.Printing.PrintServer> représente un serveur d'impression réseau et la classe <xref:System.Printing.PrintQueue> représente une imprimante et la file d'attente des travaux de sortie qui lui est associée.</span><span class="sxs-lookup"><span data-stu-id="85273-174">The <xref:System.Printing.PrintServer> class represents a network print server and the <xref:System.Printing.PrintQueue> class represents a printer and the output job queue associated with it.</span></span> <span data-ttu-id="85273-175">Ensemble, ces [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] permettent une gestion avancée des travaux d'impression d'un serveur.</span><span class="sxs-lookup"><span data-stu-id="85273-175">Together, these [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] allow advanced management of a server's print jobs.</span></span> <span data-ttu-id="85273-176">Un <xref:System.Printing.PrintServer> ou l'une de ses classes dérivées est utilisé pour gérer un <xref:System.Printing.PrintQueue>.</span><span class="sxs-lookup"><span data-stu-id="85273-176">A <xref:System.Printing.PrintServer>, or one of its derived classes, is used to manage a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="85273-177">La méthode <xref:System.Printing.PrintQueue.AddJob%2A> est utilisée pour insérer un nouveau travail d'impression dans la file d'attente.</span><span class="sxs-lookup"><span data-stu-id="85273-177">The <xref:System.Printing.PrintQueue.AddJob%2A> method is used to insert a new print job into the queue.</span></span>  
  
 <span data-ttu-id="85273-178">L'exemple suivant montre comment créer un <xref:System.Printing.LocalPrintServer> et comment accéder au <xref:System.Printing.PrintQueue> par défaut associé avec du code.</span><span class="sxs-lookup"><span data-stu-id="85273-178">The following example demonstrates how to create a <xref:System.Printing.LocalPrintServer> and access its default <xref:System.Printing.PrintQueue> by using code.</span></span>  
  
 [!code-csharp[xpsprint#PrintQueueSnip](../../../../samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[xpsprint#PrintQueueSnip](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
#### <a name="xpsdocumentwriter"></a><span data-ttu-id="85273-179">XpsDocumentWriter</span><span class="sxs-lookup"><span data-stu-id="85273-179">XpsDocumentWriter</span></span>  
 <span data-ttu-id="85273-180">Un <xref:System.Windows.Xps.XpsDocumentWriter>, avec ses nombreuses méthodes <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> et <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A>, permet d'écrire des documents [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] dans un <xref:System.Printing.PrintQueue>.</span><span class="sxs-lookup"><span data-stu-id="85273-180">An <xref:System.Windows.Xps.XpsDocumentWriter>, with its many the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods, is used to write [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] documents to a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="85273-181">Par exemple, la méthode <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> permet de sortir un document [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] et un <xref:System.Printing.PrintTicket> de manière synchrone.</span><span class="sxs-lookup"><span data-stu-id="85273-181">For example, the <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> method is used to output an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] document and <xref:System.Printing.PrintTicket> synchronously.</span></span> <span data-ttu-id="85273-182">La méthode <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> permet de sortir un document [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] et un <xref:System.Printing.PrintTicket> de manière asynchrone.</span><span class="sxs-lookup"><span data-stu-id="85273-182">The <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> method is used to output an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] document and <xref:System.Printing.PrintTicket> asynchronously.</span></span>  
  
 <span data-ttu-id="85273-183">L'exemple suivant montre comment créer un <xref:System.Windows.Xps.XpsDocumentWriter> avec du code.</span><span class="sxs-lookup"><span data-stu-id="85273-183">The following example demonstrates how to create an <xref:System.Windows.Xps.XpsDocumentWriter> using code.</span></span>  
  
 [!code-csharp[XpsPrint#PrintQueueSnip](../../../../samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[XpsPrint#PrintQueueSnip](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
 <span data-ttu-id="85273-184">Le méthodes <xref:System.Printing.PrintQueue.AddJob%2A> permettent aussi d'imprimer.</span><span class="sxs-lookup"><span data-stu-id="85273-184">The <xref:System.Printing.PrintQueue.AddJob%2A> methods also provide ways to print.</span></span> <span data-ttu-id="85273-185">Consultez [Imprimer des fichiers XPS par programmation](../../../../docs/framework/wpf/advanced/how-to-programmatically-print-xps-files.md).</span><span class="sxs-lookup"><span data-stu-id="85273-185">See [Programmatically Print XPS Files](../../../../docs/framework/wpf/advanced/how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="85273-186">pour plus d'informations.</span><span class="sxs-lookup"><span data-stu-id="85273-186">for details.</span></span>  
  
<a name="GDI_Print_Path_intro"></a>   
## <a name="gdi-print-path"></a><span data-ttu-id="85273-187">Chemin d'impression GDI</span><span class="sxs-lookup"><span data-stu-id="85273-187">GDI Print Path</span></span>  
 <span data-ttu-id="85273-188">Bien que les applications [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] prennent en charge les chemins d'impression [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] en mode natif, les applications [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] et [!INCLUDE[TLA2#tla_winforms](../../../../includes/tla2sharptla-winforms-md.md)] peuvent aussi tirer parti de certaines fonctionnalités [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85273-188">While [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications natively support the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path, [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winforms](../../../../includes/tla2sharptla-winforms-md.md)] applications can also take advantage of some [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] features.</span></span> <span data-ttu-id="85273-189">Le pilote d'imprimante [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] (XPSDrv) peut convertir une sortie [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] au format [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85273-189">The [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver (XPSDrv) can convert [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] based output to [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] format.</span></span> <span data-ttu-id="85273-190">Pour les scénarios avancés, conversion personnalisée du contenu est pris en charge à l’aide de la [Microsoft XPS Document Converter (MXDC)](https://msdn.microsoft.com/library/windows/desktop/ff686803.aspx).</span><span class="sxs-lookup"><span data-stu-id="85273-190">For advanced scenarios, custom conversion of content is supported using the [Microsoft XPS Document Converter (MXDC)](https://msdn.microsoft.com/library/windows/desktop/ff686803.aspx).</span></span> <span data-ttu-id="85273-191">De même, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications génère également à la [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] d’impression en appelant une de la <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> ou <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> méthodes de la <xref:System.Windows.Xps.XpsDocumentWriter> classe et en spécifiant une imprimante en tant que la cible de file d’attente.</span><span class="sxs-lookup"><span data-stu-id="85273-191">Similarly, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications can also output to the [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] print path by calling one of the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> or <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class and designating a non-XpsDrv printer as the target print queue.</span></span>  

<span data-ttu-id="85273-192">Pour les applications qui n'exigent pas la fonctionnalité ou la prise en charge [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)], le chemin d'impression [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] actif reste inchangé.</span><span class="sxs-lookup"><span data-stu-id="85273-192">For applications that do not require [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] functionality or support, the current [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] print path remains unchanged.</span></span>  
  
-   <span data-ttu-id="85273-193">Pour les documents de référence supplémentaires sur le [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] imprimer le chemin d’accès et les différents [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] les options de conversion, consultez [Microsoft XPS Document Converter (MXDC)](https://msdn.microsoft.com/library/windows/desktop/ff686803.aspx) et « XPSDrv » dans le [Windows Driver Kit](https://msdn.microsoft.com/library/windows/hardware/ff557573.aspx).</span><span class="sxs-lookup"><span data-stu-id="85273-193">For additional reference material on the [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] print path and the various [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] conversion options, see [Microsoft XPS Document Converter (MXDC)](https://msdn.microsoft.com/library/windows/desktop/ff686803.aspx) and "XPSDrv" in the [Windows Driver Kit](https://msdn.microsoft.com/library/windows/hardware/ff557573.aspx).</span></span>  
  
<a name="XPS_Driver_Model_intro"></a>   
## <a name="xpsdrv-driver-model"></a><span data-ttu-id="85273-194">Modèle de pilote XPSDrv</span><span class="sxs-lookup"><span data-stu-id="85273-194">XPSDrv Driver Model</span></span>  
 <span data-ttu-id="85273-195">Le chemin d'impression [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] améliore l'efficacité du spouleur en utilisant [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] comme format spool d'impression natif lors de l'impression vers une imprimante ou un pilote [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85273-195">The [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path improves spooler efficiency by using [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] as the native print spool format when printing to an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] -enabled printer or driver.</span></span> <span data-ttu-id="85273-196">Le processus de mise en file d'attente simplifié dispense de la nécessité de générer un fichier spool intermédiaire, tel qu'un fichier de données [!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)] avant que le document soit mis en file d'attente.</span><span class="sxs-lookup"><span data-stu-id="85273-196">The simplified spooling process eliminates the need to generate an intermediate spool file, such as an [!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)] data file, before the document is spooled.</span></span> <span data-ttu-id="85273-197">À la faveur de fichiers spool de plus petite taille, le chemin d'impression [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] peut réduire le trafic réseau et améliorer les performances d'impression.</span><span class="sxs-lookup"><span data-stu-id="85273-197">Through smaller spool file sizes, the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] print path can reduce network traffic and improve print performance.</span></span>  
  
 [!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)]<span data-ttu-id="85273-198"> est un format fermé qui représente la sortie de l'application sous la forme d'une série d'appels dans [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] pour le rendu des services.</span><span class="sxs-lookup"><span data-stu-id="85273-198"> is a closed format that represents application output as a series of calls into [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] for rendering services.</span></span> <span data-ttu-id="85273-199">Contrairement à [!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)], le format de fichier spool [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] représente le document réel sans nécessiter d'interprétation supplémentaire lors de sortie vers un pilote d'imprimante [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] (XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="85273-199">Unlike [!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)], the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] spool format represents the actual document without requiring further interpretation when output to an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)]-based printer driver (XPSDrv).</span></span> <span data-ttu-id="85273-200">Les pilotes peuvent fonctionner directement sur les données dans le format concerné.</span><span class="sxs-lookup"><span data-stu-id="85273-200">The drivers can operate directly on the data in the format.</span></span> <span data-ttu-id="85273-201">Ainsi, il n'est plus utile de procéder aux conversions de données et d'espaces de couleurs qu'impose l'utilisation des fichiers [!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)] et des pilotes d'imprimante [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85273-201">This capability eliminates the data and color space conversions required when you use [!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)] files and [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)]-based print drivers.</span></span>  
  
 <span data-ttu-id="85273-202">Les tailles de fichier de mise en attente sont généralement réduites quand vous utilisez des documents [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] qui ciblent un pilote d'imprimante [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] (XPSDrv) par rapport à leurs équivalents [!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)], mais il existe des exceptions :</span><span class="sxs-lookup"><span data-stu-id="85273-202">Spool file sizes are usually reduced when you use [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] Documents that target an [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] printer driver (XPSDrv) compared with their [!INCLUDE[TLA2#tla_emf](../../../../includes/tla2sharptla-emf-md.md)] equivalents; however, there are exceptions:</span></span>  
  
-   <span data-ttu-id="85273-203">Un graphique vectoriel très complexe, superposé en plusieurs couches ou mal écrit peut être plus grand qu'une version bitmap du même graphique.</span><span class="sxs-lookup"><span data-stu-id="85273-203">A vector graphic that is very complex, multi-layered, or inefficiently written can be larger than a bitmapped version of the same graphic.</span></span>  
  
-   <span data-ttu-id="85273-204">À des fins d'affichage sur écran, les fichiers XPS incorporent des polices de périphérique, ainsi que des polices basées sur ordinateur, alors que les fichiers spool GDI n'incorporent pas de polices de périphérique.</span><span class="sxs-lookup"><span data-stu-id="85273-204">For screen display purposes, XPS files embed device fonts as well as computer-based fonts; whereas GDI spool files do not embed device fonts.</span></span> <span data-ttu-id="85273-205">Mais les deux types de polices sont des sous-ensembles (voir ci-dessous) et les pilotes d'imprimante peuvent supprimer les polices de périphérique avant de transmettre le fichier à l'imprimante.</span><span class="sxs-lookup"><span data-stu-id="85273-205">But both kinds of fonts are subsetted (see below) and printer drivers can remove the device fonts before transmitting the file to the printer.</span></span>  
  
 <span data-ttu-id="85273-206">La réduction de la taille des fichiers spool est exécutée via plusieurs mécanismes :</span><span class="sxs-lookup"><span data-stu-id="85273-206">Spool size reduction is performed through several mechanisms:</span></span>  
  
-   <span data-ttu-id="85273-207">**Création de sous-ensembles de polices** :</span><span class="sxs-lookup"><span data-stu-id="85273-207">**Font subsetting**.</span></span> <span data-ttu-id="85273-208">seuls les caractères utilisés dans le document réel sont stockés dans le fichier [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85273-208">Only characters used within the actual document are stored in the [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] file.</span></span>  
  
-   <span data-ttu-id="85273-209">**Prise en charge avancée des graphiques** :</span><span class="sxs-lookup"><span data-stu-id="85273-209">**Advanced Graphics Support**.</span></span> <span data-ttu-id="85273-210">la prise en charge native des primitives de transparence et de dégradé évite la rastérisation du contenu dans le document [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)].</span><span class="sxs-lookup"><span data-stu-id="85273-210">Native support for transparency and gradient primitives avoids rasterization of content in the [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] Document.</span></span>  
  
-   <span data-ttu-id="85273-211">**Identification des ressources communes** :</span><span class="sxs-lookup"><span data-stu-id="85273-211">**Identification of common resources**.</span></span> <span data-ttu-id="85273-212">les ressources utilisées plusieurs fois (comme une image qui représente un logo d'entreprise) sont traitées comme des ressources partagées et sont chargées une seule fois.</span><span class="sxs-lookup"><span data-stu-id="85273-212">Resources that are used multiple times (such as an image that represents a corporate logo) are treated as shared resources and are loaded only once.</span></span>  
  
-   <span data-ttu-id="85273-213">**Compression ZIP** :</span><span class="sxs-lookup"><span data-stu-id="85273-213">**ZIP compression**.</span></span> <span data-ttu-id="85273-214">tous les documents [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] utilisent la compression ZIP.</span><span class="sxs-lookup"><span data-stu-id="85273-214">All [!INCLUDE[TLA2#tla_metro](../../../../includes/tla2sharptla-metro-md.md)] documents use ZIP compression.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="85273-215">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="85273-215">See Also</span></span>  
 <xref:System.Windows.Controls.PrintDialog>  
 <xref:System.Windows.Xps.XpsDocumentWriter>  
 <xref:System.Windows.Xps.Packaging.XpsDocument>  
 <xref:System.Printing.PrintTicket>  
 <xref:System.Printing.PrintCapabilities>  
 <xref:System.Printing.PrintServer>  
 <xref:System.Printing.PrintQueue>  
 [<span data-ttu-id="85273-216">Rubriques de guide pratique</span><span class="sxs-lookup"><span data-stu-id="85273-216">How-to Topics</span></span>](../../../../docs/framework/wpf/advanced/printing-how-to-topics.md)  
 [<span data-ttu-id="85273-217">Documents dans WPF</span><span class="sxs-lookup"><span data-stu-id="85273-217">Documents in WPF</span></span>](../../../../docs/framework/wpf/advanced/documents-in-wpf.md)  
 [<span data-ttu-id="85273-218">XPS</span><span class="sxs-lookup"><span data-stu-id="85273-218">XPS</span></span>](http://www.microsoft.com/xps)  
 [<span data-ttu-id="85273-219">Sérialisation et stockage de documents</span><span class="sxs-lookup"><span data-stu-id="85273-219">Document Serialization and Storage</span></span>](../../../../docs/framework/wpf/advanced/document-serialization-and-storage.md)  
 [<span data-ttu-id="85273-220">Microsoft XPS Document Converter (MXDC)</span><span class="sxs-lookup"><span data-stu-id="85273-220">Microsoft XPS Document Converter (MXDC)</span></span>](https://msdn.microsoft.com/library/windows/desktop/ff686803.aspx)
