---
title: "Suivi d'activité dans la sécurité de message"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 68862534-3b2e-4270-b097-8121b12a2c97
caps.latest.revision: "7"
author: BrucePerlerMS
ms.author: bruceper
manager: mbaldwin
ms.workload: dotnet
ms.openlocfilehash: db9b05217bbbf91bfc3cd315801b4e511f82d04c
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/22/2017
---
# <a name="activity-tracing-in-message-security"></a><span data-ttu-id="b8ae6-102">Suivi d'activité dans la sécurité de message</span><span class="sxs-lookup"><span data-stu-id="b8ae6-102">Activity Tracing in Message Security</span></span>
<span data-ttu-id="b8ae6-103">Cette rubrique décrit le suivi d'activité pour le traitement de sécurité, qui se produit dans les trois phases suivantes.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-103">This topic describes activity tracing for security processing, which happens in the following three phases.</span></span>  
  
-   <span data-ttu-id="b8ae6-104">Échange de négociation/SCT.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-104">Negotiation/SCT exchange.</span></span> <span data-ttu-id="b8ae6-105">Cela peut se produire au niveau de la couche de transport (via l'échange de données binaires) ou de la couche de message (via les échanges de messages SOAP).</span><span class="sxs-lookup"><span data-stu-id="b8ae6-105">This can happen at the transport later (through binary data exchange) or message layer (through SOAP message exchanges).</span></span>  
  
-   <span data-ttu-id="b8ae6-106">Chiffrement/déchiffrement des messages, avec vérification et authentification de la signature.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-106">Message encryption/decryption, with signature verification and authentication.</span></span> <span data-ttu-id="b8ae6-107">Les suivis apparaissent dans l'activité ambiante, en général l'activité « Action de processus ».</span><span class="sxs-lookup"><span data-stu-id="b8ae6-107">Traces appear in the ambient activity, typically "Process Action."</span></span>  
  
-   <span data-ttu-id="b8ae6-108">Autorisation et vérification.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-108">Authorization and verification.</span></span> <span data-ttu-id="b8ae6-109">Cela peut se produire localement ou lors de la communication entre des points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-109">This can happen locally or when communicating between endpoints.</span></span>  
  
## <a name="negotiationsct-exchange"></a><span data-ttu-id="b8ae6-110">Échange de négociation/SCT</span><span class="sxs-lookup"><span data-stu-id="b8ae6-110">Negotiation/SCT exchange</span></span>  
 <span data-ttu-id="b8ae6-111">Dans la phase d'échange de négociation/SCT, deux types d'activité sont créés sur le client : « Configurer une session sécurisée » et « Fermer une session sécurisée ».</span><span class="sxs-lookup"><span data-stu-id="b8ae6-111">In the negotiation/SCT exchange phase, two activity types are created on the client: "Set up Secure Session" and "Close Secure Session."</span></span> <span data-ttu-id="b8ae6-112">Le type « Configurer une session sécurisée » comprend des suivis pour les échanges de messages RST/RSTR/SCT, tandis que le type « Fermer une session sécurisée » inclut des suivis pour le message Cancel.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-112">"Set up Secure Session" encompasses traces for the RST/RSTR/SCT message exchanges, while "Close Secure Session" includes traces for the Cancel message.</span></span>  
  
 <span data-ttu-id="b8ae6-113">Sur le serveur, chaque demande/réponse pour les échanges RST/RSTR/SCT apparaît dans sa propre activité.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-113">On the server, each request/reply for the RST/RSTR/SCT appears in its own activity.</span></span> <span data-ttu-id="b8ae6-114">Si `propagateActivity` = `true` sur le serveur et le client, les activités sur le serveur ont le même ID et apparaissent ensemble dans le « le programme d’installation Session sécurisée » lorsqu’ils sont affichés avec Service Trace Viewer.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-114">If `propagateActivity`=`true` on both the server and client, activities on the server have the same ID, and appear together in the "Setup Secure Session" when viewed through Service Trace Viewer.</span></span>  
  
 <span data-ttu-id="b8ae6-115">Ce modèle d'activité de suivi est valide pour l'authentification par nom d'utilisateur/mot de passe, l'authentification du certificat et l'authentification NTLM.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-115">This activity tracing model is valid for user name/password authentication, certificate authentication, and NTLM authentication.</span></span>  
  
 <span data-ttu-id="b8ae6-116">Le tableau suivant répertorie les activités et les suivis pour l'échange de négociation/SCT.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-116">The following table lists the activities and traces for negotiation and SCT exchange.</span></span>  
  
||<span data-ttu-id="b8ae6-117">Occurrence de l'échange de négociation/SCT</span><span class="sxs-lookup"><span data-stu-id="b8ae6-117">Time when Negotiation/SCT exchange happens</span></span>|<span data-ttu-id="b8ae6-118">Activités</span><span class="sxs-lookup"><span data-stu-id="b8ae6-118">Activities</span></span>|<span data-ttu-id="b8ae6-119">Suivis</span><span class="sxs-lookup"><span data-stu-id="b8ae6-119">Traces</span></span>|  
|-|-------------------------------------------------|----------------|------------|  
|<span data-ttu-id="b8ae6-120">Transport sécurisé</span><span class="sxs-lookup"><span data-stu-id="b8ae6-120">Secure Transport</span></span><br /><br /> <span data-ttu-id="b8ae6-121">(HTTPS, SSL)</span><span class="sxs-lookup"><span data-stu-id="b8ae6-121">(HTTPS, SSL)</span></span>|<span data-ttu-id="b8ae6-122">À réception du premier message.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-122">On first message received.</span></span>|<span data-ttu-id="b8ae6-123">Les suivis sont émis dans l'activité ambiante.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-123">Traces are emitted in the ambient activity.</span></span>|<span data-ttu-id="b8ae6-124">-Suivis des échanges</span><span class="sxs-lookup"><span data-stu-id="b8ae6-124">-   Exchange traces</span></span><br /><span data-ttu-id="b8ae6-125">-Canal sécurisé établi</span><span class="sxs-lookup"><span data-stu-id="b8ae6-125">-   Secure channel established</span></span><br /><span data-ttu-id="b8ae6-126">-Partager les secrets obtenus.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-126">-   Share secrets obtained.</span></span>|  
|<span data-ttu-id="b8ae6-127">Couche de message sécurisée</span><span class="sxs-lookup"><span data-stu-id="b8ae6-127">Secure Message Layer</span></span><br /><br /> <span data-ttu-id="b8ae6-128">(WSHTTP)</span><span class="sxs-lookup"><span data-stu-id="b8ae6-128">(WSHTTP)</span></span>|<span data-ttu-id="b8ae6-129">À réception du premier message.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-129">On first message received.</span></span>|<span data-ttu-id="b8ae6-130">Sur le client :</span><span class="sxs-lookup"><span data-stu-id="b8ae6-130">On the client:</span></span><br /><br /> <span data-ttu-id="b8ae6-131">-« Le programme d’installation Session sécurisée » depuis « Traiter l’Action » de ce premier message, pour chaque demande/réponse pour RST/RSTR/SCT.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-131">-   "Setup Secure Session" out of "Process Action" of that first message, for each request/reply for RST/RSTR/SCT.</span></span><br /><span data-ttu-id="b8ae6-132">-« Fermer une Session sécurisée », pour l’échange CANCEL, hors de l’activité « fermer le Proxy ».</span><span class="sxs-lookup"><span data-stu-id="b8ae6-132">-   "Close Secure Session" for the CANCEL exchange, out of the "Close Proxy activity."</span></span> <span data-ttu-id="b8ae6-133">Cette activité peut provenir d'une autre activité ambiante, selon le moment où la session sécurisée est fermée.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-133">This activity may happen out of some other ambient activity, depending on when the secure session is closed.</span></span><br /><br /> <span data-ttu-id="b8ae6-134">Sur le serveur :</span><span class="sxs-lookup"><span data-stu-id="b8ae6-134">On the server:</span></span><br /><br /> <span data-ttu-id="b8ae6-135">-Activité « Traiter l’Action » un pour chaque demande/réponse pour RST/SCT/Cancel sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-135">-   One "Process Action" activity for each request/reply for RST/SCT/Cancel on the server.</span></span> <span data-ttu-id="b8ae6-136">Si `propagateActivity` = `true`, les activités RST/RSTR/SCT sont fusionnées avec « Configurer une Session sécurisée » et Cancel est fusionnée avec l’activité « Fermeture » à partir du client.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-136">If `propagateActivity`=`true`, RST/RSTR/SCT activities are merged with "Set up Security Session", and Cancel is merged with the "Close" activity from the client.</span></span><br /><br /> <span data-ttu-id="b8ae6-137">Il y a deux étapes pour « Configurer une session sécurisée » :</span><span class="sxs-lookup"><span data-stu-id="b8ae6-137">There are two stages for "Set up Secure Session":</span></span><br /><br /> <span data-ttu-id="b8ae6-138">1.  Négociation de l'authentification.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-138">1.  Authentication negotiation.</span></span> <span data-ttu-id="b8ae6-139">Facultatif si le client a déjà les informations d'identification qui conviennent.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-139">This is optional if the client already has the proper credentials.</span></span> <span data-ttu-id="b8ae6-140">Cette phase peut être accomplie par un transport sécurisé, ou par des échanges de messages.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-140">This phase can be done through secure transport, or through message exchanges.</span></span> <span data-ttu-id="b8ae6-141">Dans ce dernier cas, 1 ou 2 échanges RST/RSTR peuvent se produire.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-141">In the latter case, 1 or 2 RST/RSTR exchanges can happen.</span></span> <span data-ttu-id="b8ae6-142">Pour ces échanges, les suivis sont émis dans de nouvelles activités de demande/réponse comme prévu.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-142">For these exchanges, traces are emitted in new request/reply activities as previously designed.</span></span><br /><span data-ttu-id="b8ae6-143">2.  Établissement de session sécurisée (SCT), dans laquelle un échange RST/RSTR se produit.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-143">2.  Secure session establishment (SCT), in which one RST/RSTR exchange happens here.</span></span> <span data-ttu-id="b8ae6-144">A les mêmes activités ambiantes que celles décrites précédemment.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-144">This has the same ambient activities as described previously.</span></span>|<span data-ttu-id="b8ae6-145">-Suivis des échanges</span><span class="sxs-lookup"><span data-stu-id="b8ae6-145">-   Exchange traces</span></span><br /><span data-ttu-id="b8ae6-146">-Canal sécurisé établi</span><span class="sxs-lookup"><span data-stu-id="b8ae6-146">-   Secure channel established</span></span><br /><span data-ttu-id="b8ae6-147">-Partager les secrets obtenus.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-147">-   Share secrets obtained.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="b8ae6-148">En mode de sécurité mixte, l'authentification de négociation survient dans les échanges binaires, mais le SCT survient dans l'échange de messages.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-148">In mixed security mode, negotiation authentication happens in binary exchanges, but SCT happens in message exchange.</span></span> <span data-ttu-id="b8ae6-149">En mode de transport pur, la négociation survient uniquement dans le transport sans activités supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-149">In pure transport mode, negotiation happens only in transport with no additional activities.</span></span>  
  
## <a name="message-encryption-and-decryption"></a><span data-ttu-id="b8ae6-150">Chiffrement et déchiffrement des messages</span><span class="sxs-lookup"><span data-stu-id="b8ae6-150">Message Encryption and Decryption</span></span>  
 <span data-ttu-id="b8ae6-151">Le tableau suivant répertorie les activités et les suivis pour le chiffrement/déchiffrement des messages, ainsi que l'authentification de signature.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-151">The following table lists the activities and traces for message encryption/decryption, as well as signature authentication.</span></span>  
  
||<span data-ttu-id="b8ae6-152">Transport sécurisé</span><span class="sxs-lookup"><span data-stu-id="b8ae6-152">Secure Transport</span></span><br /><br /> <span data-ttu-id="b8ae6-153">(HTTPS, SSL) et couche de message sécurisée</span><span class="sxs-lookup"><span data-stu-id="b8ae6-153">(HTTPS, SSL) and Secure Message Layer</span></span><br /><br /> <span data-ttu-id="b8ae6-154">(WSHTTP)</span><span class="sxs-lookup"><span data-stu-id="b8ae6-154">(WSHTTP)</span></span>|  
|-|---------------------------------------------------------------------------------|  
|<span data-ttu-id="b8ae6-155">Heure à laquelle surviennent le chiffrement/déchiffrement des message et l'authentification de la signature.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-155">Time when message encryption/decryption, as well as signature authentication happens</span></span>|<span data-ttu-id="b8ae6-156">À réception du message</span><span class="sxs-lookup"><span data-stu-id="b8ae6-156">On message received</span></span>|  
|<span data-ttu-id="b8ae6-157">Activités</span><span class="sxs-lookup"><span data-stu-id="b8ae6-157">Activities</span></span>|<span data-ttu-id="b8ae6-158">Les suivis sont émis dans l'activité ProcessAction sur le client et le serveur.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-158">Traces are emitted in the ProcessAction activity on the client and server.</span></span>|  
|<span data-ttu-id="b8ae6-159">Suivis</span><span class="sxs-lookup"><span data-stu-id="b8ae6-159">Traces</span></span>|<span data-ttu-id="b8ae6-160">-sendSecurityHeader (expéditeur) :</span><span class="sxs-lookup"><span data-stu-id="b8ae6-160">-   sendSecurityHeader (sender):</span></span><br /><span data-ttu-id="b8ae6-161">-Signer le message</span><span class="sxs-lookup"><span data-stu-id="b8ae6-161">-   Sign message</span></span><br /><span data-ttu-id="b8ae6-162">-Chiffrer les données de la demande</span><span class="sxs-lookup"><span data-stu-id="b8ae6-162">-   Encrypt request data</span></span><br /><span data-ttu-id="b8ae6-163">-receiveSecurityHeader (récepteur) :</span><span class="sxs-lookup"><span data-stu-id="b8ae6-163">-   receiveSecurityHeader (receiver):</span></span><br /><span data-ttu-id="b8ae6-164">-Vérification de signature</span><span class="sxs-lookup"><span data-stu-id="b8ae6-164">-   Verify signature</span></span><br /><span data-ttu-id="b8ae6-165">-Déchiffrer les données de réponse</span><span class="sxs-lookup"><span data-stu-id="b8ae6-165">-   Decrypt response data</span></span><br /><span data-ttu-id="b8ae6-166">-Authentification</span><span class="sxs-lookup"><span data-stu-id="b8ae6-166">-   Authentication</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="b8ae6-167">En mode de transport pur, le chiffrement/déchiffrement des messages se produit uniquement dans le transport sans activités supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-167">In pure transport mode, message encryption/decryption happens only in transport with no additional activities.</span></span>  
  
## <a name="authorization-and-verification"></a><span data-ttu-id="b8ae6-168">Autorisation et vérification</span><span class="sxs-lookup"><span data-stu-id="b8ae6-168">Authorization and Verification</span></span>  
 <span data-ttu-id="b8ae6-169">Le tableau suivant répertorie les activités et les suivis pour l'autorisation.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-169">The following table lists the activities and traces for authorization.</span></span>  
  
||<span data-ttu-id="b8ae6-170">Occurrence de l'autorisation</span><span class="sxs-lookup"><span data-stu-id="b8ae6-170">Time when authorization happens</span></span>|<span data-ttu-id="b8ae6-171">Activités</span><span class="sxs-lookup"><span data-stu-id="b8ae6-171">Activities</span></span>|<span data-ttu-id="b8ae6-172">Suivis</span><span class="sxs-lookup"><span data-stu-id="b8ae6-172">Traces</span></span>|  
|-|-------------------------------------|----------------|------------|  
|<span data-ttu-id="b8ae6-173">Local (valeur par défaut)</span><span class="sxs-lookup"><span data-stu-id="b8ae6-173">Local (default)</span></span>|<span data-ttu-id="b8ae6-174">Après que le message a été déchiffré sur le serveur</span><span class="sxs-lookup"><span data-stu-id="b8ae6-174">After the message is decrypted on the server</span></span>|<span data-ttu-id="b8ae6-175">Les suivis sont émis dans l'activité ProcessAction au niveau du serveur.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-175">Traces are emitted in the ProcessAction activity at the server.</span></span>|<span data-ttu-id="b8ae6-176">Utilisateur autorisé.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-176">User authorized.</span></span>|  
|<span data-ttu-id="b8ae6-177">Remote</span><span class="sxs-lookup"><span data-stu-id="b8ae6-177">Remote</span></span>|<span data-ttu-id="b8ae6-178">Après que le message a été déchiffré sur le serveur</span><span class="sxs-lookup"><span data-stu-id="b8ae6-178">After the message is decrypted on the server</span></span>|<span data-ttu-id="b8ae6-179">Les suivis sont émis dans une nouvelle activité appelée par l'activité ProcessAction.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-179">Traces are emitted in a new activity invoked by the ProcessAction activity.</span></span>|<span data-ttu-id="b8ae6-180">Utilisateur autorisé.</span><span class="sxs-lookup"><span data-stu-id="b8ae6-180">User authorized.</span></span>|
