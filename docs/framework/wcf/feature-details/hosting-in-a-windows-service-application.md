---
title: "Hébergement dans une application de service Windows"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: f4199998-27f3-4dd9-aee4-0a4addfa9f24
caps.latest.revision: "12"
author: Erikre
ms.author: erikre
manager: erikre
ms.openlocfilehash: 07823da6a920a22e35932f32f9320499d9cc84a9
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/21/2017
---
# <a name="hosting-in-a-windows-service-application"></a><span data-ttu-id="4c701-102">Hébergement dans une application de service Windows</span><span class="sxs-lookup"><span data-stu-id="4c701-102">Hosting in a Windows Service Application</span></span>
<span data-ttu-id="4c701-103">Les services Windows (autrefois connus comme services Windows NT) fournissent un modèle de processus particulièrement adapté aux applications qui doivent exister dans un exécutable à durée d’exécution longue et n’affichent aucune forme d’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4c701-103">Windows services (formerly known as Windows NT services) provide a process model particularly suited to applications that must live in a long-running executable and do not display any form of user interface.</span></span> <span data-ttu-id="4c701-104">La durée de vie de processus d'une application de service Windows est gérée par le gestionnaire de contrôle des services (SCM) qui vous autorise à démarrer, arrêter et suspendre les applications de service Windows.</span><span class="sxs-lookup"><span data-stu-id="4c701-104">The process lifetime of a Windows service application is managed by the service control manager (SCM), which allows you to start, stop, and pause Windows service applications.</span></span> <span data-ttu-id="4c701-105">Vous pouvez configurer un processus de service Windows pour démarrer automatiquement au démarrage de l’ordinateur, rendant un environnement d’hébergement approprié pour les applications « always on ».</span><span class="sxs-lookup"><span data-stu-id="4c701-105">You can configure a Windows service process to start automatically when the computer starts, making it a suitable hosting environment for "always on" applications.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="4c701-106">Applications de service Windows, consultez [Applications de Service Windows](http://go.microsoft.com/fwlink/?LinkId=89450).</span><span class="sxs-lookup"><span data-stu-id="4c701-106"> Windows service applications, see [Windows Service Applications](http://go.microsoft.com/fwlink/?LinkId=89450).</span></span>  
  
 <span data-ttu-id="4c701-107">Les applications qui hébergent des services [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] à durée d'exécution longue partagent de nombreuses caractéristiques avec les services Windows.</span><span class="sxs-lookup"><span data-stu-id="4c701-107">Applications that host long-running [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] services share many characteristics with Windows services.</span></span> <span data-ttu-id="4c701-108">Notamment, les services [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] sont des exécutables du serveur à durée d'exécution longue qui n'interagissent pas directement avec l'utilisateur et, par conséquent, n'implémentent aucune forme d'interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4c701-108">In particular, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services are long-running server executables that do not interact directly with the user and therefore do not implement any form of user interface.</span></span> <span data-ttu-id="4c701-109">Par conséquent, l'hébergement de services [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] dans une application de service Windows est l'une des solutions pour construire des applications [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] à durée d'exécution longue solides.</span><span class="sxs-lookup"><span data-stu-id="4c701-109">As such, hosting [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services inside of a Windows service application is one option for building robust, long-running, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] applications.</span></span>  
  
 <span data-ttu-id="4c701-110">Souvent, les développeurs de [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] doivent décider s'il faut héberger leur application [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] dans une application de service Windows, dans les services IIS (Internet Information Services) ou bien dans l'environnement d'hébergement du service d'activation des processus Windows (WAS).</span><span class="sxs-lookup"><span data-stu-id="4c701-110">Often, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] developers must decide whether to host their [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] application inside of a Windows service application or inside of the Internet Information Services (IIS) or Windows Process Activation Service (WAS) hosting environment.</span></span> <span data-ttu-id="4c701-111">Vous pouvez envisager d'utiliser des applications de service Windows dans les conditions suivantes :</span><span class="sxs-lookup"><span data-stu-id="4c701-111">You should consider using Windows service applications under the following conditions:</span></span>  
  
-   <span data-ttu-id="4c701-112">Votre application requiert l'activation explicite.</span><span class="sxs-lookup"><span data-stu-id="4c701-112">Your application requires explicit activation.</span></span> <span data-ttu-id="4c701-113">Par exemple, vous devez utiliser des services Windows lorsque votre application doit démarrer automatiquement quand le serveur démarre au lieu d'être démarrée dynamiquement en réponse au premier message entrant.</span><span class="sxs-lookup"><span data-stu-id="4c701-113">For example, you should use Windows services when your application must start automatically when the server starts instead of being dynamically started in response to the first incoming message.</span></span>  
  
-   <span data-ttu-id="4c701-114">Le processus qui héberge votre application doit rester actif une fois démarré.</span><span class="sxs-lookup"><span data-stu-id="4c701-114">The process that hosts your application must remain running once started.</span></span> <span data-ttu-id="4c701-115">Une fois démarré, un processus de service Windows reste actif à moins qu'il ne soit explicitement interrompu par l'administrateur du serveur via le gestionnaire de contrôle des services.</span><span class="sxs-lookup"><span data-stu-id="4c701-115">Once started, a Windows service process remains running unless explicitly shut down by a server administrator using the service control manager.</span></span> <span data-ttu-id="4c701-116">Les applications hébergées dans IIS ou WAS peuvent être démarrées et arrêtées dynamiquement pour une utilisation optimale des ressources système.</span><span class="sxs-lookup"><span data-stu-id="4c701-116">Applications hosted in IIS or WAS may be started and stopped dynamically to make optimal use of system resources.</span></span> <span data-ttu-id="4c701-117">Les applications qui requièrent un contrôle explicite sur la durée de vie de leur processus d'hébergement doivent utiliser des services Windows au lieu d'IIS ou WAS.</span><span class="sxs-lookup"><span data-stu-id="4c701-117">Applications that require explicit control over the lifetime of their hosting process should use Windows services instead of IIS or WAS.</span></span>  
  
-   <span data-ttu-id="4c701-118">Votre service [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] doit s'exécuter sous Windows Server 2003 et utiliser des transports autres que HTTP.</span><span class="sxs-lookup"><span data-stu-id="4c701-118">Your [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service must run on Windows Server 2003 and use transports other than HTTP.</span></span> <span data-ttu-id="4c701-119">Sous Windows Server 2003, l'environnement d'hébergement [!INCLUDE[iis601](../../../../includes/iis601-md.md)] est restreint uniquement à la communication HTTP.</span><span class="sxs-lookup"><span data-stu-id="4c701-119">On Windows Server 2003, the [!INCLUDE[iis601](../../../../includes/iis601-md.md)] hosting environment is restricted to HTTP communication only.</span></span> <span data-ttu-id="4c701-120">Les applications de service Windows ne sont pas soumises à cette restriction et peuvent utiliser tous les supports [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] de transport, y compris net.tcp, net.pipe et net.msmq.</span><span class="sxs-lookup"><span data-stu-id="4c701-120">Windows service applications are not subject to this restriction and can use any transport [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] supports, including net.tcp, net.pipe, and net.msmq.</span></span>  
  
### <a name="to-host-wcf-inside-of-a-windows-service-application"></a><span data-ttu-id="4c701-121">Pour héberger WCF dans une application de service Windows</span><span class="sxs-lookup"><span data-stu-id="4c701-121">To host WCF inside of a Windows service application</span></span>  
  
1.  <span data-ttu-id="4c701-122">Créez une application de service Windows.</span><span class="sxs-lookup"><span data-stu-id="4c701-122">Create a Windows service application.</span></span> <span data-ttu-id="4c701-123">Vous pouvez écrire des applications de service Windows en code managé à l'aide des classes dans l'espace de noms <xref:System.ServiceProcess>.</span><span class="sxs-lookup"><span data-stu-id="4c701-123">You can write Windows service applications in managed code using the classes in the <xref:System.ServiceProcess> namespace.</span></span> <span data-ttu-id="4c701-124">Cette application doit inclure une classe qui hérite de <xref:System.ServiceProcess.ServiceBase>.</span><span class="sxs-lookup"><span data-stu-id="4c701-124">This application must include one class that inherits from <xref:System.ServiceProcess.ServiceBase>.</span></span>  
  
2.  <span data-ttu-id="4c701-125">Liez la durée de vie des services [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] à la durée de vie de l'application de service Windows.</span><span class="sxs-lookup"><span data-stu-id="4c701-125">Link the lifetime of the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services to the lifetime of the Windows service application.</span></span> <span data-ttu-id="4c701-126">En général, vous souhaitez que les services [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] hébergés dans une application de service Windows deviennent actifs lorsque le service d'hébergement démarre, cessent d'écouter les messages lorsque le service d'hébergement est arrêté et interrompent le processus d'hébergement lorsque le service [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] rencontre une erreur.</span><span class="sxs-lookup"><span data-stu-id="4c701-126">Typically, you want [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services hosted in a Windows service application to become active when the hosting service starts, stop listening for messages when the hosting service is stopped, and shut down the hosting process when the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service encounters an error.</span></span> <span data-ttu-id="4c701-127">Cela peut être accompli de la façon suivante :</span><span class="sxs-lookup"><span data-stu-id="4c701-127">This can be accomplished as follows:</span></span>  
  
    -   <span data-ttu-id="4c701-128">Remplacez <xref:System.ServiceProcess.ServiceBase.OnStart%28System.String%5B%5D%29> pour ouvrir une ou plusieurs instances de <xref:System.ServiceModel.ServiceHost>.</span><span class="sxs-lookup"><span data-stu-id="4c701-128">Override <xref:System.ServiceProcess.ServiceBase.OnStart%28System.String%5B%5D%29> to open one or more instances of <xref:System.ServiceModel.ServiceHost>.</span></span> <span data-ttu-id="4c701-129">Une application de service Windows unique peut héberger plusieurs services [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] qui démarrent et s'arrêtent en tant que groupe.</span><span class="sxs-lookup"><span data-stu-id="4c701-129">A single Windows service application can host multiple [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services that start and stop as a group.</span></span>  
  
    -   <span data-ttu-id="4c701-130">Remplacez <xref:System.ServiceProcess.ServiceBase.OnStop%2A> pour appeler <xref:System.ServiceModel.Channels.CommunicationObject.Closed> sur <xref:System.ServiceModel.ServiceHost> tout service [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] actif démarré pendant <xref:System.ServiceProcess.ServiceBase.OnStart%28System.String%5B%5D%29>.</span><span class="sxs-lookup"><span data-stu-id="4c701-130">Override <xref:System.ServiceProcess.ServiceBase.OnStop%2A> to call <xref:System.ServiceModel.Channels.CommunicationObject.Closed> on the <xref:System.ServiceModel.ServiceHost> any running [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services that were started during <xref:System.ServiceProcess.ServiceBase.OnStart%28System.String%5B%5D%29>.</span></span>  
  
    -   <span data-ttu-id="4c701-131">Abonnez-vous à l'événement <xref:System.ServiceModel.Channels.CommunicationObject.Faulted> de <xref:System.ServiceModel.ServiceHost> et utilisez la classe <xref:System.ServiceProcess.ServiceController> pour interrompre l'application de service Windows en cas d'erreur.</span><span class="sxs-lookup"><span data-stu-id="4c701-131">Subscribe to the <xref:System.ServiceModel.Channels.CommunicationObject.Faulted> event of <xref:System.ServiceModel.ServiceHost> and use the <xref:System.ServiceProcess.ServiceController> class to shut down the Windows service application in case of error.</span></span>  
  
     <span data-ttu-id="4c701-132">Les applications de service Windows qui hébergent les services [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] sont déployées et gérées de la même façon que les applications de service Windows qui n'utilisent pas [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4c701-132">Windows service applications that host [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services are deployed and managed in the same way as Windows service applications that do not make use of [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4c701-133">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="4c701-133">See Also</span></span>  
 <xref:System.ServiceProcess>  
 [<span data-ttu-id="4c701-134">Procédure pas à pas : Création d’une Application de Service Windows dans le Concepteur de composants</span><span class="sxs-lookup"><span data-stu-id="4c701-134">Walkthrough: Creating a Windows Service Application in the Component Designer</span></span>](http://go.microsoft.com/fwlink/?LinkId=94875)  
 [<span data-ttu-id="4c701-135">Comment : héberger un Service WCF dans un Service Windows managé</span><span class="sxs-lookup"><span data-stu-id="4c701-135">How to: Host a WCF Service in a Managed Windows Service</span></span>](../../../../docs/framework/wcf/feature-details/how-to-host-a-wcf-service-in-a-managed-windows-service.md)  
 [<span data-ttu-id="4c701-136">Hôte de Service Windows</span><span class="sxs-lookup"><span data-stu-id="4c701-136">Windows Service Host</span></span>](../../../../docs/framework/wcf/samples/windows-service-host.md)  
 [<span data-ttu-id="4c701-137">Architecture de programmation d’Application Service</span><span class="sxs-lookup"><span data-stu-id="4c701-137">Service Application Programming Architecture</span></span>](http://go.microsoft.com/fwlink/?LinkId=94876)  
 [<span data-ttu-id="4c701-138">Fonctionnalités d’hébergement de Windows Server App Fabric</span><span class="sxs-lookup"><span data-stu-id="4c701-138">Windows Server App Fabric Hosting Features</span></span>](http://go.microsoft.com/fwlink/?LinkId=201276)
