---
title: "Vue d'ensemble de l'intégration à des applications COM+"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- Windows Communication Foundation, COM+ integration
- WCF, COM+ integration
ms.assetid: e481e48f-7096-40eb-9f20-7f0098412941
caps.latest.revision: "29"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 04de29891bcf5d8cdbac32ffc85d64a4003e3184
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/02/2017
---
# <a name="integrating-with-com-applications-overview"></a><span data-ttu-id="86a58-102">Vue d'ensemble de l'intégration à des applications COM+</span><span class="sxs-lookup"><span data-stu-id="86a58-102">Integrating with COM+ Applications Overview</span></span>
[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]<span data-ttu-id="86a58-103"> fournit un environnement riche permettant de créer des applications distribuées.</span><span class="sxs-lookup"><span data-stu-id="86a58-103"> provides a rich environment for creating distributed applications.</span></span> <span data-ttu-id="86a58-104">Si vous vous servez déjà d'une logique d'application à base de composants hébergée dans COM+, vous pouvez utiliser [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] pour étendre votre logique existante plutôt que devoir la réécrire.</span><span class="sxs-lookup"><span data-stu-id="86a58-104">If you are already using component-based application logic hosted in COM+, you can use [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] to extend your existing logic rather than having to rewrite it.</span></span> <span data-ttu-id="86a58-105">Un scénario courant consiste à exposer une logique métier COM+ ou Enterprise Services existante par le biais de services Web.</span><span class="sxs-lookup"><span data-stu-id="86a58-105">A common scenario is when you want to expose existing COM+ or Enterprise Services business logic through Web Services.</span></span>  
  
 <span data-ttu-id="86a58-106">Lorsqu'une interface sur un composant COM+ est exposée comme service Web, la spécification et le contrat de ces services sont déterminés par un mappage automatique exécuté au moment de l'initialisation de l'application.</span><span class="sxs-lookup"><span data-stu-id="86a58-106">When an interface on a COM+ component is exposed as a Web service, the specification and contract of these services are determined by an automatic mapping that is performed at application initialization time.</span></span> <span data-ttu-id="86a58-107">La liste suivante présente le modèle conceptuel de ce mappage :</span><span class="sxs-lookup"><span data-stu-id="86a58-107">The following list shows the conceptual model for this mapping:</span></span>  
  
-   <span data-ttu-id="86a58-108">Un service est défini pour chaque classe COM exposée.</span><span class="sxs-lookup"><span data-stu-id="86a58-108">One service is defined for each exposed COM class.</span></span>  
  
-   <span data-ttu-id="86a58-109">Le contrat du service est directement dérivé de la définition d'interface du composant sélectionné avec la possibilité d'exclusion de méthode définie dans la configuration.</span><span class="sxs-lookup"><span data-stu-id="86a58-109">The contract for the service is derived directly from the selected component's interface definition with the possibility of method exclusion defined in configuration.</span></span>  
  
-   <span data-ttu-id="86a58-110">Les opérations figurant dans ce contrat sont directement dérivées des méthodes sur la définition d'interface du composant.</span><span class="sxs-lookup"><span data-stu-id="86a58-110">The operations in that contract are derived directly from the methods on the component's interface definition.</span></span>  
  
-   <span data-ttu-id="86a58-111">Les paramètres de ces opérations sont directement dérivés du type d'interopérabilité COM qui correspond aux paramètres de méthode du composant.</span><span class="sxs-lookup"><span data-stu-id="86a58-111">The parameters for those operations are derived directly from the COM interoperability type that corresponds to the component's method parameters.</span></span>  
  
 <span data-ttu-id="86a58-112">Les adresses et liaisons de transport par défaut du service sont fournies dans un fichier de configuration de service, mais elles peuvent être reconfigurées si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="86a58-112">Default addresses and transport bindings for the service are provided in a service configuration file, but these can be reconfigured as required.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="86a58-113">Les contrats des services Web exposés restent constants tant que les interfaces et la configuration COM+ restent inchangées.</span><span class="sxs-lookup"><span data-stu-id="86a58-113">The contracts for the exposed Web services remain constant as long as the COM+ interfaces and configuration remain unchanged.</span></span> <span data-ttu-id="86a58-114">La modification de plusieurs interfaces ne met pas automatiquement à jour les services disponibles et requiert de réexécuter l'outil ComSvcConfig.exe (COM+ Service Model Configuration).</span><span class="sxs-lookup"><span data-stu-id="86a58-114">A modification to several interfaces does not automatically update the available services and requires re-running the COM+ Service Model Configuration tool (ComSvcConfig.exe).</span></span>  
  
 <span data-ttu-id="86a58-115">Les spécifications d'authentification et d'autorisation de l'application COM+ et de ses composants continuent d'être appliquées lorsqu'elle sert de service Web.</span><span class="sxs-lookup"><span data-stu-id="86a58-115">The authentication and authorization requirements of the COM+ application and its components continue to be enforced when used as a Web service.</span></span>  
  
 <span data-ttu-id="86a58-116">Si l'appelant initie une transaction de service Web, les composants marqués comme transactionnels s'inscrivent dans l'étendue de cette transaction.</span><span class="sxs-lookup"><span data-stu-id="86a58-116">If the caller initiates a Web service transaction, components marked as transactional enlist within that transaction scope.</span></span>  
  
 <span data-ttu-id="86a58-117">Les étapes suivantes sont requises pour exposer l'interface d'un composant COM+ comme service Web sans modifier le composant :</span><span class="sxs-lookup"><span data-stu-id="86a58-117">The following steps are required to expose a COM+ component's interface as a Web service without modifying the component:</span></span>  
  
1.  <span data-ttu-id="86a58-118">Déterminez si l'interface du composant COM+ peut être exposée comme service Web.</span><span class="sxs-lookup"><span data-stu-id="86a58-118">Determine whether the COM+ component's interface can be exposed as a Web service.</span></span>  
  
2.  <span data-ttu-id="86a58-119">Sélectionnez un mode d'hébergement approprié.</span><span class="sxs-lookup"><span data-stu-id="86a58-119">Select an appropriate hosting mode.</span></span>  
  
3.  <span data-ttu-id="86a58-120">Utilisez l'outil ComSvcConfig.exe (COM+ Service Model Configuration) pour ajouter un service Web pour l'interface.</span><span class="sxs-lookup"><span data-stu-id="86a58-120">Use the COM+ Service Model Configuration tool (ComSvcConfig.exe) to add a Web service for the interface.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="86a58-121">comment utiliser ComSvcConfig.exe, consultez [Comment : utiliser COM + Service Model Configuration Tool](../../../../docs/framework/wcf/feature-details/how-to-use-the-com-service-model-configuration-tool.md).</span><span class="sxs-lookup"><span data-stu-id="86a58-121"> how to use ComSvcConfig.exe, see [How to: Use the COM+ Service Model Configuration Tool](../../../../docs/framework/wcf/feature-details/how-to-use-the-com-service-model-configuration-tool.md).</span></span>  
  
4.  <span data-ttu-id="86a58-122">Configurez les paramètres de service supplémentaires dans le fichier de configuration de l'application.</span><span class="sxs-lookup"><span data-stu-id="86a58-122">Configure any additional service settings in the application configuration file.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="86a58-123">comment configurer un composant, consultez [Comment : configurer les paramètres de Service COM +](../../../../docs/framework/wcf/feature-details/how-to-configure-com-service-settings.md).</span><span class="sxs-lookup"><span data-stu-id="86a58-123"> how to configure a component, see [How to: Configure COM+ Service Settings](../../../../docs/framework/wcf/feature-details/how-to-configure-com-service-settings.md).</span></span>  
  
## <a name="supported-interfaces"></a><span data-ttu-id="86a58-124">Interfaces prises en charge</span><span class="sxs-lookup"><span data-stu-id="86a58-124">Supported Interfaces</span></span>  
 <span data-ttu-id="86a58-125">Certaines restrictions s'appliquent aux types d'interfaces qui peuvent être exposés comme service Web.</span><span class="sxs-lookup"><span data-stu-id="86a58-125">There are some restrictions on the type of interfaces that can be exposed as a Web service.</span></span> <span data-ttu-id="86a58-126">Les types d'interfaces suivants ne sont pas pris en charge :</span><span class="sxs-lookup"><span data-stu-id="86a58-126">The following types of interfaces are not supported:</span></span>  
  
-   <span data-ttu-id="86a58-127">Les interfaces qui passent des références d'objet comme paramètres - voir la section concernant la prise en charge limitée des références d'objet.</span><span class="sxs-lookup"><span data-stu-id="86a58-127">Interfaces that pass object references as parameters - the following limited object reference approach is described in the Limited Object Reference Support section.</span></span>  
  
-   <span data-ttu-id="86a58-128">Les interfaces qui passent des types incompatibles avec les conversions d'interopérabilité COM [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="86a58-128">Interfaces that pass types that are not compatible with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] COM interoperability conversions.</span></span>  
  
-   <span data-ttu-id="86a58-129">Les interfaces des applications dont la fonction de regroupement d'applications est activée lorsqu'elles sont hébergées par COM+.</span><span class="sxs-lookup"><span data-stu-id="86a58-129">Interfaces for applications that have application pooling enabled when hosted by COM+.</span></span>  
  
-   <span data-ttu-id="86a58-130">Les interfaces des composants marqués comme privés pour l'application.</span><span class="sxs-lookup"><span data-stu-id="86a58-130">Interfaces of components that are marked as private to the application.</span></span>  
  
-   <span data-ttu-id="86a58-131">Les interfaces d'infrastructure COM+.</span><span class="sxs-lookup"><span data-stu-id="86a58-131">COM+ infrastructure interfaces.</span></span>  
  
-   <span data-ttu-id="86a58-132">Les interfaces issues de l'application système.</span><span class="sxs-lookup"><span data-stu-id="86a58-132">Interfaces from the system application.</span></span>  
  
-   <span data-ttu-id="86a58-133">Les interfaces issues des composants Enterprise Services qui n'ont pas été ajoutés au cache GAC (Global Assembly Cache).</span><span class="sxs-lookup"><span data-stu-id="86a58-133">Interfaces from Enterprise Services components that have not been added to the global assembly cache.</span></span>  
  
### <a name="limited-object-reference-support"></a><span data-ttu-id="86a58-134">Prise en charge limitée des références d'objet</span><span class="sxs-lookup"><span data-stu-id="86a58-134">Limited Object Reference Support</span></span>  
 <span data-ttu-id="86a58-135">Comme un certain nombre de composants COM+ déployés n'utilisent pas de paramètres de référence d'objet, pour retourner un objet ADO Recordset par exemple, l'intégration COM+ inclut une prise en charge limitée des paramètres de référence d'objet.</span><span class="sxs-lookup"><span data-stu-id="86a58-135">Because a number of deployed COM+ components do use objects by reference parameters, such as returning an ADO Recordset object, COM+ integration includes limited support for object reference parameters.</span></span> <span data-ttu-id="86a58-136">Cette prise en charge est limitée aux objets qui implémentent l'interface COM `IPersistStream`.</span><span class="sxs-lookup"><span data-stu-id="86a58-136">The support is limited to objects that implement the `IPersistStream` COM interface.</span></span> <span data-ttu-id="86a58-137">Elle inclut les objets ADO Recordset et peut être implémentée pour des objets COM propres à l'application.</span><span class="sxs-lookup"><span data-stu-id="86a58-137">This includes ADO Recordset objects and can be implemented for application specific COM objects.</span></span>  
  
 <span data-ttu-id="86a58-138">Pour activer cette prise en charge, l’outil ComSvcConfig.exe fournit le **allowreferences** commutateur qui désactive le paramètre de signature de méthode normal et vérifie que l’outil s’exécute pour vous assurer que les paramètres de référence d’objet ne sont pas utilisés .</span><span class="sxs-lookup"><span data-stu-id="86a58-138">To enable this support, the ComSvcConfig.exe tool provides the **allowreferences** switch that disables the regular method signature parameter and checks that the tool runs to ensure that object reference parameters are not being used.</span></span> <span data-ttu-id="86a58-139">De plus, les types d'objet que vous passez comme paramètres doivent être nommés et identifiés dans l'élément de configuration <`persistableTypes`> qui est un enfant de l'élément <`comContract`>.</span><span class="sxs-lookup"><span data-stu-id="86a58-139">In addition, the object types that you pass as parameters must be named and identified within the <`persistableTypes`> configuration element that is a child of the <`comContract`> element.</span></span>  
  
 <span data-ttu-id="86a58-140">Lorsque cette fonctionnalité est activée, le service d'intégration COM+ utilise l'interface `IPersistStream` pour sérialiser ou désérialiser l'instance d'objet.</span><span class="sxs-lookup"><span data-stu-id="86a58-140">When this feature is used, the COM+ integration service uses the `IPersistStream` interface to serialize or deserialize the object instance.</span></span> <span data-ttu-id="86a58-141">Si l'instance d'objet ne prend pas en charge `IPersistStream`, une exception est levée.</span><span class="sxs-lookup"><span data-stu-id="86a58-141">If the object instance does not support `IPersistStream`, an exception is thrown.</span></span>  
  
 <span data-ttu-id="86a58-142">Dans une application cliente, les méthodes sur l'objet <xref:System.ServiceModel.ComIntegration.PersistStreamTypeWrapper> peuvent être utilisées pour passer un objet dans un service, et pour récupérer un objet de la même façon.</span><span class="sxs-lookup"><span data-stu-id="86a58-142">Within a client application, the methods on the <xref:System.ServiceModel.ComIntegration.PersistStreamTypeWrapper> object can be used to pass an object in to a service and similarly to retrieve an object.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="86a58-143">En raison de la nature personnalisée et propre à la plateforme de la méthode de sérialisation, il est préférable de l'utiliser entre des clients [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] et des services [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span><span class="sxs-lookup"><span data-stu-id="86a58-143">Due to the custom and platform-specific nature of the serialization approach, this is best suited for use between [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] clients and [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services.</span></span>  
  
## <a name="selecting-the-hosting-mode"></a><span data-ttu-id="86a58-144">Sélection du mode d'hébergement</span><span class="sxs-lookup"><span data-stu-id="86a58-144">Selecting the Hosting Mode</span></span>  
 <span data-ttu-id="86a58-145">COM+ expose des services Web dans l'un des modes d'hébergement suivants :</span><span class="sxs-lookup"><span data-stu-id="86a58-145">COM+ exposes Web services in one of the following hosting modes:</span></span>  
  
-   <span data-ttu-id="86a58-146">Hébergé par COM+</span><span class="sxs-lookup"><span data-stu-id="86a58-146">COM+-hosted</span></span>  
  
     <span data-ttu-id="86a58-147">Le service Web est hébergé dans le processus serveur COM+ dédié de l'application (Dllhost.exe).</span><span class="sxs-lookup"><span data-stu-id="86a58-147">The Web service is hosted within the application's dedicated COM+ server process (Dllhost.exe).</span></span> <span data-ttu-id="86a58-148">Ce mode requiert le démarrage explicite de l'application pour qu'elle puisse recevoir des demandes de service Web.</span><span class="sxs-lookup"><span data-stu-id="86a58-148">This mode requires the application to be explicitly started before it can receive Web service requests.</span></span> <span data-ttu-id="86a58-149">Les options COM+ « Exécuter en tant que service NT » ou « Ne pas arrêter l'exécution lors de l'inactivité » peuvent être utilisées pour empêcher l'arrêt de l'application et de ses services suite à une période d'inactivité.</span><span class="sxs-lookup"><span data-stu-id="86a58-149">The COM+ options "Run as an NT Service" or "Leave running when idle" can be used to prevent idle shutdown of the application and its services.</span></span> <span data-ttu-id="86a58-150">Ce mode fournit à la fois un service Web et un accès DCOM à l'application serveur.</span><span class="sxs-lookup"><span data-stu-id="86a58-150">This mode provides both Web service and DCOM access to the server application.</span></span>  
  
-   <span data-ttu-id="86a58-151">Hébergé sur le Web</span><span class="sxs-lookup"><span data-stu-id="86a58-151">Web-hosted</span></span>  
  
     <span data-ttu-id="86a58-152">Le service Web est hébergé dans un processus de travail de serveur Web.</span><span class="sxs-lookup"><span data-stu-id="86a58-152">The Web service is hosted within a Web server worker process.</span></span> <span data-ttu-id="86a58-153">Ce mode ne requiert pas l'activation de COM+ lorsque la demande initiale est reçue.</span><span class="sxs-lookup"><span data-stu-id="86a58-153">This mode does not require COM+ to be active when the initial request is received.</span></span> <span data-ttu-id="86a58-154">Si l'application n'est pas active lorsque cette demande est reçue, elle est activée automatiquement avant le traitement de la demande.</span><span class="sxs-lookup"><span data-stu-id="86a58-154">If the application is not active when this request is received, it is automatically activated prior to processing the request.</span></span> <span data-ttu-id="86a58-155">Ce mode fournit également un service Web et un accès DCOM à l'application serveur, mais provoque un saut de processus pour les demandes de service Web.</span><span class="sxs-lookup"><span data-stu-id="86a58-155">This mode also provides both Web service and DCOM access to the server application, but causes a process hop for Web service requests.</span></span> <span data-ttu-id="86a58-156">En général, il requiert l'activation de l'emprunt d'identité par le client.</span><span class="sxs-lookup"><span data-stu-id="86a58-156">This typically requires the client to enable impersonation.</span></span> <span data-ttu-id="86a58-157">Dans [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], cette opération peut être réalisée avec la propriété <xref:System.ServiceModel.Security.WindowsClientCredential.AllowedImpersonationLevel%2A> de la classe <xref:System.ServiceModel.Security.WindowsClientCredential>, accessible en tant que propriété de la classe générique <xref:System.ServiceModel.ChannelFactory%601>, ainsi que la valeur d'énumération <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation>.</span><span class="sxs-lookup"><span data-stu-id="86a58-157">In [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], this can be done with the <xref:System.ServiceModel.Security.WindowsClientCredential.AllowedImpersonationLevel%2A> property of the <xref:System.ServiceModel.Security.WindowsClientCredential> class, which is accessed as a property of the generic <xref:System.ServiceModel.ChannelFactory%601> class, as well as the <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation> enumeration value.</span></span>  
  
-   <span data-ttu-id="86a58-158">Hébergé sur le Web dans un processus</span><span class="sxs-lookup"><span data-stu-id="86a58-158">Web-hosted in-process</span></span>  
  
     <span data-ttu-id="86a58-159">Le service Web et la logique d'application COM+ sont hébergés dans le processus de travail de serveur Web.</span><span class="sxs-lookup"><span data-stu-id="86a58-159">The Web service and the COM+ application logic are hosted within the Web server worker process.</span></span> <span data-ttu-id="86a58-160">Cela permet l'activation automatique du mode Hébergé sur le Web sans provoquer de saut de processus pour les demandes de service Web.</span><span class="sxs-lookup"><span data-stu-id="86a58-160">This provides automatic activation of the Web-hosted mode without causing a process hop for Web service requests.</span></span> <span data-ttu-id="86a58-161">L'inconvénient est que l'application serveur n'est pas accessible par le biais de DCOM.</span><span class="sxs-lookup"><span data-stu-id="86a58-161">The disadvantage is that the server application cannot be accessed through DCOM.</span></span>  
  
### <a name="security-considerations"></a><span data-ttu-id="86a58-162">Considérations relatives à la sécurité</span><span class="sxs-lookup"><span data-stu-id="86a58-162">Security Considerations</span></span>  
 <span data-ttu-id="86a58-163">Comme pour d'autres services [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], les paramètres de sécurité du service exposé sont administrés à l'aide des paramètres de configuration du canal [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span><span class="sxs-lookup"><span data-stu-id="86a58-163">Like other [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services, the security settings for the exposed service are administered through configuration settings for the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] channel.</span></span> <span data-ttu-id="86a58-164">D'ordinaire, les paramètres de sécurité DCOM, tels que les paramètres des autorisations DCOM à l'échelle de l'ordinateur, ne sont pas appliqués.</span><span class="sxs-lookup"><span data-stu-id="86a58-164">Traditional DCOM security settings such as the DCOM machine-wide permissions settings are not enforced.</span></span> <span data-ttu-id="86a58-165">Pour appliquer des rôles d'application COM+, l'autorisation « Appliquer les vérifications d'accès au niveau du composant » doit être activée pour le composant.</span><span class="sxs-lookup"><span data-stu-id="86a58-165">To enforce COM+ application roles, "component-level access checks" authorization must be enabled for the component.</span></span>  
  
 <span data-ttu-id="86a58-166">L'utilisation d'une liaison non sécurisée peut exposer la communication à des risques de falsification et de divulgation d'informations.</span><span class="sxs-lookup"><span data-stu-id="86a58-166">The use of a non-secured binding can leave communication open to tampering or information disclosure.</span></span> <span data-ttu-id="86a58-167">Pour éviter ce problème, il est recommandé de recourir à une liaison sécurisée.</span><span class="sxs-lookup"><span data-stu-id="86a58-167">To prevent this, it is recommended that you use a secured binding.</span></span>  
  
 <span data-ttu-id="86a58-168">Pour les modes Hébergé par COM+ et Hébergé sur le Web, les applications clientes doivent autoriser le processus serveur à emprunter l'identité de l'utilisateur client.</span><span class="sxs-lookup"><span data-stu-id="86a58-168">For the COM+-hosted and Web-hosted modes, client applications must permit the server process to impersonate the client user.</span></span> <span data-ttu-id="86a58-169">Cette procédure peut s'effectuer sur les clients [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] en affectant au niveau d'emprunt d'identité la valeur <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation>.</span><span class="sxs-lookup"><span data-stu-id="86a58-169">This can be done in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] clients by setting the impersonation level to <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation>.</span></span>  
  
 <span data-ttu-id="86a58-170">Lorsque les services IIS (Internet Information Services) ou le service d'activation de processus de Windows (WAS, Windows Process Activation Service) utilisent le transport HTTP, l'outil Httpcfg.exe peut être exécuté pour réserver une adresse de point de terminaison de transport.</span><span class="sxs-lookup"><span data-stu-id="86a58-170">With Internet Information Services (IIS) or Windows Process Activation Service (WAS) using the HTTP transport, the Httpcfg.exe tool can be used to reserve a transport endpoint address.</span></span> <span data-ttu-id="86a58-171">Dans d'autres configurations, il est important de se protéger contre les services non autorisés qui se comportent comme le service prévu.</span><span class="sxs-lookup"><span data-stu-id="86a58-171">In other configurations, it is important to protect against rogue services that act as the intended service.</span></span> <span data-ttu-id="86a58-172">Pour empêcher un service non autorisé de démarrer au point de terminaison souhaité, le service légitime peut être configuré pour s'exécuter comme un service NT.</span><span class="sxs-lookup"><span data-stu-id="86a58-172">To prevent a rogue service from starting at the desired endpoint, the legitimate service can be configured to run as an NT service.</span></span> <span data-ttu-id="86a58-173">Cette méthode permet au service légitime de revendiquer l'adresse du point de terminaison avant un service non autorisé.</span><span class="sxs-lookup"><span data-stu-id="86a58-173">This enables the legitimate service to claim the endpoint address prior to any rogue services.</span></span>  
  
 <span data-ttu-id="86a58-174">Lors de l’exposition d’une application COM + avec des rôles COM + configurés comme un service hébergé sur le Web, le « compte de processus IIS de lancement » doit être ajouté à un des rôles de l’application.</span><span class="sxs-lookup"><span data-stu-id="86a58-174">When exposing a COM+ application with configured COM+ roles as a Web-hosted service, the "Launch IIS Process Account" must be added to one of the application’s roles.</span></span> <span data-ttu-id="86a58-175">Ce compte, généralement appelé IWAM_nom_ordinateur, doit être ajouté pour activer l'arrêt normal des objets après leur utilisation.</span><span class="sxs-lookup"><span data-stu-id="86a58-175">This account, typically with the name IWAM_machinename, must be added to enable clean shutdown of objects after use.</span></span> <span data-ttu-id="86a58-176">Aucune autre autorisation ne doit être accordée au compte.</span><span class="sxs-lookup"><span data-stu-id="86a58-176">The account should not be granted any additional permissions.</span></span>  
  
 <span data-ttu-id="86a58-177">Les fonctionnalités de recyclage de processus COM+ ne peuvent pas être utilisées sur des applications intégrées.</span><span class="sxs-lookup"><span data-stu-id="86a58-177">The COM+ process recycling features cannot be used on integrated applications.</span></span> <span data-ttu-id="86a58-178">Si l'application est configurée pour utiliser le recyclage de processus et que les composants s'exécutent dans un processus hébergé par COM+, le service ne démarre pas.</span><span class="sxs-lookup"><span data-stu-id="86a58-178">If the application is configured to use process recycling and the components are running in a COM+ hosted process, the service fails to start.</span></span> <span data-ttu-id="86a58-179">Cette exigence ne concerne pas les services utilisant le mode Hébergé sur le Web dans un processus car les paramètres de recyclage de processus ne sont pas appliqués.</span><span class="sxs-lookup"><span data-stu-id="86a58-179">This requirement does not include services using the Web-hosted in-process mode because the process recycling settings are not applied.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="86a58-180">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="86a58-180">See Also</span></span>  
 [<span data-ttu-id="86a58-181">Intégration de la vue d’ensemble des Applications COM</span><span class="sxs-lookup"><span data-stu-id="86a58-181">Integrating with COM Applications Overview</span></span>](../../../../docs/framework/wcf/feature-details/integrating-with-com-applications-overview.md)
