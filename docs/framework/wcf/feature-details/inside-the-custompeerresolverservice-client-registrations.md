---
title: "Dans CustomPeerResolverService : Inscriptions des clients"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 40236953-a916-4236-84a6-928859e1331a
caps.latest.revision: "7"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 9c979922bf8c7b786fd0a671c22289fb148a883c
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/22/2017
---
# <a name="inside-the-custompeerresolverservice-client-registrations"></a><span data-ttu-id="543a5-102">Dans CustomPeerResolverService : Inscriptions des clients</span><span class="sxs-lookup"><span data-stu-id="543a5-102">Inside the CustomPeerResolverService: Client Registrations</span></span>
<span data-ttu-id="543a5-103">Chaque nœud de la maille publie ses informations sur le point de terminaison sur le service de résolution par le biais de la fonction `Register`.</span><span class="sxs-lookup"><span data-stu-id="543a5-103">Each node in the mesh publishes its endpoint information to the resolver service through the `Register` function.</span></span> <span data-ttu-id="543a5-104">Le service de résolution stocke ces informations comme un enregistrement d'inscription.</span><span class="sxs-lookup"><span data-stu-id="543a5-104">The resolver service stores this information as a registration record.</span></span> <span data-ttu-id="543a5-105">Cet enregistrement contient un identificateur unique (RegistrationID) et les informations sur le point de terminaison (PeerNodeAddress) concernant le nœud.</span><span class="sxs-lookup"><span data-stu-id="543a5-105">This record contains a unique identifier (RegistrationID) and endpoint information (PeerNodeAddress) for the node.</span></span>  
  
## <a name="stale-records-and-expiration-time"></a><span data-ttu-id="543a5-106">Enregistrements périmés et heure d'expiration</span><span class="sxs-lookup"><span data-stu-id="543a5-106">Stale Records and Expiration Time</span></span>  
 <span data-ttu-id="543a5-107">Dans l'idéal, lorsqu'un nœud quitte la maille, il appelle la fonction `Unregister`, qui entraîne la suppression de l'entrée de l'inscription par le service de résolution.</span><span class="sxs-lookup"><span data-stu-id="543a5-107">Ideally, when a node leaves the mesh, it will call the `Unregister` function, which causes the resolver service to remove the registration entry.</span></span> <span data-ttu-id="543a5-108">Quelquefois, les nœuds sont arrêtés ou deviennent inaccessibles avant l'appel de `Unregister`, laissant derrière un enregistrement d'inscription périmé.</span><span class="sxs-lookup"><span data-stu-id="543a5-108">Sometimes, nodes shut down or become inaccessible before calling `Unregister`, leaving behind a stale registration record.</span></span>  
  
 <span data-ttu-id="543a5-109">Les enregistrements périmés dans votre service de résolution peuvent entraîner l'échec des connexions.</span><span class="sxs-lookup"><span data-stu-id="543a5-109">Stale records in your resolver service can cause failed connections.</span></span> <span data-ttu-id="543a5-110">Si un nœud qui essaie de se connecter à une maille reçoit des informations de connexion périmées du service de résolution, l'établissement de la liaison avec la maille peut prendre plus de temps.</span><span class="sxs-lookup"><span data-stu-id="543a5-110">If a node trying to connect to a mesh receives stale connection information from the resolver service, it can take longer to successfully join the mesh.</span></span> <span data-ttu-id="543a5-111">Les enregistrements périmés occupent également de l'espace en mémoire.</span><span class="sxs-lookup"><span data-stu-id="543a5-111">Stale records also take up memory.</span></span> <span data-ttu-id="543a5-112">Sans un processus de nettoyage efficace, le cache dans lequel sont stockées les inscriptions pourrait finir par être saturé, entraînant alors l'échec du service de résolution.</span><span class="sxs-lookup"><span data-stu-id="543a5-112">Without an efficient clean up process, the cache used to store registrations could eventually overflow and crash the resolver service.</span></span>  
  
 <span data-ttu-id="543a5-113">Le <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> marque chaque enregistrement avec une heure d'expiration (DateTime) et stocke cette information dans le cadre de l'enregistrement.</span><span class="sxs-lookup"><span data-stu-id="543a5-113">The <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> marks each record with an expiration time (DateTime), and stores that information as part of the record.</span></span> <span data-ttu-id="543a5-114">Le service utilise cette heure d'expiration pour identifier les enregistrements périmés.</span><span class="sxs-lookup"><span data-stu-id="543a5-114">The service uses the expiration time to identify stale records.</span></span> <span data-ttu-id="543a5-115">Les implémentations personnalisées devraient se comporter de manière semblable.</span><span class="sxs-lookup"><span data-stu-id="543a5-115">Custom implementations should do something similar.</span></span>  
  
## <a name="refreshinterval-and-cleanupinterval"></a><span data-ttu-id="543a5-116">RefreshInterval et CleanupInterval</span><span class="sxs-lookup"><span data-stu-id="543a5-116">RefreshInterval and CleanupInterval</span></span>  
 <span data-ttu-id="543a5-117">La propriété `RefreshInterval` du <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> définit le délai de validité des enregistrements d'inscription longs dans la table de recherche d'inscription du service.</span><span class="sxs-lookup"><span data-stu-id="543a5-117">The `RefreshInterval` property of the <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> defines how long registration records remain valid in the service's registration lookup table.</span></span> <span data-ttu-id="543a5-118">Lorsque le délai défini par cette propriété pour un enregistrement donné a expiré, l'enregistrement en question est périmé et est marqué en vue de sa suppression.</span><span class="sxs-lookup"><span data-stu-id="543a5-118">When the amount of time supplied to this property has passed for a given record, that record becomes stale and is marked for deletion.</span></span>  
  
 <span data-ttu-id="543a5-119">La propriété `CleanupInterval` du <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> indique au service l'intervalle de recherche et de suppression des enregistrements d'inscription périmés.</span><span class="sxs-lookup"><span data-stu-id="543a5-119">The `CleanupInterval` property of the <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> tells the service how often to search for and delete stale registration records.</span></span> <span data-ttu-id="543a5-120">La valeur de `CleanupInterval` doit être supérieure ou égale à la valeur `RefreshInterval` définie sur le service.</span><span class="sxs-lookup"><span data-stu-id="543a5-120">The `CleanupInterval` should be set to a time greater than or equal to the `RefreshInterval` set on the service.</span></span>  
  
 <span data-ttu-id="543a5-121">Pour implémenter votre propre service de résolution, vous devez écrire une fonction de maintenance qui supprime les enregistrements d'inscription périmés.</span><span class="sxs-lookup"><span data-stu-id="543a5-121">To implement your own resolver service, you need to write a maintenance function to remove stale registration records.</span></span> <span data-ttu-id="543a5-122">Pour ce faire, plusieurs méthodes sont possibles :</span><span class="sxs-lookup"><span data-stu-id="543a5-122">There are several ways to do this:</span></span>  
  
-   <span data-ttu-id="543a5-123">**Maintenance périodique**: définir une minuterie périodique et parcourez votre magasin de données à supprimer les anciens enregistrements.</span><span class="sxs-lookup"><span data-stu-id="543a5-123">**Periodic maintenance**: Set a timer to go off periodically, and go through your data store to delete old records.</span></span> <span data-ttu-id="543a5-124">Le <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> utilise cette approche.</span><span class="sxs-lookup"><span data-stu-id="543a5-124">The <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> uses this approach.</span></span>  
  
-   <span data-ttu-id="543a5-125">**Suppression passive**: au lieu de rechercher activement les enregistrements périmés à intervalles réguliers, vous pouvez identifier et supprimer les enregistrements obsolètes lorsque votre service exécute déjà une autre fonction.</span><span class="sxs-lookup"><span data-stu-id="543a5-125">**Passive deletion**: Instead of actively searching for stale records at regular intervals, you can identify and delete stale records when your service is already performing another function.</span></span> <span data-ttu-id="543a5-126">Cela peut ralentir potentiellement le temps de réponse aux demandes des clients de programme de résolution, mais il élimine la nécessité de définir une minuterie, et peut être plus efficace si peu de nœuds sont supposés quitter la maille sans appeler `Unregister`.</span><span class="sxs-lookup"><span data-stu-id="543a5-126">This may potentially slow down response time to requests from the resolver clients, but it eliminates the need for a timer, and may be more efficient if few nodes are expected to leave without calling `Unregister`.</span></span>  
  
## <a name="registrationlifetime-and-refresh"></a><span data-ttu-id="543a5-127">RegistrationLifetime et Refresh</span><span class="sxs-lookup"><span data-stu-id="543a5-127">RegistrationLifetime and Refresh</span></span>  
 <span data-ttu-id="543a5-128">Lorsqu'un nœud s'inscrit auprès d'un service de résolution, il reçoit de ce dernier un objet <xref:System.ServiceModel.PeerResolvers.RegisterResponseInfo>.</span><span class="sxs-lookup"><span data-stu-id="543a5-128">When a node registers with a resolver service, it receives a <xref:System.ServiceModel.PeerResolvers.RegisterResponseInfo> object from the service.</span></span> <span data-ttu-id="543a5-129">Cet objet a une propriété `RegistrationLifetime` qui indique au nœud combien de temps il reste avant que l'inscription expire et sa suppression par le service de résolution.</span><span class="sxs-lookup"><span data-stu-id="543a5-129">This object has a `RegistrationLifetime` property which indicates to the node how much time it has before the registration expires and is removed by the resolver service.</span></span> <span data-ttu-id="543a5-130">Par exemple, si `RegistrationLifetime` est égal à 2 minutes, le nœud doit appeler `Refresh` dans moins de 2 minutes afin de garantir que l'enregistrement reste actualisé et ne soit pas supprimé.</span><span class="sxs-lookup"><span data-stu-id="543a5-130">If, for example, the `RegistrationLifetime` is 2 minutes, the node needs to call `Refresh` in under 2 minutes to ensure the record stays fresh and is not deleted.</span></span> <span data-ttu-id="543a5-131">Lorsque le service de résolution reçoit une demande `Refresh`, il examine l'enregistrement et réinitialise l'heure d'expiration.</span><span class="sxs-lookup"><span data-stu-id="543a5-131">When the resolver service receives a `Refresh` request, it looks up the record and resets the expiration time.</span></span> <span data-ttu-id="543a5-132">Refresh retourne un objet <xref:System.ServiceModel.PeerResolvers.RefreshResponseInfo> avec une propriété `RegistrationLifetime`.</span><span class="sxs-lookup"><span data-stu-id="543a5-132">Refresh returns a <xref:System.ServiceModel.PeerResolvers.RefreshResponseInfo> object with a `RegistrationLifetime` property.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="543a5-133">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="543a5-133">See Also</span></span>  
 [<span data-ttu-id="543a5-134">Programmes de résolution d’homologue</span><span class="sxs-lookup"><span data-stu-id="543a5-134">Peer Resolvers</span></span>](../../../../docs/framework/wcf/feature-details/peer-resolvers.md)
