---
title: Mise en file d'attente dans WCF
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: e98d76ba-1acf-42cd-b137-0f8214661112
caps.latest.revision: "21"
author: Erikre
ms.author: erikre
manager: erikre
ms.openlocfilehash: 64a66b1ce04f6c644eef266fee1c89366f1fb707
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/21/2017
---
# <a name="queuing-in-wcf"></a><span data-ttu-id="49ed9-102">Mise en file d'attente dans WCF</span><span class="sxs-lookup"><span data-stu-id="49ed9-102">Queuing in WCF</span></span>
<span data-ttu-id="49ed9-103">Cette section décrit comment utiliser la communication mise en file d'attente dans [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)].</span><span class="sxs-lookup"><span data-stu-id="49ed9-103">This section describes how to use queued communication in [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)].</span></span>  
  
## <a name="queues-as-a-wcf-transport-binding"></a><span data-ttu-id="49ed9-104">Mises en file d'attente en tant que liaison de transport WCF</span><span class="sxs-lookup"><span data-stu-id="49ed9-104">Queues as a WCF transport binding</span></span>  
 <span data-ttu-id="49ed9-105">Dans [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], les contrats spécifient ce qui est échangé.</span><span class="sxs-lookup"><span data-stu-id="49ed9-105">In [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], the contracts specify what is being exchanged.</span></span> <span data-ttu-id="49ed9-106">Les contrats sont des échanges de messages propres à une entreprise ou à une application.</span><span class="sxs-lookup"><span data-stu-id="49ed9-106">Contracts are business-dependent or application-specific message exchanges.</span></span> <span data-ttu-id="49ed9-107">Le mécanisme utilisé pour échanger des messages est spécifié dans les liaisons.</span><span class="sxs-lookup"><span data-stu-id="49ed9-107">The mechanism used to exchange messages (or the "how") is specified in the bindings.</span></span> <span data-ttu-id="49ed9-108">Dans [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], les liaisons encapsulent les détails de l'échange de messages.</span><span class="sxs-lookup"><span data-stu-id="49ed9-108">Bindings in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] encapsulate details of the message exchange.</span></span> <span data-ttu-id="49ed9-109">Elles exposent les boutons de configuration permettant à l'utilisateur de contrôler divers aspects du transport ou du protocole que les liaisons représentent.</span><span class="sxs-lookup"><span data-stu-id="49ed9-109">They expose configuration knobs for the user to control various aspects of the transport or the protocol that the bindings represent.</span></span> <span data-ttu-id="49ed9-110">La mise en file d'attente dans [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] est traitée comme toute autre liaison de transport, ce qui représente un grand avantage pour de nombreuses applications de mise en file d'attente.</span><span class="sxs-lookup"><span data-stu-id="49ed9-110">Queuing in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] is treated like any other transport binding, which is a big advantage for many queuing applications.</span></span> <span data-ttu-id="49ed9-111">Aujourd'hui, nombre de ces applications sont écrites différemment des autres applications distribuées de type appel de procédure distante, ce qui complique leur suivi et leur maintenance.</span><span class="sxs-lookup"><span data-stu-id="49ed9-111">Today, many queuing applications are written differently from other remote procedure call (RPC)-style distributed applications, making it harder to follow and maintain.</span></span> <span data-ttu-id="49ed9-112">Avec [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], le style pour écrire une application distribuée est quasiment identique, ce qui facilite son suivi et sa maintenance.</span><span class="sxs-lookup"><span data-stu-id="49ed9-112">With [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], the style of writing a distributed application is much the same, making it easier to follow and maintain.</span></span> <span data-ttu-id="49ed9-113">De plus, le fait de développer le mécanisme d'échange séparément de la logique métier facilite la configuration du transport ou sa modification sans affecter le code propre à l'application.</span><span class="sxs-lookup"><span data-stu-id="49ed9-113">Moreover, by factoring out the mechanism of exchange separately from the business logic, it is easier to configure the transport or make changes to it without affecting application specific code.</span></span> <span data-ttu-id="49ed9-114">La figure qui suit illustre la structure d'un service et d'un client WCF qui utilise MSMQ comme transport.</span><span class="sxs-lookup"><span data-stu-id="49ed9-114">The following figure illustrates the structure of a WCF service and client using MSMQ as a transport.</span></span>  
  
 <span data-ttu-id="49ed9-115">![Diagramme d’Application de la file d’attente](../../../../docs/framework/wcf/feature-details/media/distributed-queue-figure.jpg "Figure de file d’attente distribuée")</span><span class="sxs-lookup"><span data-stu-id="49ed9-115">![Queued Application Diagram](../../../../docs/framework/wcf/feature-details/media/distributed-queue-figure.jpg "Distributed-Queue-Figure")</span></span>  
  
 <span data-ttu-id="49ed9-116">Comme le montre la figure ci-dessus, le client et le service ne doivent définir que la sémantique de l'application ; autrement dit le contrat et l'implémentation.</span><span class="sxs-lookup"><span data-stu-id="49ed9-116">As you can see from the preceding figure, the client and service must define only the application semantics, that is, the contract and implementation.</span></span> <span data-ttu-id="49ed9-117">Le service configure une liaison mise en file d’attente avec des paramètres par défaut.</span><span class="sxs-lookup"><span data-stu-id="49ed9-117">The service configures a queued binding with preferred settings.</span></span> <span data-ttu-id="49ed9-118">Le client utilise le [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) pour générer un [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client au service et pour générer un fichier de configuration qui décrit les liaisons à utiliser pour envoyer des messages au service.</span><span class="sxs-lookup"><span data-stu-id="49ed9-118">The client uses the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) to generate a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client to the service and to generate a configuration file that describes the bindings to use to send messages to the service.</span></span> <span data-ttu-id="49ed9-119">De ce fait, pour envoyer un message mis en file d'attente, le client instancie un client [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] et appelle une opération sur ce dernier.</span><span class="sxs-lookup"><span data-stu-id="49ed9-119">Thus, to send a queued message, the client instantiates a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client and invokes an operation on it.</span></span> <span data-ttu-id="49ed9-120">Le message est alors envoyé dans la file d'attente de transmission, puis transféré à la file d'attente cible.</span><span class="sxs-lookup"><span data-stu-id="49ed9-120">This causes the message to be sent to the transmission queue and transferred to the target queue.</span></span> <span data-ttu-id="49ed9-121">L'application qui envoie et reçoit des messages est donc totalement exempte de la complexité de la communication mise en file d'attente.</span><span class="sxs-lookup"><span data-stu-id="49ed9-121">All the complexities of queued communication are hidden from the application that is sending and receiving messages.</span></span>  
  
 <span data-ttu-id="49ed9-122">Avertissements relatifs aux liaisons mises en file d'attente dans [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="49ed9-122">Caveats about queued binding in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] include:</span></span>  
  
-   <span data-ttu-id="49ed9-123">Toutes les opérations de service doivent être unidirectionnelles car la liaison mise en file d'attente par défaut dans [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] ne prend pas en charge la communication duplex à l'aide de files d'attente.</span><span class="sxs-lookup"><span data-stu-id="49ed9-123">All service operations must be one-way because the default queued binding in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] does not support duplex communication using queues.</span></span> <span data-ttu-id="49ed9-124">Un exemple de communication bidirectionnelle ([bidirectionnel Communication](../../../../docs/framework/wcf/samples/two-way-communication.md)) illustre l’utilisation de deux contrats unidirectionnels à implémenter la communication duplex à l’aide de files d’attente.</span><span class="sxs-lookup"><span data-stu-id="49ed9-124">A two-way communication sample ([Two-Way Communication](../../../../docs/framework/wcf/samples/two-way-communication.md)) illustrates how to use two one-way contracts to implement duplex communication using queues.</span></span>  
  
-   <span data-ttu-id="49ed9-125">La génération d'un client [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] à l'aide de l'échange de métadonnées requiert un point de terminaison HTTP supplémentaire sur le service afin qu'il puisse être interrogé directement en vue de générer le client [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] et obtenir des informations de liaison lui permettant de configurer correctement la communication mise en file d'attente.</span><span class="sxs-lookup"><span data-stu-id="49ed9-125">To generate a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client using metadata exchange requires an additional HTTP endpoint on the service so that it can be queried directly to generate the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] client and obtain binding information to appropriately configure queued communication.</span></span>  
  
-   <span data-ttu-id="49ed9-126">Selon la liaison mise en file d'attente, une configuration supplémentaire extérieure à [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] est requise.</span><span class="sxs-lookup"><span data-stu-id="49ed9-126">Based on the queued binding, extra configuration outside of [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] is required.</span></span> <span data-ttu-id="49ed9-127">Par exemple, la classe <xref:System.ServiceModel.NetMsmqBinding> fournie avec [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] requiert la configuration des liaisons, mais aussi la configuration minimale de MSMQ (Message Queuing).</span><span class="sxs-lookup"><span data-stu-id="49ed9-127">For example, the <xref:System.ServiceModel.NetMsmqBinding> class that is shipped with [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] requires you to configure the bindings as well as minimally configure Message Queuing (MSMQ).</span></span>  
  
 <span data-ttu-id="49ed9-128">Les sections qui suivent décrivent les liaisons mises en file d'attente fournies avec [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], qui reposent sur MSMQ.</span><span class="sxs-lookup"><span data-stu-id="49ed9-128">The following sections describe the specific queued bindings shipped with [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], which are based on MSMQ.</span></span>  
  
### <a name="msmq"></a><span data-ttu-id="49ed9-129">MSMQ</span><span class="sxs-lookup"><span data-stu-id="49ed9-129">MSMQ</span></span>  
 <span data-ttu-id="49ed9-130">Le transport de mise en file d'attente dans [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] utilise MSMQ pour sa communication mise en file d'attente.</span><span class="sxs-lookup"><span data-stu-id="49ed9-130">The queued transport in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] uses MSMQ for its queued communication.</span></span>  
  
 <span data-ttu-id="49ed9-131">MSMQ est fourni en tant que composant facultatif avec Windows et s'exécute en tant que service NT.</span><span class="sxs-lookup"><span data-stu-id="49ed9-131">MSMQ ships as an optional component with Windows and runs as an NT service.</span></span> <span data-ttu-id="49ed9-132">Il capture les messages à transmettre dans une file d'attente de transmission et les messages à remettre dans une file d'attente cible.</span><span class="sxs-lookup"><span data-stu-id="49ed9-132">It captures messages for transmission in a transmission queue and for delivery in a target queue.</span></span> <span data-ttu-id="49ed9-133">Les Gestionnaires des files d'attente MSMQ implémentent un protocole de transfert de message fiable qui empêche la perte de messages au cours de la transmission.</span><span class="sxs-lookup"><span data-stu-id="49ed9-133">The MSMQ queue managers implement a reliable message-transfer protocol so that messages are not lost in transmission.</span></span> <span data-ttu-id="49ed9-134">Ce protocole peut être natif ou basé sur SOAP, comme le protocole SRMP (SOAP Reliable Message Protocol).</span><span class="sxs-lookup"><span data-stu-id="49ed9-134">The protocol can be either native or SOAP-based, such as the SOAP Reliable Message Protocol (SRMP).</span></span>  
  
 <span data-ttu-id="49ed9-135">Dans MSMQ, les files d'attente peuvent être transactionnelles ou non transactionnelles.</span><span class="sxs-lookup"><span data-stu-id="49ed9-135">In MSMQ, queues can be transactional or non-transactional.</span></span> <span data-ttu-id="49ed9-136">Dans une file d'attente transactionnelle, les messages sont capturés et remis dans une transaction, puis stockés durablement dans la file d'attente.</span><span class="sxs-lookup"><span data-stu-id="49ed9-136">A transactional queue allows messages to be captured and delivered in a transaction and then stored durably in the queue.</span></span> <span data-ttu-id="49ed9-137">Les messages envoyés dans une file d'attente transactionnelle sont transférés exactement une fois dans l'ordre.</span><span class="sxs-lookup"><span data-stu-id="49ed9-137">Messages sent to a transactional queue are transferred exactly once in order.</span></span> <span data-ttu-id="49ed9-138">Vous pouvez utiliser une file d'attente non transactionnelle pour envoyer des messages volatils et des messages durables.</span><span class="sxs-lookup"><span data-stu-id="49ed9-138">You can use a non-transactional queue to send both volatile and durable messages.</span></span> <span data-ttu-id="49ed9-139">Un message envoyé dans une file d'attente non transactionnelle ne revêt aucune assurance de transfert fiable et peut donc être perdu.</span><span class="sxs-lookup"><span data-stu-id="49ed9-139">A message sent to a non-transactional queue does not carry any reliable transfer assurances; thus, messages can be lost.</span></span>  
  
 <span data-ttu-id="49ed9-140">Les files d'attente MSMQ peuvent également être sécurisées à l'aide d'une identité Windows inscrite auprès du service d'annuaire Active Directory.</span><span class="sxs-lookup"><span data-stu-id="49ed9-140">MSMQ queues can also be secured using a Windows identity registered with the Active Directory directory service.</span></span> <span data-ttu-id="49ed9-141">Lors de l'installation de MSMQ, vous pouvez installer l'intégration Active Directory, laquelle requiert l'appartenance de l'ordinateur à un réseau de domaine Windows.</span><span class="sxs-lookup"><span data-stu-id="49ed9-141">When installing MSMQ, you can install Active Directory integration, which requires the computer to be part of a Windows domain network.</span></span>  
  
 [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="49ed9-142">MSMQ, consultez [l’installation de Message Queuing (MSMQ)](../../../../docs/framework/wcf/samples/installing-message-queuing-msmq.md).</span><span class="sxs-lookup"><span data-stu-id="49ed9-142"> MSMQ, see [Installing Message Queuing (MSMQ)](../../../../docs/framework/wcf/samples/installing-message-queuing-msmq.md).</span></span>  
  
### <a name="netmsmqbinding"></a><span data-ttu-id="49ed9-143">NetMsmqBinding</span><span class="sxs-lookup"><span data-stu-id="49ed9-143">NetMsmqBinding</span></span>  
 <span data-ttu-id="49ed9-144">Le [ \<netMsmqBinding >](../../../../docs/framework/configure-apps/file-schema/wcf/netmsmqbinding.md) est la liaison en file d’attente [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] fournit pour deux [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] points de terminaison pour communiquer à l’aide de MSMQ.</span><span class="sxs-lookup"><span data-stu-id="49ed9-144">The [\<netMsmqBinding>](../../../../docs/framework/configure-apps/file-schema/wcf/netmsmqbinding.md) is the queued binding [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] provides for two [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] endpoints to communicate using MSMQ.</span></span> <span data-ttu-id="49ed9-145">Par conséquent, la liaison expose des propriétés qui sont spécifiques à MSMQ.</span><span class="sxs-lookup"><span data-stu-id="49ed9-145">The binding, therefore, exposes properties that are specific to MSMQ.</span></span> <span data-ttu-id="49ed9-146">Toutefois, toutes les fonctionnalités et propriétés MSMQ ne sont pas exposées dans le `NetMsmqBinding`.</span><span class="sxs-lookup"><span data-stu-id="49ed9-146">However, not all MSMQ features and properties are exposed in the `NetMsmqBinding`.</span></span> <span data-ttu-id="49ed9-147">Le `NetMsmqBinding` compact regroupe un jeu optimal de fonctionnalités qui s'avère suffisant pour la majorité des clients.</span><span class="sxs-lookup"><span data-stu-id="49ed9-147">The compact `NetMsmqBinding` is designed with an optimal set of features that most customers should find sufficient.</span></span>  
  
 <span data-ttu-id="49ed9-148">Le `NetMsmqBinding` illustre les concepts de mise en file d'attente clés discutés jusqu'ici sous la forme de propriétés sur les liaisons.</span><span class="sxs-lookup"><span data-stu-id="49ed9-148">The `NetMsmqBinding` manifests the core queuing concepts discussed thus far in the form of properties on the bindings.</span></span> <span data-ttu-id="49ed9-149">À leur tour, ces propriétés communiquent à MSMQ comment transférer et remettre les messages.</span><span class="sxs-lookup"><span data-stu-id="49ed9-149">These properties, in turn, communicate to MSMQ how to transfer and deliver the messages.</span></span> <span data-ttu-id="49ed9-150">Les sections qui suivent décrivent les catégories de propriétés.</span><span class="sxs-lookup"><span data-stu-id="49ed9-150">A discussion of the property categories is in the following sections.</span></span> [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]<span data-ttu-id="49ed9-151"> les rubriques conceptuelles qui décrivent des propriétés spécifiques plus en détail.</span><span class="sxs-lookup"><span data-stu-id="49ed9-151"> the conceptual topics that describe specific properties more completely.</span></span>  
  
#### <a name="exactlyonce-and-durable-properties"></a><span data-ttu-id="49ed9-152">Propriétés ExactlyOnce et Durable</span><span class="sxs-lookup"><span data-stu-id="49ed9-152">ExactlyOnce and Durable Properties</span></span>  
 <span data-ttu-id="49ed9-153">Les propriétés `ExactlyOnce` et `Durable` affectent la manière dont les messages sont transférés entre des files d'attente :</span><span class="sxs-lookup"><span data-stu-id="49ed9-153">The `ExactlyOnce` and `Durable` properties affect how messages are transferred between queues:</span></span>  
  
-   <span data-ttu-id="49ed9-154">`ExactlyOnce` : si sa valeur est `true` (valeur par défaut), le canal mis en file d'attente garantit que le message remis n'est pas dupliqué.</span><span class="sxs-lookup"><span data-stu-id="49ed9-154">`ExactlyOnce`: When set to `true` (the default), the queued channel ensures that the message, if delivered, is not duplicated.</span></span> <span data-ttu-id="49ed9-155">Il garantit également que le message n'est pas perdu.</span><span class="sxs-lookup"><span data-stu-id="49ed9-155">It also ensures that the message is not lost.</span></span> <span data-ttu-id="49ed9-156">Si le message ne peut pas être remis ou si sa durée de vie expire avant que le message ait pu être remis, le message et la raison de l'échec de la remise sont enregistrés dans une file d'attente de lettres mortes.</span><span class="sxs-lookup"><span data-stu-id="49ed9-156">If the message cannot be delivered, or the message Time-To Live expires before the message can be delivered, the failed message along with the delivery failure reason is recorded in a dead-letter queue.</span></span> <span data-ttu-id="49ed9-157">Lorsque sa valeur est `false`, le canal mis en file d'attente fait un effort pour transférer le message.</span><span class="sxs-lookup"><span data-stu-id="49ed9-157">When set to `false`, the queued channel makes an effort to transfer the message.</span></span> <span data-ttu-id="49ed9-158">Dans ce cas, vous pouvez éventuellement choisir une file d'attente de lettres mortes.</span><span class="sxs-lookup"><span data-stu-id="49ed9-158">In this case, you can optionally choose a dead-letter queue.</span></span>  
  
-   <span data-ttu-id="49ed9-159">`Durable:` si sa valeur est `true` (valeur par défaut), le canal mis en file d'attente garantit que MSMQ stocke le message durablement sur le disque.</span><span class="sxs-lookup"><span data-stu-id="49ed9-159">`Durable:` When set to `true` (the default), the queued channel ensures that MSMQ stores the message durably on disk.</span></span> <span data-ttu-id="49ed9-160">Ainsi, en cas d'arrêt et de redémarrage du service MSMQ, les messages présents sur le disque sont transférés à la file d'attente cible ou sont remis au service.</span><span class="sxs-lookup"><span data-stu-id="49ed9-160">Thus, if the MSMQ service were to stop and restart, the messages on disk is transferred to the target queue or delivered to the service.</span></span> <span data-ttu-id="49ed9-161">Lorsque sa valeur est `false`, les messages sont stockés dans un magasin volatil et sont perdus en cas d'arrêt et de redémarrage du service MSMQ.</span><span class="sxs-lookup"><span data-stu-id="49ed9-161">When set to `false`, the messages are stored in volatile store and are lost on stopping and restarting the MSMQ service.</span></span>  
  
 <span data-ttu-id="49ed9-162">Pour le transfert fiable `ExactlyOnce`, MSMQ requiert que la file d'attente soit transactionnelle.</span><span class="sxs-lookup"><span data-stu-id="49ed9-162">For `ExactlyOnce` reliable transfer, MSMQ requires the queue to be transactional.</span></span> <span data-ttu-id="49ed9-163">Par ailleurs, MSMQ requiert une transaction pour pouvoir lire les messages depuis une file d'attente transactionnelle.</span><span class="sxs-lookup"><span data-stu-id="49ed9-163">Also, MSMQ requires a transaction to read from a transactional queue.</span></span> <span data-ttu-id="49ed9-164">De ce fait, lorsque vous utilisez le `NetMsmqBinding`, n'oubliez pas qu'une transaction est requise pour envoyer ou recevoir des messages lorsque `ExactlyOnce` a la valeur `true`.</span><span class="sxs-lookup"><span data-stu-id="49ed9-164">As such, when you use the `NetMsmqBinding`, remember that a transaction is required to send or receive messages when `ExactlyOnce` is set to `true`.</span></span> <span data-ttu-id="49ed9-165">De même, MSMQ requiert que la file d'attente soit non transactionnelle pour une garantie optimale, comme lorsque `ExactlyOnce` a la valeur `false` et pour la messagerie volatile.</span><span class="sxs-lookup"><span data-stu-id="49ed9-165">Similarly, MSMQ requires the queue to be non-transactional for best-effort assurances, such as when `ExactlyOnce` is `false` and for volatile messaging.</span></span> <span data-ttu-id="49ed9-166">Ainsi, si la valeur `ExactlyOnce` est affectée à `false` ou à durable à `false`, vous ne pouvez pas envoyer ni recevoir de messages à l'aide d'une transaction.</span><span class="sxs-lookup"><span data-stu-id="49ed9-166">Thus, when setting `ExactlyOnce` to `false` or durable to `false`, you cannot send or receive using a transaction.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="49ed9-167">Assurez-vous que la file d'attente appropriée (transactionnelle ou non transactionnelle) est créée en fonction des paramètres des liaisons.</span><span class="sxs-lookup"><span data-stu-id="49ed9-167">Ensure that the correct queue (transactional or non-transactional) is created based on settings in the bindings.</span></span> <span data-ttu-id="49ed9-168">Si `ExactlyOnce` a la valeur `true`, utilisez une file d'attente transactionnelle ; sinon, utilisez une file d'attente non transactionnelle.</span><span class="sxs-lookup"><span data-stu-id="49ed9-168">If `ExactlyOnce` is `true`, use a transactional queue; otherwise, use a non-transactional queue.</span></span>  
  
#### <a name="dead-letter-queue-properties"></a><span data-ttu-id="49ed9-169">Propriétés de la file d'attente de lettres mortes</span><span class="sxs-lookup"><span data-stu-id="49ed9-169">Dead-Letter Queue Properties</span></span>  
 <span data-ttu-id="49ed9-170">La file d'attente de lettres mortes est utilisée pour stocker les messages dont la remise a échoué.</span><span class="sxs-lookup"><span data-stu-id="49ed9-170">The dead-letter queue is used to store messages that fail delivery.</span></span> <span data-ttu-id="49ed9-171">L'utilisateur peut écrire une logique de compensation qui lit les messages à partir de la file d'attente de lettres mortes.</span><span class="sxs-lookup"><span data-stu-id="49ed9-171">The user can write compensating logic that reads messages out of the dead-letter queue.</span></span>  
  
 <span data-ttu-id="49ed9-172">De nombreux systèmes de mise en file d'attente prévoient une file d'attente de lettres mortes à l'échelle du système.</span><span class="sxs-lookup"><span data-stu-id="49ed9-172">Many queuing systems provide for a system-wide dead-letter queue.</span></span> <span data-ttu-id="49ed9-173">MSMQ propose une file d'attente de lettres mortes non transactionnelle à l'échelle du système pour les messages dont la remise à des files d'attente non transactionnelles échoue et une file d'attente de lettres mortes transactionnelle à l'échelle du système pour les messages dont la remise à des files d'attente transactionnelles échoue.</span><span class="sxs-lookup"><span data-stu-id="49ed9-173">MSMQ provides a system-wide non-transactional dead-letter queue for messages that fail delivery to non-transactional queues and a system-wide transactional dead-letter queue for messages that fail delivery to transactional queues.</span></span>  
  
 <span data-ttu-id="49ed9-174">Si plusieurs clients qui envoient des messages à des files d'attente cibles différentes partagent le service MSMQ, tous les messages envoyés par les clients vont dans la même file d'attente de lettres mortes.</span><span class="sxs-lookup"><span data-stu-id="49ed9-174">If multiple clients sending messages to different target queues share the MSMQ service, all messages sent by the clients go to the same dead-letter queue.</span></span> <span data-ttu-id="49ed9-175">Ceci n'est pas toujours préférable.</span><span class="sxs-lookup"><span data-stu-id="49ed9-175">This is not always preferable.</span></span> <span data-ttu-id="49ed9-176">Pour une meilleure isolation, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] et MSMQ dans [!INCLUDE[wv](../../../../includes/wv-md.md)] proposent une file d'attente de lettres mortes personnalisée (ou file d'attente de lettres mortes propre à l'application) que l'utilisateur peut spécifier pour stocker les messages dont la remise échoue.</span><span class="sxs-lookup"><span data-stu-id="49ed9-176">For better isolation, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] and MSMQ in [!INCLUDE[wv](../../../../includes/wv-md.md)] provide a custom dead-letter queue (or application-specific dead-letter queue) that the user can specify to store messages that fail delivery.</span></span> <span data-ttu-id="49ed9-177">Par conséquent, des clients différents ne partagent pas la même file d'attente de lettres mortes.</span><span class="sxs-lookup"><span data-stu-id="49ed9-177">Therefore, different clients do not share the same dead-letter queue.</span></span>  
  
 <span data-ttu-id="49ed9-178">La liaison possède deux propriétés intéressantes :</span><span class="sxs-lookup"><span data-stu-id="49ed9-178">The binding has two properties of interest:</span></span>  
  
-   <span data-ttu-id="49ed9-179">`DeadLetterQueue` : cette propriété est une énumération qui indique si une file d'attente de lettres mortes est demandée.</span><span class="sxs-lookup"><span data-stu-id="49ed9-179">`DeadLetterQueue`: This property is an enumeration that indicates whether a dead-letter queue is requested.</span></span> <span data-ttu-id="49ed9-180">Cette énumération contient également le type de file d'attente de lettres mortes, si une est demandée.</span><span class="sxs-lookup"><span data-stu-id="49ed9-180">The enumeration also contains the kind of dead-letter queue, if one is requested.</span></span> <span data-ttu-id="49ed9-181">Les valeurs sont `None`, `System` et `Custom`.</span><span class="sxs-lookup"><span data-stu-id="49ed9-181">The values are `None`, `System`, and `Custom`.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="49ed9-182">l’interprétation de ces propriétés, consultez [lettres mortes à l’aide de files d’attente pour gérer les échecs de transfert de messages](../../../../docs/framework/wcf/feature-details/using-dead-letter-queues-to-handle-message-transfer-failures.md)</span><span class="sxs-lookup"><span data-stu-id="49ed9-182"> the interpretation of these properties, see [Using Dead-Letter Queues to Handle Message Transfer Failures](../../../../docs/framework/wcf/feature-details/using-dead-letter-queues-to-handle-message-transfer-failures.md)</span></span>  
  
-   <span data-ttu-id="49ed9-183">`CustomDeadLetterQueue` : cette propriété est l'adresse URI (Uniform Resource Identifier) de la file d'attente de lettres mortes propre à l'application.</span><span class="sxs-lookup"><span data-stu-id="49ed9-183">`CustomDeadLetterQueue`: This property is the Uniform Resource Identifier (URI) address of the application-specific dead-letter queue.</span></span> <span data-ttu-id="49ed9-184">Cela est nécessaire si `DeadLetterQueue`.`Custom`</span><span class="sxs-lookup"><span data-stu-id="49ed9-184">This is required if `DeadLetterQueue`.`Custom`</span></span> <span data-ttu-id="49ed9-185">est choisi.</span><span class="sxs-lookup"><span data-stu-id="49ed9-185">is chosen.</span></span>  
  
#### <a name="poison-message-handling-properties"></a><span data-ttu-id="49ed9-186">Propriétés de gestion des messages incohérents</span><span class="sxs-lookup"><span data-stu-id="49ed9-186">Poison Message Handling properties</span></span>  
 <span data-ttu-id="49ed9-187">Lorsque le service lit des messages à partir de la file d'attente cible par le biais d'une transaction, il risque de ne pas pouvoir traiter le message pour différentes raisons.</span><span class="sxs-lookup"><span data-stu-id="49ed9-187">When the service reads messages from the target queue under a transaction, the service may fail to process the message for various reasons.</span></span> <span data-ttu-id="49ed9-188">Le message est ensuite remis dans la file d'attente pour y être lu de nouveau.</span><span class="sxs-lookup"><span data-stu-id="49ed9-188">The message is then put back into the queue to be read again.</span></span> <span data-ttu-id="49ed9-189">Pour traiter les messages qui échouent de manière répétée, un ensemble de propriétés de gestion des messages incohérents peut être configuré dans la liaison.</span><span class="sxs-lookup"><span data-stu-id="49ed9-189">To deal with messages that fail repeatedly, a set of poison-message handling properties can be configured in the binding.</span></span> <span data-ttu-id="49ed9-190">Il existe quatre propriétés : `ReceiveRetryCount`, `MaxRetryCycles`, `RetryCycleDelay` et `ReceiveErrorHandling`.</span><span class="sxs-lookup"><span data-stu-id="49ed9-190">There are four properties: `ReceiveRetryCount`, `MaxRetryCycles`, `RetryCycleDelay`, and `ReceiveErrorHandling`.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="49ed9-191">Ces propriétés, consultez [des messages incohérents](../../../../docs/framework/wcf/feature-details/poison-message-handling.md).</span><span class="sxs-lookup"><span data-stu-id="49ed9-191"> these properties, see [Poison Message Handling](../../../../docs/framework/wcf/feature-details/poison-message-handling.md).</span></span>  
  
#### <a name="security-properties"></a><span data-ttu-id="49ed9-192">Propriétés de sécurité</span><span class="sxs-lookup"><span data-stu-id="49ed9-192">Security Properties</span></span>  
 <span data-ttu-id="49ed9-193">MSMQ expose son propre modèle de sécurité, comme les listes de contrôle d'accès sur une file d'attente ou l'envoi de messages authentifiés.</span><span class="sxs-lookup"><span data-stu-id="49ed9-193">MSMQ exposes its own security model, such as access control lists (ACLs) on a queue or sending authenticated messages.</span></span> <span data-ttu-id="49ed9-194">Le `NetMsmqBinding` expose ces propriétés de sécurité dans le cadre de ses paramètres de sécurité de transport.</span><span class="sxs-lookup"><span data-stu-id="49ed9-194">The `NetMsmqBinding` exposes these security properties as part of its transport security settings.</span></span> <span data-ttu-id="49ed9-195">La liaison pour la sécurité de transport a deux propriétés : `MsmqAuthenticationMode` et `MsmqProtectionLevel`.</span><span class="sxs-lookup"><span data-stu-id="49ed9-195">There are two properties in the binding for transport security: `MsmqAuthenticationMode` and `MsmqProtectionLevel`.</span></span> <span data-ttu-id="49ed9-196">Les paramètres de ces propriétés dépendent de la configuration de MSMQ.</span><span class="sxs-lookup"><span data-stu-id="49ed9-196">Settings in these properties depend on how MSMQ is configured.</span></span> [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]<span data-ttu-id="49ed9-197">[Sécurisation des Messages à l’aide de la sécurité de Transport](../../../../docs/framework/wcf/feature-details/securing-messages-using-transport-security.md).</span><span class="sxs-lookup"><span data-stu-id="49ed9-197"> [Securing Messages Using Transport Security](../../../../docs/framework/wcf/feature-details/securing-messages-using-transport-security.md).</span></span>  
  
 <span data-ttu-id="49ed9-198">Outre la sécurité de transport, le message SOAP lui-même peut être sécurisé à l'aide de la sécurité de message.</span><span class="sxs-lookup"><span data-stu-id="49ed9-198">In addition to transport security, the actual SOAP message itself can be secured using message security.</span></span> [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]<span data-ttu-id="49ed9-199">[Sécurisation des Messages à l’aide de la sécurité de Message](../../../../docs/framework/wcf/feature-details/securing-messages-using-message-security.md).</span><span class="sxs-lookup"><span data-stu-id="49ed9-199"> [Securing Messages Using Message Security](../../../../docs/framework/wcf/feature-details/securing-messages-using-message-security.md).</span></span>  
  
 <span data-ttu-id="49ed9-200">`MsmqTransportSecurity` expose également deux propriétés : `MsmqEncryptionAlgorithm` et `MsmqHashAlgorithm`.</span><span class="sxs-lookup"><span data-stu-id="49ed9-200">`MsmqTransportSecurity` also exposes two properties, `MsmqEncryptionAlgorithm` and `MsmqHashAlgorithm`.</span></span> <span data-ttu-id="49ed9-201">Il s'agit d'énumérations de différents algorithmes que vous pouvez choisir pour le chiffrement des messages en vue du transfert entre files d'attente et pour le hachage des signatures.</span><span class="sxs-lookup"><span data-stu-id="49ed9-201">These are enumerations of different algorithms to choose for queue-to-queue transfer encryption of messages and hashing of the signatures.</span></span>  
  
#### <a name="other-properties"></a><span data-ttu-id="49ed9-202">Autres propriétés</span><span class="sxs-lookup"><span data-stu-id="49ed9-202">Other Properties</span></span>  
 <span data-ttu-id="49ed9-203">Outre les propriétés précédentes, les propriétés spécifiques à MSMQ suivantes sont exposées dans la liaison :</span><span class="sxs-lookup"><span data-stu-id="49ed9-203">In addition to the preceding properties, other MSMQ-specific properties exposed in the binding include:</span></span>  
  
-   <span data-ttu-id="49ed9-204">`UseSourceJournal` : propriété qui indique que la journalisation source est activée.</span><span class="sxs-lookup"><span data-stu-id="49ed9-204">`UseSourceJournal`: A property to indicate that source journaling is turned on.</span></span> <span data-ttu-id="49ed9-205">La journalisation source est une fonctionnalité MSMQ qui effectue le suivi des messages qui ont été transmis avec succès à partir de la file d'attente de transmission.</span><span class="sxs-lookup"><span data-stu-id="49ed9-205">Source journaling is an MSMQ feature that keeps track of messages that have been successfully transmitted from the transmission queue.</span></span>  
  
-   <span data-ttu-id="49ed9-206">`UseMsmqTracing` : propriété permettant d'indiquer que le suivi MSMQ est activé.</span><span class="sxs-lookup"><span data-stu-id="49ed9-206">`UseMsmqTracing`: A property to indicate that MSMQ tracing is turned on.</span></span> <span data-ttu-id="49ed9-207">Le suivi MSMQ envoie des messages de rapport à une file d'attente de rapports chaque fois qu'un message arrive sur un ordinateur hébergeant un gestionnaire de files d'attente MSMQ ou le quitte.</span><span class="sxs-lookup"><span data-stu-id="49ed9-207">MSMQ tracing sends report messages to a report queue each time a message leaves or arrives at a machine hosting an MSMQ queue manager.</span></span>  
  
-   <span data-ttu-id="49ed9-208">`QueueTransferProtocol` : énumération du protocole à utiliser pour les transferts de messages entre files d'attente.</span><span class="sxs-lookup"><span data-stu-id="49ed9-208">`QueueTransferProtocol`: An enumeration of the protocol to use for queue-to-queue message transfers.</span></span> <span data-ttu-id="49ed9-209">MSMQ implémente un protocole natif de transfert entre files d'attente et un protocole SOAP nommé SRMP (SOAP Reliable Messaging Protocol).</span><span class="sxs-lookup"><span data-stu-id="49ed9-209">MSMQ implements a native queue-to-queue transfer protocol and a SOAP-based protocol called SOAP Reliable Messaging Protocol (SRMP).</span></span> <span data-ttu-id="49ed9-210">Le protocole SRMP est appliqué lors de l'utilisation du transport HTTP pour les transferts entre files d'attente.</span><span class="sxs-lookup"><span data-stu-id="49ed9-210">SRMP is used when using HTTP transport for queue-to-queue transfers.</span></span> <span data-ttu-id="49ed9-211">Le protocole SRMP sécurisé est appliqué lors de l'utilisation d'HTTPS pour les transferts entre files d'attente.</span><span class="sxs-lookup"><span data-stu-id="49ed9-211">SRMP secure is used when using HTTPS for queue-to-queue transfers.</span></span>  
  
-   <span data-ttu-id="49ed9-212">`UseActiveDirectory` : valeur booléenne permettant d'indiquer si Active Directory doit être utilisé pour la résolution d'adresse de file d'attente.</span><span class="sxs-lookup"><span data-stu-id="49ed9-212">`UseActiveDirectory`: A Boolean value to indicate whether the Active Directory must be used for queue address resolution.</span></span> <span data-ttu-id="49ed9-213">Par défaut, cette propriété a la valeur Off.</span><span class="sxs-lookup"><span data-stu-id="49ed9-213">By default, this is off.</span></span> [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]<span data-ttu-id="49ed9-214">[Points de terminaison et l’adressage de file d’attente de service](../../../../docs/framework/wcf/feature-details/service-endpoints-and-queue-addressing.md).</span><span class="sxs-lookup"><span data-stu-id="49ed9-214"> [Service Endpoints and Queue Addressing](../../../../docs/framework/wcf/feature-details/service-endpoints-and-queue-addressing.md).</span></span>  
  
### <a name="msmqintegrationbinding"></a><span data-ttu-id="49ed9-215">MsmqIntegrationBinding</span><span class="sxs-lookup"><span data-stu-id="49ed9-215">MsmqIntegrationBinding</span></span>  
 <span data-ttu-id="49ed9-216">Le `MsmqIntegrationBinding` est utilisé lorsque vous souhaitez qu'un point de terminaison [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] communique avec une application MSMQ existante écrite en C, C++, COM ou dans des API System.Messaging.</span><span class="sxs-lookup"><span data-stu-id="49ed9-216">The `MsmqIntegrationBinding` is used when you want a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] endpoint to communicate with an existing MSMQ application written in C, C++, COM, or System.Messaging APIs.</span></span>  
  
 <span data-ttu-id="49ed9-217">Les propriétés de liaison sont les mêmes que pour `NetMsmqBinding`,</span><span class="sxs-lookup"><span data-stu-id="49ed9-217">The binding properties are the same as for `NetMsmqBinding`.</span></span> <span data-ttu-id="49ed9-218">avec, toutefois, les différences suivantes :</span><span class="sxs-lookup"><span data-stu-id="49ed9-218">However, the following differences apply:</span></span>  
  
-   <span data-ttu-id="49ed9-219">Le contrat d'opération de `MsmqIntegrationBinding` est limité à un seul paramètre de type <xref:System.ServiceModel.MsmqIntegration.MsmqMessage%601>, dans lequel le paramètre de type est le type de corps.</span><span class="sxs-lookup"><span data-stu-id="49ed9-219">The operation contract for `MsmqIntegrationBinding` is restricted to taking a single parameter of type <xref:System.ServiceModel.MsmqIntegration.MsmqMessage%601> where the type parameter is the body type.</span></span>  
  
-   <span data-ttu-id="49ed9-220">De nombreuses propriétés de message MSMQ natives sont exposées dans le <xref:System.ServiceModel.MsmqIntegration.MsmqMessage%601> en vue d'être utilisées.</span><span class="sxs-lookup"><span data-stu-id="49ed9-220">Much of MSMQ native message properties are exposed in the <xref:System.ServiceModel.MsmqIntegration.MsmqMessage%601> for use.</span></span>  
  
-   <span data-ttu-id="49ed9-221">Pour faciliter la sérialisation et la désérialisation du corps des messages, des sérialiseurs, tels que XML et ActiveX, sont fournis.</span><span class="sxs-lookup"><span data-stu-id="49ed9-221">To help with serialization and deserialization of the message body, serializers such as XML and ActiveX are provided.</span></span>  
  
### <a name="sample-code"></a><span data-ttu-id="49ed9-222">Exemple de code</span><span class="sxs-lookup"><span data-stu-id="49ed9-222">Sample Code</span></span>  
 <span data-ttu-id="49ed9-223">Pour obtenir des instructions étape par étape sur la manière d'écrire des services WCF qui utilisent MSMQ, consultez les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="49ed9-223">For step by step instructions on how to write WCF services that use MSMQ see the following topics:</span></span>  
  
-   [<span data-ttu-id="49ed9-224">Comment : échanger des Messages avec des points de terminaison WCF et les Applications Message Queuing</span><span class="sxs-lookup"><span data-stu-id="49ed9-224">How to: Exchange Messages with WCF Endpoints and Message Queuing Applications</span></span>](../../../../docs/framework/wcf/feature-details/how-to-exchange-messages-with-wcf-endpoints-and-message-queuing-applications.md)  
  
-   [<span data-ttu-id="49ed9-225">Comment : Exchange en file d’attente de Messages avec des points de terminaison WCF</span><span class="sxs-lookup"><span data-stu-id="49ed9-225">How to: Exchange Queued Messages with WCF Endpoints</span></span>](../../../../docs/framework/wcf/feature-details/how-to-exchange-queued-messages-with-wcf-endpoints.md)  
  
 <span data-ttu-id="49ed9-226">Pour obtenir un exemple de code complet illustrant l'utilisation de MSMQ dans WCF, consultez les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="49ed9-226">For a completed code sample illustrating the use of MSMQ in WCF see the following topics:</span></span>  
  
-   [<span data-ttu-id="49ed9-227">Liaison MSMQ transactionnelles</span><span class="sxs-lookup"><span data-stu-id="49ed9-227">Transacted MSMQ Binding</span></span>](../../../../docs/framework/wcf/samples/transacted-msmq-binding.md)  
  
-   [<span data-ttu-id="49ed9-228">Volatile en file d’attente de Communication</span><span class="sxs-lookup"><span data-stu-id="49ed9-228">Volatile Queued Communication</span></span>](../../../../docs/framework/wcf/samples/volatile-queued-communication.md)  
  
-   [<span data-ttu-id="49ed9-229">Files d’attente de lettres mortes</span><span class="sxs-lookup"><span data-stu-id="49ed9-229">Dead Letter Queues</span></span>](../../../../docs/framework/wcf/samples/dead-letter-queues.md)  
  
-   [<span data-ttu-id="49ed9-230">Files d’attente et sessions</span><span class="sxs-lookup"><span data-stu-id="49ed9-230">Sessions and Queues</span></span>](../../../../docs/framework/wcf/samples/sessions-and-queues.md)  
  
-   [<span data-ttu-id="49ed9-231">Communication bidirectionnelle</span><span class="sxs-lookup"><span data-stu-id="49ed9-231">Two-Way Communication</span></span>](../../../../docs/framework/wcf/samples/two-way-communication.md)  
  
-   [<span data-ttu-id="49ed9-232">Traitement transactionnel par lots</span><span class="sxs-lookup"><span data-stu-id="49ed9-232">Transacted Batching</span></span>](../../../../docs/framework/wcf/samples/transacted-batching.md)  
  
-   [<span data-ttu-id="49ed9-233">LE PROTOCOLE SRMP</span><span class="sxs-lookup"><span data-stu-id="49ed9-233">SRMP</span></span>](../../../../docs/framework/wcf/samples/srmp.md)  
  
-   [<span data-ttu-id="49ed9-234">Sécurité de message sur Message Queuing</span><span class="sxs-lookup"><span data-stu-id="49ed9-234">Message Security over Message Queuing</span></span>](../../../../docs/framework/wcf/samples/message-security-over-message-queuing.md)  
  
## <a name="see-also"></a><span data-ttu-id="49ed9-235">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="49ed9-235">See Also</span></span>  
 [<span data-ttu-id="49ed9-236">Points de terminaison de service et l’adressage de file d’attente</span><span class="sxs-lookup"><span data-stu-id="49ed9-236">Service Endpoints and Queue Addressing</span></span>](../../../../docs/framework/wcf/feature-details/service-endpoints-and-queue-addressing.md)  
 [<span data-ttu-id="49ed9-237">Web hébergeant une Application en file d’attente</span><span class="sxs-lookup"><span data-stu-id="49ed9-237">Web Hosting a Queued Application</span></span>](../../../../docs/framework/wcf/feature-details/web-hosting-a-queued-application.md)
