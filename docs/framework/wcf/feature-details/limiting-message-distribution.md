---
title: Limitation de la distribution de messages
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 8b5ec4b8-1ce9-45ef-bb90-2c840456bcc1
caps.latest.revision: "10"
author: Erikre
ms.author: erikre
manager: erikre
ms.openlocfilehash: ab46b1c908e8eb61ea49315e120973f1ea381bc6
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/18/2017
---
# <a name="limiting-message-distribution"></a><span data-ttu-id="ef48a-102">Limitation de la distribution de messages</span><span class="sxs-lookup"><span data-stu-id="ef48a-102">Limiting Message Distribution</span></span>
<span data-ttu-id="ef48a-103">Le canal homologue est, de par sa conception, une maille de diffusion.</span><span class="sxs-lookup"><span data-stu-id="ef48a-103">Peer Channel is by design a broadcast mesh.</span></span> <span data-ttu-id="ef48a-104">Son modèle de saturation de base implique la distribution de chaque message envoyé par tout membre d'une maille à tous les autres membres de cette maille.</span><span class="sxs-lookup"><span data-stu-id="ef48a-104">Its basic flooding model involves distributing each message sent by any member of a mesh to all other members of that mesh.</span></span> <span data-ttu-id="ef48a-105">C'est idéal dans les situations où chaque message généré par un membre est pertinent et utile à tous les autres membres (par exemple, une salle de conversation).</span><span class="sxs-lookup"><span data-stu-id="ef48a-105">This is ideal in situations where every message generated by a member is relevant and useful to all other members (for example, a chat room).</span></span> <span data-ttu-id="ef48a-106">Toutefois, de nombreuses applications ont parfois besoin de limiter la distribution de messages.</span><span class="sxs-lookup"><span data-stu-id="ef48a-106">However, many applications have an occasional need for limiting message distribution.</span></span> <span data-ttu-id="ef48a-107">Par exemple, si un nouveau membre rejoint une maille et souhaite extraire le dernier message envoyé sur cette maille, cette demande ne doit pas être envoyée à chaque membre de la maille.</span><span class="sxs-lookup"><span data-stu-id="ef48a-107">For example, if a new member joins a mesh and wants to retrieve the last message sent through the mesh, this request does not need to be flooded to every member of the mesh.</span></span> <span data-ttu-id="ef48a-108">Elle peut être limitée aux voisins proches ou les messages générés localement peuvent être filtrés. Les messages peuvent également être envoyés à un nœud individuel sur la maille.</span><span class="sxs-lookup"><span data-stu-id="ef48a-108">The request could be limited to near neighbors, or locally generated messages can be filtered out. Messages can also be sent to an individual node on the mesh.</span></span> <span data-ttu-id="ef48a-109">Cette rubrique décrit l'utilisation du nombre de sauts, d'un filtre de propagation de messages, d'un filtre local ou d'une connexion directe pour contrôler la façon dont les messages sont transférés sur la maille, et fournit des recommandations générales sur le choix d'une approche.</span><span class="sxs-lookup"><span data-stu-id="ef48a-109">This topic discusses using Hop Count, a Message Propagation Filter, a local filter, or a direct connection to control how messages are forwarded throughout the mesh, and provides general guidelines for choosing an approach.</span></span>  
  
## <a name="hop-counts"></a><span data-ttu-id="ef48a-110">Nombres de sauts</span><span class="sxs-lookup"><span data-stu-id="ef48a-110">Hop Counts</span></span>  
 <span data-ttu-id="ef48a-111">Le concept de `PeerHopCount` est semblable à la valeur TTL (durée de vie) utilisée par le protocole IP.</span><span class="sxs-lookup"><span data-stu-id="ef48a-111">The concept of `PeerHopCount` is similar to TTL (Time-To-Live) used in IP protocol.</span></span> <span data-ttu-id="ef48a-112">La valeur du `PeerHopCount` est liée à une instance de message et spécifie le nombre de fois qu'un message doit être transféré avant d'être supprimé.</span><span class="sxs-lookup"><span data-stu-id="ef48a-112">The value of `PeerHopCount` is tied to a message instance, and it specifies how many times a message should be forwarded before being dropped.</span></span> <span data-ttu-id="ef48a-113">Chaque fois qu'un client canal homologue reçoit un message, il l'examine afin de déterminer si le `PeerHopCount` est spécifié.</span><span class="sxs-lookup"><span data-stu-id="ef48a-113">Each time a message is received by a Peer Channel client, the client examines the message to see if `PeerHopCount` is specified.</span></span> <span data-ttu-id="ef48a-114">S'il est spécifié, le client décrémente la valeur du nombre de sauts de un avant d'envoyer le message aux nœuds voisins.</span><span class="sxs-lookup"><span data-stu-id="ef48a-114">If it is specified, then the client decrements the hop count value by one before forwarding the message to neighboring nodes.</span></span> <span data-ttu-id="ef48a-115">Lorsqu'un client reçoit un message dont la valeur du nombre de sauts est égale à zéro, il le traite mais ne le transfère pas aux voisins.</span><span class="sxs-lookup"><span data-stu-id="ef48a-115">When a client receives a message with a hop count value of zero, the client processes the message, but does not forward the message to neighbors.</span></span>  
  
 <span data-ttu-id="ef48a-116">Le nombre de sauts peut être ajouté à un message en ajoutant `PeerHopCount` en tant qu'attribut à la propriété ou au champ applicable dans l'implémentation de la classe de message.</span><span class="sxs-lookup"><span data-stu-id="ef48a-116">Hop count may be added to a message by adding `PeerHopCount` as an attribute to the applicable property or field in the implementation of the message class.</span></span> <span data-ttu-id="ef48a-117">Vous pouvez affecter à cet attribut une valeur spécifique avant d'envoyer le message à la maille.</span><span class="sxs-lookup"><span data-stu-id="ef48a-117">You can set this to a specific value before sending the message to the mesh.</span></span> <span data-ttu-id="ef48a-118">Vous pouvez ainsi utiliser le nombre de sauts pour limiter la distribution des messages sur la maille lorsque cela est nécessaire, ce qui évite la duplication de messages superflus.</span><span class="sxs-lookup"><span data-stu-id="ef48a-118">In this manner, you can use hop count to limit distribution of messages throughout the mesh when necessary, potentially avoiding unnecessary message duplication.</span></span> <span data-ttu-id="ef48a-119">Cela est utile dans les cas où la maille comprend un grand nombre de données redondantes ou pour envoyer un message aux voisins immédiats ou voisins se trouvant à quelques sauts.</span><span class="sxs-lookup"><span data-stu-id="ef48a-119">This is useful in cases where the mesh contains a high amount of redundant data, or for sending a message to immediate neighbors, or neighbors within a few hops.</span></span>  
  
-   <span data-ttu-id="ef48a-120">Pour les extraits de code et des informations connexes, consultez la [blog de canal homologue](http://go.microsoft.com/fwlink/?LinkID=114531) (http://go.microsoft.com/fwlink/?LinkID=114531).</span><span class="sxs-lookup"><span data-stu-id="ef48a-120">For code snippets and related information, see the [Peer Channel blog](http://go.microsoft.com/fwlink/?LinkID=114531) (http://go.microsoft.com/fwlink/?LinkID=114531).</span></span>  
  
## <a name="message-propagation-filter"></a><span data-ttu-id="ef48a-121">Filtre de propagation de messages</span><span class="sxs-lookup"><span data-stu-id="ef48a-121">Message Propagation Filter</span></span>  
 <span data-ttu-id="ef48a-122">`MessagePropagationFilter` peut être utilisé pour le contrôle personnalisé de saturation de messages, en particulier lorsque le contenu des messages ou d'autres scénarios spécifiques déterminent la propagation.</span><span class="sxs-lookup"><span data-stu-id="ef48a-122">`MessagePropagationFilter` can be used for customized control of message flooding, especially when the content of the message or other specific scenarios determine propagation.</span></span> <span data-ttu-id="ef48a-123">Le filtre prend les décisions de propagation pour chaque message passant par le nœud.</span><span class="sxs-lookup"><span data-stu-id="ef48a-123">The filter makes propagation decisions for every message that passes through the node.</span></span> <span data-ttu-id="ef48a-124">C'est le cas des messages reçus par votre nœud en provenance d'autres emplacements de la maille ainsi que des messages créés par votre application.</span><span class="sxs-lookup"><span data-stu-id="ef48a-124">This is true for messages that originated elsewhere in the mesh that your node has received as well as messages created by your application.</span></span> <span data-ttu-id="ef48a-125">Le filtre ayant accès au message et à son origine, les décisions relatives à son transfert ou à sa suppression peuvent être basées sur toutes les informations disponibles.</span><span class="sxs-lookup"><span data-stu-id="ef48a-125">The filter has access to both the message and its origination, so decisions about forwarding or dropping the message can be based on the full information available.</span></span>  
  
 <span data-ttu-id="ef48a-126"><xref:System.ServiceModel.PeerMessagePropagationFilter> est une classe abstraite de base avec une fonction unique, <xref:System.ServiceModel.PeerMessagePropagationFilter.ShouldMessagePropagate%2A>.</span><span class="sxs-lookup"><span data-stu-id="ef48a-126"><xref:System.ServiceModel.PeerMessagePropagationFilter> is a base abstract class with a single function, <xref:System.ServiceModel.PeerMessagePropagationFilter.ShouldMessagePropagate%2A>.</span></span> <span data-ttu-id="ef48a-127">Le premier argument de l'appel de méthode passe dans une copie complète du message.</span><span class="sxs-lookup"><span data-stu-id="ef48a-127">The first argument of the method call passes in a full copy of the message.</span></span> <span data-ttu-id="ef48a-128">La modification du message n'entraîne pas le changement du message proprement dit.</span><span class="sxs-lookup"><span data-stu-id="ef48a-128">Any changes made to the message do not affect the actual message.</span></span> <span data-ttu-id="ef48a-129">Le dernier argument de l'appel de méthode identifie l'origine du message (`PeerMessageOrigination.Local` ou `PeerMessageOrigination.Remote`).</span><span class="sxs-lookup"><span data-stu-id="ef48a-129">The last argument of the method call identifies the origin of the message (`PeerMessageOrigination.Local` or `PeerMessageOrigination.Remote`).</span></span> <span data-ttu-id="ef48a-130">Les implémentations concrètes de cette méthode doivent retourner une constante à partir de l'énumération <xref:System.ServiceModel.PeerMessagePropagation> indiquant que le message doit être transféré à l'application locale (`Local`), à des clients distants (`Remote`), aux deux (`LocalAndRemote`), ou ni à l'un ni à l'autre (`None`).</span><span class="sxs-lookup"><span data-stu-id="ef48a-130">Concrete implementations of this method must return a constant from the <xref:System.ServiceModel.PeerMessagePropagation> enumeration indicating that the message is to be forwarded to the local application (`Local`), forwarded to remote clients (`Remote`), both (`LocalAndRemote`), or neither (`None`).</span></span> <span data-ttu-id="ef48a-131">Vous pouvez appliquer ce filtre en accédant à l'objet `PeerNode` correspondant et en spécifiant une instance de la classe de filtre de propagation dérivée dans la propriété `PeerNode.MessagePropagationFilter`.</span><span class="sxs-lookup"><span data-stu-id="ef48a-131">This filter can be applied by accessing the corresponding `PeerNode` object and specifying an instance of the derived propagation filter class in the `PeerNode.MessagePropagationFilter` property.</span></span> <span data-ttu-id="ef48a-132">Assurez-vous que le filtre de propagation est joint avant d'ouvrir le canal homologue.</span><span class="sxs-lookup"><span data-stu-id="ef48a-132">Ensure that the propagation filter is attached before opening the Peer Channel.</span></span>  
  
-   <span data-ttu-id="ef48a-133">Pour les extraits de code et des informations connexes, consultez la [blog de canal homologue](http://go.microsoft.com/fwlink/?LinkID=114532) (http://go.microsoft.com/fwlink/?LinkID=114532).</span><span class="sxs-lookup"><span data-stu-id="ef48a-133">For code snippets and related information, see the [Peer Channel blog](http://go.microsoft.com/fwlink/?LinkID=114532) (http://go.microsoft.com/fwlink/?LinkID=114532).</span></span>  
  
## <a name="contacting-an-individual-node-in-the-mesh"></a><span data-ttu-id="ef48a-134">Contacter un nœud individuel dans la maille</span><span class="sxs-lookup"><span data-stu-id="ef48a-134">Contacting an Individual Node in the Mesh</span></span>  
 <span data-ttu-id="ef48a-135">Vous pouvez contacter un nœud individuel dans une maille en configurant un filtre local ou une connexion directe.</span><span class="sxs-lookup"><span data-stu-id="ef48a-135">An individual node in a mesh can be contacted by setting up a local filter, or by setting up a direct connection.</span></span>  
  
 <span data-ttu-id="ef48a-136">Si chaque nœud d'une maille a son propre ID, un ID de destination peut être spécifié dans l'implémentation de votre message.</span><span class="sxs-lookup"><span data-stu-id="ef48a-136">If the nodes in a mesh each have an individual ID, a destination ID can be specified in the implementation of your message.</span></span> <span data-ttu-id="ef48a-137">Vous pouvez configurer un filtre local en écrivant une fonction dans votre contrat de message qui ne rendra visible le message au nœud actuel que si son ID correspond à l'ID de destination spécifié.</span><span class="sxs-lookup"><span data-stu-id="ef48a-137">A local filter can be set up by writing a function in your message contract that will only display the message to the current node if its ID matches the destination ID you specified.</span></span> <span data-ttu-id="ef48a-138">La maille transportant le message, la surcharge de traitement liée à la configuration d'une nouvelle connexion ne pèse donc pas.</span><span class="sxs-lookup"><span data-stu-id="ef48a-138">The mesh transports the message, so the overhead of setting up a new connection does not have to be incurred.</span></span> <span data-ttu-id="ef48a-139">En revanche, il y a une perte de rendement puisque le message est envoyé plusieurs fois à travers la maille.</span><span class="sxs-lookup"><span data-stu-id="ef48a-139">However, there is a loss of efficiency since the message is sent many times throughout the mesh.</span></span> <span data-ttu-id="ef48a-140">Cette approche convient pour envoyer des messages à des membres individuels d'une maille tant que les messages ne sont pas trop volumineux ni trop fréquents.</span><span class="sxs-lookup"><span data-stu-id="ef48a-140">This works well for sending messages to individual members of a mesh as long as the messages are neither too big nor too frequent.</span></span>  
  
 <span data-ttu-id="ef48a-141">Pour les connexions haut débit permanentes, il est préférable d'opter pour les connexions directes.</span><span class="sxs-lookup"><span data-stu-id="ef48a-141">For long-lasting, high-bandwidth connections, direct connections are preferable.</span></span> <span data-ttu-id="ef48a-142">Vous pouvez envoyer des informations de connexion sur la maille, puis configurer une connexion directe de votre choix pour envoyer/recevoir des messages.</span><span class="sxs-lookup"><span data-stu-id="ef48a-142">You can send connection information over the mesh, and then set up a direct connection of your choosing to send/receive messages.</span></span>  
  
## <a name="choosing-an-approach-for-limiting-message-distribution"></a><span data-ttu-id="ef48a-143">Choix d'une approche pour limiter la distribution des messages</span><span class="sxs-lookup"><span data-stu-id="ef48a-143">Choosing an Approach for Limiting Message Distribution</span></span>  
 <span data-ttu-id="ef48a-144">Lorsque vous découvrez un scénario dans lequel vous devez limiter la distribution des messages, posez-vous les questions suivantes :</span><span class="sxs-lookup"><span data-stu-id="ef48a-144">When you discover a scenario in which you need to limit message distribution, ask yourself the following questions:</span></span>  
  
-   <span data-ttu-id="ef48a-145">**Qui** doit recevoir le message ?</span><span class="sxs-lookup"><span data-stu-id="ef48a-145">**Who** needs to receive the message?</span></span> <span data-ttu-id="ef48a-146">Un nœud voisin seulement ?</span><span class="sxs-lookup"><span data-stu-id="ef48a-146">Just one neighbor node?</span></span> <span data-ttu-id="ef48a-147">Un nœud ailleurs dans la maille ?</span><span class="sxs-lookup"><span data-stu-id="ef48a-147">A node somewhere else in the mesh?</span></span> <span data-ttu-id="ef48a-148">La moitié de la maille ?</span><span class="sxs-lookup"><span data-stu-id="ef48a-148">Half the mesh?</span></span>  
  
-   <span data-ttu-id="ef48a-149">**La fréquence à laquelle** sera envoyé ce message ?</span><span class="sxs-lookup"><span data-stu-id="ef48a-149">**How often** will this message be sent?</span></span>  
  
-   <span data-ttu-id="ef48a-150">Le type de **la bande passante** utilisera ce message ?</span><span class="sxs-lookup"><span data-stu-id="ef48a-150">What kind of **bandwidth** will this message use?</span></span>  
  
 <span data-ttu-id="ef48a-151">Les réponses à ces questions peuvent vous aider à déterminer s'il faut utiliser le nombre de sauts, un filtre de propagation de messages, un filtre local ou une connexion directe.</span><span class="sxs-lookup"><span data-stu-id="ef48a-151">The answers to these questions can help you determine whether to use Hop Count, a Message Propagation Filter, a local filter, or a direct connection.</span></span> <span data-ttu-id="ef48a-152">Prenez en compte les recommandations générales suivantes :</span><span class="sxs-lookup"><span data-stu-id="ef48a-152">Consider the following general guidelines:</span></span>  
  
-   <span data-ttu-id="ef48a-153">**Qui**</span><span class="sxs-lookup"><span data-stu-id="ef48a-153">**Who**</span></span>  
  
    -   <span data-ttu-id="ef48a-154">*Nœud individuel*: filtre Local ou une connexion directe.</span><span class="sxs-lookup"><span data-stu-id="ef48a-154">*Individual node*:  Local filter or direct connection.</span></span>  
  
    -   <span data-ttu-id="ef48a-155">*Voisins à une certaine proximité*: PeerHopCount.</span><span class="sxs-lookup"><span data-stu-id="ef48a-155">*Neighbors within a certain vicinity*:  PeerHopCount.</span></span>  
  
    -   <span data-ttu-id="ef48a-156">*Sous-ensemble complexe de la maille*: MessagePropagationFilter.</span><span class="sxs-lookup"><span data-stu-id="ef48a-156">*Complex subset of the mesh*:  MessagePropagationFilter.</span></span>  
  
-   <span data-ttu-id="ef48a-157">**La fréquence à laquelle**</span><span class="sxs-lookup"><span data-stu-id="ef48a-157">**How often**</span></span>  
  
    -   <span data-ttu-id="ef48a-158">*Très fréquentes*: connexion directe, PeerHopCount, MessagePropagationFilter.</span><span class="sxs-lookup"><span data-stu-id="ef48a-158">*Very frequent*:  Direct connection, PeerHopCount, MessagePropagationFilter.</span></span>  
  
    -   <span data-ttu-id="ef48a-159">*Occasionnelles*: filtre Local.</span><span class="sxs-lookup"><span data-stu-id="ef48a-159">*Occasional*:  Local filter.</span></span>  
  
-   <span data-ttu-id="ef48a-160">**Utilisation de bande passante**</span><span class="sxs-lookup"><span data-stu-id="ef48a-160">**Bandwidth use**</span></span>  
  
    -   <span data-ttu-id="ef48a-161">*Haute*: connexion directe, utilisation de MessagePropagationFilter ou filtre local.</span><span class="sxs-lookup"><span data-stu-id="ef48a-161">*High*:  Direct connection, less advisable to use MessagePropagationFilter or local filter.</span></span>  
  
    -   <span data-ttu-id="ef48a-162">*Faible*: tout, connexion directe probablement ne pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="ef48a-162">*Low*:  Any, direct connection probably not needed.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ef48a-163">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="ef48a-163">See Also</span></span>  
 [<span data-ttu-id="ef48a-164">Création d’une Application de canal homologue</span><span class="sxs-lookup"><span data-stu-id="ef48a-164">Building a Peer Channel Application</span></span>](../../../../docs/framework/wcf/feature-details/building-a-peer-channel-application.md)
