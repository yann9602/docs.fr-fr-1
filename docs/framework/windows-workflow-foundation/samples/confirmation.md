---
title: Confirmation
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 8637aeaf-ac9e-49b8-93f4-da15dee45277
caps.latest.revision: "7"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 1a686a07ed41aafd476dbb1934c178558d90d948
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/02/2017
---
# <a name="confirmation"></a><span data-ttu-id="c49f7-102">Confirmation</span><span class="sxs-lookup"><span data-stu-id="c49f7-102">Confirmation</span></span>
<span data-ttu-id="c49f7-103">Cet exemple présente quatre scénarios courants se rapportant à l'utilisation de <xref:System.Activities.Statements.CompensableActivity> et à la confirmation.</span><span class="sxs-lookup"><span data-stu-id="c49f7-103">This sample shows four common scenarios surrounding the use of <xref:System.Activities.Statements.CompensableActivity> and confirmation.</span></span> <span data-ttu-id="c49f7-104">L'exemple exécute quatre workflows pour illustrer la confirmation.</span><span class="sxs-lookup"><span data-stu-id="c49f7-104">The sample runs four workflows to show confirmation.</span></span> <span data-ttu-id="c49f7-105">Cet exemple est disponible dans les versions déclarative et impérative.</span><span class="sxs-lookup"><span data-stu-id="c49f7-105">This sample is available in declarative and imperative versions.</span></span>  
  
## <a name="confirm-a-compensable-activity"></a><span data-ttu-id="c49f7-106">Confirmer une activité compensable</span><span class="sxs-lookup"><span data-stu-id="c49f7-106">Confirm a Compensable Activity</span></span>  
 <span data-ttu-id="c49f7-107">Le premier workflow, qui est composé d'une séquence de deux instances <xref:System.Activities.Statements.CompensableActivity>, montre comment confirmer une activité compensable.</span><span class="sxs-lookup"><span data-stu-id="c49f7-107">The first workflow demonstrates how to confirm a compensable activity and consists of a sequence of two <xref:System.Activities.Statements.CompensableActivity> instances.</span></span> <span data-ttu-id="c49f7-108">Après l'achèvement du deuxième <xref:System.Activities.Statements.CompensableActivity>, une activité de confirmation confirme la première activité.</span><span class="sxs-lookup"><span data-stu-id="c49f7-108">After the completion of the second <xref:System.Activities.Statements.CompensableActivity> a confirm activity confirms the first activity.</span></span> <span data-ttu-id="c49f7-109">Lorsque le workflow se termine correctement, toutes les instances <xref:System.Activities.Statements.CompensableActivity> qui n'ont pas été confirmées ou compensées sont automatiquement confirmées dans l'ordre par défaut.</span><span class="sxs-lookup"><span data-stu-id="c49f7-109">When the workflow successfully completes, all <xref:System.Activities.Statements.CompensableActivity> instances that have not been confirmed or compensated are automatically confirmed using the default order.</span></span> <span data-ttu-id="c49f7-110">Sans la confirmation, le deuxième <xref:System.Activities.Statements.CompensableActivity> aurait été confirmé en premier.</span><span class="sxs-lookup"><span data-stu-id="c49f7-110">Without the confirm, the second <xref:System.Activities.Statements.CompensableActivity> would have been confirmed first.</span></span>  
  
## <a name="explicit-compensation"></a><span data-ttu-id="c49f7-111">Compensation explicite</span><span class="sxs-lookup"><span data-stu-id="c49f7-111">Explicit Compensation</span></span>  
 <span data-ttu-id="c49f7-112">Le deuxième scénario présente l'effet sur la confirmation par défaut lorsqu'un <xref:System.Activities.Statements.CompensableActivity> est compensé de manière explicite.</span><span class="sxs-lookup"><span data-stu-id="c49f7-112">The second scenario shows the affect on default confirmation when a <xref:System.Activities.Statements.CompensableActivity> is explicitly compensated.</span></span> <span data-ttu-id="c49f7-113">Le workflow est composé d'une séquence de deux activités <xref:System.Activities.Statements.CompensableActivity>. Une fois la deuxième terminée, la première est compensée de manière explicite.</span><span class="sxs-lookup"><span data-stu-id="c49f7-113">The workflow consists of a sequence of two <xref:System.Activities.Statements.CompensableActivity> activities, after the second completes the first is explicitly compensated.</span></span> <span data-ttu-id="c49f7-114">Par conséquent, lorsque le workflow se termine, seul le deuxième <xref:System.Activities.Statements.CompensableActivity> est confirmé.</span><span class="sxs-lookup"><span data-stu-id="c49f7-114">As a result when the workflow, completes only the second <xref:System.Activities.Statements.CompensableActivity> is confirmed.</span></span>  
  
## <a name="controlling-the-order-of-confirmation-for-nested-compensableactivity-activities"></a><span data-ttu-id="c49f7-115">Contrôle de l'ordre de confirmation pour les activités CompensableActivity imbriquées</span><span class="sxs-lookup"><span data-stu-id="c49f7-115">Controlling the Order of Confirmation for Nested CompensableActivity Activities</span></span>  
 <span data-ttu-id="c49f7-116">Le troisième scénario montre comment contrôler l'ordre de confirmation pour des <xref:System.Activities.Statements.CompensableActivity> imbriqués.</span><span class="sxs-lookup"><span data-stu-id="c49f7-116">The third scenario shows how to control the order of confirmation for nested <xref:System.Activities.Statements.CompensableActivity>.</span></span> <span data-ttu-id="c49f7-117">Le scénario est composé d'un <xref:System.Activities.Statements.CompensableActivity> comme racine du workflow.</span><span class="sxs-lookup"><span data-stu-id="c49f7-117">The scenario consists of a <xref:System.Activities.Statements.CompensableActivity> as the root of the workflow.</span></span> <span data-ttu-id="c49f7-118">Le corps du <xref:System.Activities.Statements.CompensableActivity> racine est une séquence de trois <xref:System.Activities.Statements.CompensableActivity>.</span><span class="sxs-lookup"><span data-stu-id="c49f7-118">The body of the root <xref:System.Activities.Statements.CompensableActivity> is a sequence of three <xref:System.Activities.Statements.CompensableActivity>.</span></span> <span data-ttu-id="c49f7-119">Le <xref:System.Activities.Statements.CompensableActivity.ConfirmationHandler%2A> pour le <xref:System.Activities.Statements.CompensableActivity> racine est une séquence qui spécifie le premier <xref:System.Activities.Statements.CompensableActivity> imbriqué doit être confirmé, puis le deuxième.</span><span class="sxs-lookup"><span data-stu-id="c49f7-119">The <xref:System.Activities.Statements.CompensableActivity.ConfirmationHandler%2A> for the root <xref:System.Activities.Statements.CompensableActivity> is a sequence that specifies to confirm the first then the second nested <xref:System.Activities.Statements.CompensableActivity>.</span></span> <span data-ttu-id="c49f7-120">Lorsque le workflow se termine, il confirme le <xref:System.Activities.Statements.CompensableActivity> racine, qui confirme ensuite le premier, le deuxième et le troisième <xref:System.Activities.Statements.CompensableActivity> imbriqués, dans cet ordre.</span><span class="sxs-lookup"><span data-stu-id="c49f7-120">When the workflow completes it confirms the root <xref:System.Activities.Statements.CompensableActivity>, which then confirms the first, second and third nested <xref:System.Activities.Statements.CompensableActivity>, in that order.</span></span> <span data-ttu-id="c49f7-121">Par conséquent, l'ordre de confirmation par défaut est fondamentalement inversé.</span><span class="sxs-lookup"><span data-stu-id="c49f7-121">As a result, the default confirmation order is essentially reversed.</span></span> <span data-ttu-id="c49f7-122">Étant donné que le troisième <xref:System.Activities.Statements.CompensableActivity> n'a pas été explicitement confirmé dans le cadre du <xref:System.Activities.Statements.CompensableActivity> racine par <xref:System.Activities.Statements.CompensableActivity.ConfirmationHandler%2A>, il est confirmé d'après l'ordre par défaut.</span><span class="sxs-lookup"><span data-stu-id="c49f7-122">Because the third <xref:System.Activities.Statements.CompensableActivity> was not explicitly confirmed as part of the root <xref:System.Activities.Statements.CompensableActivity> by the <xref:System.Activities.Statements.CompensableActivity.ConfirmationHandler%2A>, it is confirmed according to the default order.</span></span> <span data-ttu-id="c49f7-123">Toutefois, étant donné qu'il est le seul <xref:System.Activities.Statements.CompensableActivity> non confirmé, cela signifies simplement qu'il est confirmé.</span><span class="sxs-lookup"><span data-stu-id="c49f7-123">However, because it is the only unconfirmed <xref:System.Activities.Statements.CompensableActivity> this just means it is confirmed.</span></span>  
  
## <a name="scoping-of-variables"></a><span data-ttu-id="c49f7-124">Étendue des variables</span><span class="sxs-lookup"><span data-stu-id="c49f7-124">Scoping of Variables</span></span>  
 <span data-ttu-id="c49f7-125">Le quatrième scénario montre comment la durée de vie des variables définies pour un <xref:System.Activities.Statements.CompensableActivity> ou l'un de ses parents se trouve toujours dans l'étendue lorsque les gestionnaires <xref:System.Activities.Statements.CompensableActivity.CompensationHandler%2A>, <xref:System.Activities.Statements.CompensableActivity.ConfirmationHandler%2A> ou <xref:System.Activities.Statements.CompensableActivity.CancellationHandler%2A> sont exécutés, même si l'activité ou le workflow sont terminés.</span><span class="sxs-lookup"><span data-stu-id="c49f7-125">The fourth scenario shows how the lifetime of variables defined for a <xref:System.Activities.Statements.CompensableActivity> or one of their parents are still in scope when the <xref:System.Activities.Statements.CompensableActivity.CompensationHandler%2A>, <xref:System.Activities.Statements.CompensableActivity.ConfirmationHandler%2A> or <xref:System.Activities.Statements.CompensableActivity.CancellationHandler%2A> handlers are executed even if the activity has completed or the workflow has completed.</span></span> <span data-ttu-id="c49f7-126">Le workflow est composé d'une séquence de deux <xref:System.Activities.Statements.CompensableActivity>.</span><span class="sxs-lookup"><span data-stu-id="c49f7-126">The workflow consists of a sequence of two <xref:System.Activities.Statements.CompensableActivity>.</span></span> <span data-ttu-id="c49f7-127">Dans le corps du premier, la valeur de la variable `mySum` est la somme de 5 et de 10, et le résultat est imprimé.</span><span class="sxs-lookup"><span data-stu-id="c49f7-127">In the body of the first, the variable `mySum` is set to the sum of 5 and 10 and the result printed.</span></span> <span data-ttu-id="c49f7-128">Dans le corps du deuxième <xref:System.Activities.Statements.CompensableActivity>, la valeur de la somme est la somme existante à laquelle est ajoutée la valeur 7, et le résultat est imprimé.</span><span class="sxs-lookup"><span data-stu-id="c49f7-128">In the body of the second <xref:System.Activities.Statements.CompensableActivity>, the sum is set to the sum of the existing sum and 7 and the result printed.</span></span> <span data-ttu-id="c49f7-129">Un gestionnaire de confirmation personnalisé est défini pour le premier <xref:System.Activities.Statements.CompensableActivity>, qui imprime la somme, soustrait 7, et imprime à nouveau la somme.</span><span class="sxs-lookup"><span data-stu-id="c49f7-129">A custom confirmation handler is defined for the first <xref:System.Activities.Statements.CompensableActivity>, which prints the sum, subtracts 7 and prints the sum again.</span></span> <span data-ttu-id="c49f7-130">En inspectant les sommes imprimées, il est clair que la variable se trouve dans l'étendue non seulement pour les corps des deux <xref:System.Activities.Statements.CompensableActivity>, mais également pour <xref:System.Activities.Statements.CompensableActivity.ConfirmationHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="c49f7-130">It is clear by inspecting the printed sums that the variable is in scope not only for the bodies of both <xref:System.Activities.Statements.CompensableActivity> but the <xref:System.Activities.Statements.CompensableActivity.ConfirmationHandler%2A> as well.</span></span>  
  
#### <a name="to-run-the-sample"></a><span data-ttu-id="c49f7-131">Pour exécuter l'exemple</span><span class="sxs-lookup"><span data-stu-id="c49f7-131">To run the sample</span></span>  
  
1.  <span data-ttu-id="c49f7-132">Chargez la solution dans [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c49f7-132">Load the solution in [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)].</span></span>  
  
2.  <span data-ttu-id="c49f7-133">Exécutez l'application ConfirmationSample.exe.</span><span class="sxs-lookup"><span data-stu-id="c49f7-133">Run the ConfirmationSample.exe application.</span></span>  
  
3.  <span data-ttu-id="c49f7-134">Observez la sortie suivante :</span><span class="sxs-lookup"><span data-stu-id="c49f7-134">Observe the following output:</span></span>  
  
 <span data-ttu-id="c49f7-135">**Confirmation : début explicite de workflowCompensableActivity1 : BodyCompensableActivity2 : BodyCompensableActivity1 : HandlerEnd de Confirmation de workflowCompensableActivity2 : Confirmation HandlerExplicit compensation : début de workflowCompensableActivity1 : BodyCompensableActivity2 : BodyCompensableActivity1 : HandlerEnd de Compensation de workflowCompensableActivity2 : HandlerCustom de Confirmation, Gestionnaire de confirmation : début de workflowCompensableActivity1 : BodyCompensableActivity2 : BodyCompensableActivity3 : BodyEnd de workflowCompensableActivity1 : Confirmation HandlerCompensableActivity2 : Confirmation HandlerCompensableActivity3 : accès HandlerVariable de Confirmation dans un gestionnaire de confirmation : Début de workflowCompensableActivity1 : BodyCompensableActivity1 : la somme est : 15CompensableActivity2 : BodyCompensableActivity2 : ajout de 7 à la sumCompensableActivity2 : la somme est : 22End de workflowCompensableActivity2 : Confirmation HandlerCompensableActivity1 : Confirmation HandlerCompensableActivity2 : la somme est : 22CompensableActivity2 : après soustraction de 12, la somme est maintenant : entrée 10Press pour quitter.**</span><span class="sxs-lookup"><span data-stu-id="c49f7-135">**Explicit confirmation:Start of workflowCompensableActivity1: BodyCompensableActivity2: BodyCompensableActivity1: Confirmation HandlerEnd of workflowCompensableActivity2: Confirmation HandlerExplicit compensation:Start of workflowCompensableActivity1: BodyCompensableActivity2: BodyCompensableActivity1: Compensation HandlerEnd of workflowCompensableActivity2: Confirmation HandlerCustom confirmation handler:Start of workflowCompensableActivity1: BodyCompensableActivity2: BodyCompensableActivity3: BodyEnd of workflowCompensableActivity1: Confirmation HandlerCompensableActivity2: Confirmation HandlerCompensableActivity3: Confirmation HandlerVariable access in a confirmation handler:Start of workflowCompensableActivity1: BodyCompensableActivity1: The sum is: 15CompensableActivity2: BodyCompensableActivity2: Adding 7 to the sumCompensableActivity2: The sum is now: 22End of workflowCompensableActivity2: Confirmation HandlerCompensableActivity1: Confirmation HandlerCompensableActivity2: The sum is: 22CompensableActivity2: After subtracting 12 the sum is now: 10Press ENTER to exit.**</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="c49f7-136">Les exemples peuvent déjà être installés sur votre ordinateur.</span><span class="sxs-lookup"><span data-stu-id="c49f7-136">The samples may already be installed on your machine.</span></span> <span data-ttu-id="c49f7-137">Recherchez le répertoire (par défaut) suivant avant de continuer.</span><span class="sxs-lookup"><span data-stu-id="c49f7-137">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="c49f7-138">Si ce répertoire n’existe pas, accédez à la page [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) pour télécharger tous les exemples [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] et [!INCLUDE[wf1](../../../../includes/wf1-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="c49f7-138">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="c49f7-139">Cet exemple se trouve dans le répertoire suivant.</span><span class="sxs-lookup"><span data-stu-id="c49f7-139">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WF\Basic\Compensation\Confirmation`