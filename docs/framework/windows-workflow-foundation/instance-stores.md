---
title: Magasins d'instances
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: f2629668-0923-4987-b943-67477131c1e0
caps.latest.revision: "14"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: c794c6e20b479ea4686caba29704f8851d108432
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/02/2017
---
# <a name="instance-stores"></a><span data-ttu-id="f947d-102">Magasins d'instances</span><span class="sxs-lookup"><span data-stu-id="f947d-102">Instance Stores</span></span>
<span data-ttu-id="f947d-103">Un magasin d'instances est un conteneur logique d'instances.</span><span class="sxs-lookup"><span data-stu-id="f947d-103">An instance store is a logical container of instances.</span></span> <span data-ttu-id="f947d-104">Il s'agit de l'endroit où les données et les métadonnées d'instance sont stockées.</span><span class="sxs-lookup"><span data-stu-id="f947d-104">It is the place where the instance data and metadata is stored.</span></span> <span data-ttu-id="f947d-105">Un magasin d'instances n'implique pas de stockage physique dédié.</span><span class="sxs-lookup"><span data-stu-id="f947d-105">An instance store does not imply dedicated physical storage.</span></span> <span data-ttu-id="f947d-106">Il peut contenir des informations durables dans une base de données SQL Server ou des informations d'état non durables dans une mémoire.</span><span class="sxs-lookup"><span data-stu-id="f947d-106">An instance store could contain durable information in a SQL Server database or non-durable state information in a memory.</span></span> <span data-ttu-id="f947d-107">[!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] est fourni avec le magasin d'instances de workflow SQL, lequel est une implémentation concrète d'un magasin d'instances qui permet aux workflows de rendre des données et des métadonnées d'instance persistantes dans une base de données SQL Server 2005 ou 2008.</span><span class="sxs-lookup"><span data-stu-id="f947d-107">The [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] ships with the SQL Workflow Instance Store, which is a concrete implementation of an instance store that allows workflows to persist instance data and metadata into a SQL Server 2005 or SQL Server 2008 database.</span></span> <span data-ttu-id="f947d-108">En outre, Windows Server AppFabric fournit également une implémentation concrète d'un magasin d'instances.</span><span class="sxs-lookup"><span data-stu-id="f947d-108">In addition Windows Server App Fabric also provides a concrete implementation of an instance store.</span></span> [!INCLUDE[crdefault](../../../includes/crdefault-md.md)]<span data-ttu-id="f947d-109">[Magasin d’instances Windows Server App Fabric, les requêtes et les fournisseurs de contrôle](http://go.microsoft.com/fwlink/?LinkID=201201&clcid=0x409).</span><span class="sxs-lookup"><span data-stu-id="f947d-109"> [Windows Server App Fabric Instance Store, Query, and Control Providers](http://go.microsoft.com/fwlink/?LinkID=201201&clcid=0x409).</span></span>  
  
 <span data-ttu-id="f947d-110">L'API de persistance est l'interface entre un hôte et un magasin d'instances qui permet à l'hôte d'envoyer des demandes de commande (par exemple, <xref:System.Activities.DurableInstancing.LoadWorkflowCommand> et <xref:System.Activities.DurableInstancing.SaveWorkflowCommand>) au magasin d'instances.</span><span class="sxs-lookup"><span data-stu-id="f947d-110">The persistence API is the interface between a host and an instance store that allows the host to send command requests (for example, <xref:System.Activities.DurableInstancing.LoadWorkflowCommand> and <xref:System.Activities.DurableInstancing.SaveWorkflowCommand>) to the instance store.</span></span> <span data-ttu-id="f947d-111">L'implémentation concrète de cette API est appelée fournisseur de persistance.</span><span class="sxs-lookup"><span data-stu-id="f947d-111">The concrete implementation of this API is called a persistence provider.</span></span> <span data-ttu-id="f947d-112">Le fournisseur de persistance reçoit des demandes d'un hôte et modifie le magasin d'instances.</span><span class="sxs-lookup"><span data-stu-id="f947d-112">The persistence provider receives requests from a host and modifies the instance store.</span></span>  
  
 <span data-ttu-id="f947d-113">Les hôtes et les magasins d'instances sont enfichables afin qu'un hôte puisse être utilisé avec de nombreux magasins d'instances et qu'un magasin d'instances puisse être utilisé avec de nombreux hôtes.</span><span class="sxs-lookup"><span data-stu-id="f947d-113">Hosts and instance stores are pluggable so that a host can be used with many instance stores, and an instance store can be used with many hosts.</span></span> <span data-ttu-id="f947d-114">Un magasin d’instances est généralement optimisé pour les modèles d’utilisation d’un hôte particulier, bien que le magasin d’instances et l’hôte puissent évoluer sur des cycles de vie indépendants.</span><span class="sxs-lookup"><span data-stu-id="f947d-114">An instance store is typically optimized for the usage patterns of a particular host, although the instance store and host may evolve on independent life cycles.</span></span> <span data-ttu-id="f947d-115">Par exemple, le **WorkflowServiceHost** et **SqlWorkflowInstanceStore** sont conçus pour bien fonctionner ensemble.</span><span class="sxs-lookup"><span data-stu-id="f947d-115">For example, the **WorkflowServiceHost** and the **SqlWorkflowInstanceStore** are designed to work well together.</span></span> <span data-ttu-id="f947d-116">Vous pouvez créer votre propre magasin d’instances pour rendre persistantes les données et métadonnées d’instances de service de flux de travail et utiliser ce magasin d’instances avec le **WorkflowServiceHost**.</span><span class="sxs-lookup"><span data-stu-id="f947d-116">You can create your own instance store to persist data and metadata of workflow service instances and use that instance store with the **WorkflowServiceHost**.</span></span> <span data-ttu-id="f947d-117">Par exemple, vous pouvez créer un OracleWorkflowInstanceStore qui laisse des workflows rendre les informations persistantes dans une base de données Oracle au lieu de les enregistrer dans une base de données SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f947d-117">For example, you can create an OracleWorkflowInstanceStore that lets workflows persist information into an Oracle database instead of saving them into a SQL Server database.</span></span>  
  
 <span data-ttu-id="f947d-118">Il est courant que les hôtes soient étendus avec des fonctionnalités supplémentaires qui modifient les objets rendus persistants.</span><span class="sxs-lookup"><span data-stu-id="f947d-118">It is common for hosts to be extended with additional functionality that modifies the persisted objects.</span></span> <span data-ttu-id="f947d-119">Par exemple, un système de persistance d’instance peut avoir un hôte de flux de travail, une extension qui prend en charge l’opération « Suspend » et un magasin d’instances SQL.</span><span class="sxs-lookup"><span data-stu-id="f947d-119">For example, an instance persistence system may have a workflow host, an extension that supports the "Suspend" operation, and an SQL instance store.</span></span>  <span data-ttu-id="f947d-120">L'hôte de workflow peut envoyer une commande standard telle que Save ou Load pour enregistrer ou charger un workflow à partir d'un magasin d'instances ou pour enregistrer un workflow dans un magasin d'instances.</span><span class="sxs-lookup"><span data-stu-id="f947d-120">The workflow host might send a standard command such as Save or Load to save or load a workflow from an instance store or to save a workflow into an instance store.</span></span> <span data-ttu-id="f947d-121">L'extension d'interruption peut ajouter une sémantique supplémentaire aux commandes pour enregistrer et charger des instances de workflow afin qu'une instance de workflow interrompue ne puisse pas être chargée.</span><span class="sxs-lookup"><span data-stu-id="f947d-121">The suspend extension might add additional semantics to the commands for saving and loading workflow instances so that a suspended workflow instance cannot be loaded.</span></span> <span data-ttu-id="f947d-122">Le fournisseur de persistance du magasin d'instances SQL comprend les commandes d'enregistrement et de chargement des instances de workflow et implémente ces commandes en appelant des procédures stockées appropriées qui modifient les tables d'objets persistants dans une base de données SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f947d-122">The persistence provider for the SQL instance store understands the commands for saving and loading workflow instances, and implements the commands by calling appropriate stored procedures that change the tables of persistent objects in an SQL Server database.</span></span>  
  
 <span data-ttu-id="f947d-123">Un hôte agit comme un propriétaire d'instance dans un magasin d'instances.</span><span class="sxs-lookup"><span data-stu-id="f947d-123">A host acts as an instance owner within an instance store.</span></span> <span data-ttu-id="f947d-124">Il peut se comporter comme le propriétaire de plusieurs instances avec plusieurs magasins d'instances en même temps.</span><span class="sxs-lookup"><span data-stu-id="f947d-124">A host may act as more than one instance owner with more than one instance store at the same time.</span></span> <span data-ttu-id="f947d-125">L'hôte fournit des GUID pour les clés d'instance associées aux instances.</span><span class="sxs-lookup"><span data-stu-id="f947d-125">The host provides GUIDs for instance keys associated with the instances.</span></span> <span data-ttu-id="f947d-126">Une clé d'instance est un alias unique qui identifie une instance.</span><span class="sxs-lookup"><span data-stu-id="f947d-126">An instance key is a unique alias that identifies an instance.</span></span> <span data-ttu-id="f947d-127">Le système de persistance crée, met à jour et supprime les informations de propriétaire d'instance à mesure qu'il exécute les commandes demandées par les hôtes.</span><span class="sxs-lookup"><span data-stu-id="f947d-127">The persistence system creates, updates, and deletes instance owner information as it executes commands requested by hosts.</span></span>  
  
 <span data-ttu-id="f947d-128">La liste suivante répertorie les étapes importantes de l'interaction de l'hôte avec le magasin d'instances :</span><span class="sxs-lookup"><span data-stu-id="f947d-128">The following list contains the important steps involved in the host’s interaction with the instance store:</span></span>  
  
1.  <span data-ttu-id="f947d-129">Obtenir un **InstanceStore** à partir d’un fournisseur de persistance.</span><span class="sxs-lookup"><span data-stu-id="f947d-129">Obtain an **InstanceStore** from a persistence provider.</span></span>  

2.  <span data-ttu-id="f947d-130">Obtenir le handle à une instance en appelant le <xref:System.Runtime.DurableInstancing.InstanceStore.CreateInstanceHandle%2A> méthode sur le **InstanceStore**.</span><span class="sxs-lookup"><span data-stu-id="f947d-130">Obtain the handle to an instance by calling the <xref:System.Runtime.DurableInstancing.InstanceStore.CreateInstanceHandle%2A> method on the **InstanceStore**.</span></span>  
  
3.  <span data-ttu-id="f947d-131">Appeler des commandes sur le handle d’instance en appelant le <xref:System.Runtime.DurableInstancing.InstanceStore.Execute%2A> méthode sur le **InstanceStore**.</span><span class="sxs-lookup"><span data-stu-id="f947d-131">Invoke commands against the instance handle by calling the <xref:System.Runtime.DurableInstancing.InstanceStore.Execute%2A> method on the **InstanceStore**.</span></span>  
  
4.  <span data-ttu-id="f947d-132">Examinez le <xref:System.Runtime.DurableInstancing.InstanceView> retourné par **InstanceStore.Execute** pour déterminer les résultats des commandes.</span><span class="sxs-lookup"><span data-stu-id="f947d-132">Examine the <xref:System.Runtime.DurableInstancing.InstanceView> returned by **InstanceStore.Execute** to determine the results of the commands.</span></span>
